<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ã€ŠCS106Lç¬”è®°ã€‹</title>
    <link href="/2023/04/14/%E3%80%8ACS106L%E7%AC%94%E8%AE%B0%E3%80%8B/"/>
    <url>/2023/04/14/%E3%80%8ACS106L%E7%AC%94%E8%AE%B0%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>è¯¾ç¨‹æ¥æºï¼šStanford-CS106L(22 fall)</p><p>è¯¾ç¨‹ä»‹ç»ï¼š<a href="https://github.com/qlhhahaha/HashMap_for_CS106L">HashMap_for_CS106L</a></p>          </div><h1 id="Lecture2ã€Types-and-Structs"><a href="#Lecture2ã€Types-and-Structs" class="headerlink" title="Lecture2ã€Types and Structs"></a>Lecture2ã€Types and Structs</h1><h2 id="ä¸€ã€Types"><a href="#ä¸€ã€Types" class="headerlink" title="ä¸€ã€Types"></a>ä¸€ã€Types</h2><ul><li><strong>é™æ€è¯­è¨€ï¼š</strong>æœ‰åå­—çš„ä¸œè¥¿ï¼ˆå˜é‡&#x2F;å‡½æ•°ï¼‰è¦äººä¸ºç»™ç±»å‹</li><li><strong>åŠ¨æ€è¯­è¨€ï¼š</strong>è¿è¡Œæ—¶è§£é‡Šå™¨æ ¹æ®current valueè‡ªåŠ¨ç»™ç±»å‹</li></ul><p><img src="https://s2.loli.net/2023/04/14/YX8tVdgN5bH6hiu.png"></p><p><img src="https://s2.loli.net/2023/04/14/kQbXxquftZjcAMz.png"></p><h1 id="Lecture3ã€Stream"><a href="#Lecture3ã€Stream" class="headerlink" title="Lecture3ã€Stream"></a>Lecture3ã€Stream</h1><h2 id="ä¸€ã€cout"><a href="#ä¸€ã€cout" class="headerlink" title="ä¸€ã€cout"></a>ä¸€ã€cout</h2><p>coutæ˜¯stdå†…åµŒçš„è¾“å‡ºæµï¼Œå®ƒçš„ç±»å‹æ˜¯std::ostreamï¼Œæ‰€ä»¥å…¶å®<strong>ä½ ä¹Ÿå®Œå…¨å¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ªstd::ostreamç±»å‹çš„è¾“å‡ºæµ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">writeToStream</span><span class="hljs-params">(std::ostream&amp; anyOutputStream, <span class="hljs-type">int</span> favouriteNumber)</span> </span>&#123;<br>    anyOutputStream &lt;&lt; <span class="hljs-string">&quot;Writing to stream: &quot;</span><br>        &lt;&lt; favouriteNumber &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// Write an int to the user&#x27;s console.</span><br>    <span class="hljs-type">int</span> favouriteNumber = <span class="hljs-number">1729</span>;<br><br>    <span class="hljs-comment">// Write method to take any ostream</span><br>    <span class="hljs-function">std::ofstream <span class="hljs-title">fileOut</span><span class="hljs-params">(<span class="hljs-string">&quot;out.txt&quot;</span>)</span></span>;<br><br>    <span class="hljs-built_in">writeToStream</span>(cout, favouriteNumber);<br>    <span class="hljs-built_in">writeToStream</span>(fileOut, favouriteNumber + <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¼šåœ¨æ§åˆ¶å°ä¸Šè¾“å‡º1729ï¼Œåœ¨out.txtä¸­å†™å…¥1730</p><h2 id="äºŒã€cin"><a href="#äºŒã€cin" class="headerlink" title="äºŒã€cin"></a>äºŒã€cin</h2><p>åŒç†ï¼Œå¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ªstd::istreamç±»å‹çš„è¾“å…¥æµ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//read numbers from a file</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">readNumbers</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// Create our istream and make it open the file</span><br>    <span class="hljs-function">std::istream <span class="hljs-title">input</span><span class="hljs-params">(<span class="hljs-string">&quot;res/numbers.txt&quot;</span>)</span></span>;<br>    <span class="hljs-type">int</span> value;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) &#123;<br>        input &gt;&gt; value;<br>        <span class="hljs-keyword">if</span>(input.<span class="hljs-built_in">fail</span>())<br>            <span class="hljs-keyword">break</span>;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Value read: &quot;</span> &lt;&lt; value &lt;&lt; endl;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><p><img src="https://s2.loli.net/2023/04/14/GxBvd9eRrohVJXI.png"></p><h1 id="Lecture4ã€Initialization-and-References"><a href="#Lecture4ã€Initialization-and-References" class="headerlink" title="Lecture4ã€Initialization and References"></a>Lecture4ã€Initialization and References</h1><h2 id="ä¸€ã€Initialization"><a href="#ä¸€ã€Initialization" class="headerlink" title="ä¸€ã€Initialization"></a>ä¸€ã€Initialization</h2><ol><li>æ³¨æ„vectorä¸¤ç§åˆå§‹åŒ–çš„åŒºåˆ«</li></ol><p><img src="https://s2.loli.net/2023/04/14/kPzA2belKB5qnNr.png" alt="Untitled"></p><div class="note note-warning">            <p>ğŸ’¡ PS. å…¶ä¸­å¤§æ‹¬å·åˆå§‹åŒ–è¢«ç§°ä¸ºâ€œç»Ÿä¸€åˆå§‹åŒ–â€ï¼Œæ˜¯C11å¼•è¿›çš„ï¼Œå¯¹æ‰€æœ‰æ•°æ®ç±»å‹éƒ½é€‚ç”¨ï¼Œå¯ä»¥åœ¨declarationæ—¶ç«‹å³åˆå§‹åŒ–</p>          </div><ol start="2"><li><strong>ç»“æ„åŒ–ç»‘å®šï¼ˆstructured bindingï¼‰</strong></li></ol><p>â€‹ideaï¼šç»å…¸è¯­æ³•ä¸­ï¼Œä¸ºäº†æ¥æ”¶ä¸€ä¸ªstruct\pairï¼Œå¯èƒ½å¾—ç”¨ç‚¹å·å»ä¸€ä¸ªä¸ªè¯»å–ç»“æ„ä½“é‡Œçš„å€¼ï¼Œè¿™å¾ˆéº»çƒ¦ï¼›c17ä¸­å¼•å…¥ç»“æ„åŒ–ç»‘å®šï¼Œå¯ä»¥ç›´æ¥ç”¨<strong>auto+ä¸­æ‹¬å·</strong>å»æ¥æ”¶ï¼ˆè¯è¯´è¿™ä¸œè¥¿matlabé‡Œä¸æ˜¯æ—©æœ‰äº†å—ã€‚ã€‚ï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/suEOq9jPceZ7LD8.png"></p><h2 id="äºŒã€References"><a href="#äºŒã€References" class="headerlink" title="äºŒã€References"></a>äºŒã€References</h2><p>ä¸€ä¸ªç»å…¸çš„å¼•ç”¨errorï¼šæƒ³ç»™pairä¸­çš„æ¯ä¸ªå€¼åŠ ä¸€</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">shift</span><span class="hljs-params">(vector&lt;std::pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt;&amp; nums)</span> </span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> [num1, num2]: nums) <br>&#123;<span class="hljs-comment">//æ˜¾ç„¶é”™äº†ï¼Œå› ä¸ºnum1ã€2æ˜¯numsçš„å‰¯æœ¬ï¼Œå¼€è¾Ÿäº†æ–°ç©ºé—´</span><br>num1++;<br>num2++;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åº”è¯¥ä¿®æ”¹ä¸º for (auto&amp; [num1, num2]: nums)</p><h1 id="Lecture5ã€Container"><a href="#Lecture5ã€Container" class="headerlink" title="Lecture5ã€Container"></a>Lecture5ã€Container</h1><ol><li>ä¸è¦ææ··vectorçš„_sizeå’Œ_capacityå±æ€§</li></ol><p><img src="https://s2.loli.net/2023/04/14/Zv2KtfI5RH7MVgW.png"></p><h1 id="Lecture7ã€Classes"><a href="#Lecture7ã€Classes" class="headerlink" title="Lecture7ã€Classes"></a>Lecture7ã€Classes</h1><ol><li>STLä¸­æ‰€æœ‰çš„containeréƒ½æ˜¯class</li><li><strong>æ¨¡æ¿ç±»ï¼ˆtemplate classï¼‰</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//æ¨¡æ¿ç±»è¯­æ³•</span><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> First, <span class="hljs-keyword">typename</span> Second&gt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">my_pair</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-function">First <span class="hljs-title">get_first</span><span class="hljs-params">()</span></span>;<br><span class="hljs-function">Second <span class="hljs-title">get_second</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">set_first</span><span class="hljs-params">(First f)</span></span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">set_second</span><span class="hljs-params">(Second f)</span></span>;<br><br><span class="hljs-keyword">private</span>:<br>First first;<br>Second second;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*****************vector.h********************/</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;vector.cpp&quot;</span>           <span class="hljs-comment">//ps2</span></span><br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">vector</span>&lt;T&gt;<br>&#123;<br><span class="hljs-function">T <span class="hljs-title">my_at</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span></span>;<br>&#125;<br><br><span class="hljs-comment">/*****************vector.cpp********************/</span><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;       <span class="hljs-comment">//ps1</span><br><span class="hljs-type">void</span> vector&lt;T&gt;::<span class="hljs-built_in">my_at</span>(<span class="hljs-type">int</span> i)<br>&#123;<br><span class="hljs-comment">//oops</span><br>&#125;<br><br><span class="hljs-comment">/*****************main.cpp********************/</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;vector.h&quot;</span></span><br>vector&lt;<span class="hljs-type">int</span>&gt; a;<br>a.<span class="hljs-built_in">my_at</span>(<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><div class="note note-warning">            <aside> ğŸ’¡ PS.<ol><li>é¦–å…ˆï¼Œæ³¨æ„å¿…é¡»åœ¨æ¯ä¸ªæˆå‘˜å‡½æ•°é‚£å„¿å»å£°æ˜ä¸€éå®ƒæ˜¯templateï¼Œä¹Ÿå°±æ˜¯å»æ‰ps1é‚£ä¸€è¡Œä¼šæŠ¥é”™</li><li>ps2é‚£ä¸€è¡Œï¼Œæ³¨æ„ï¼Œvector.hå¤´æ–‡ä»¶é‡Œè¦include â€œvector.cppâ€ï¼Œå¦åˆ™æ‰¾ä¸åˆ°my_at()å‡½æ•°çš„å…·ä½“å®šä¹‰ ï¼ˆæƒ³äº†è€åŠå¤©ä¹Ÿæ²¡æƒ³æ¸…æ¥šä¸ºå•¥ã€‚ã€‚å—¯è®°ç€å§ï¼‰</li><li>ä¸€èˆ¬ä¸åœ¨å¤´æ–‡ä»¶é‡Œincludeæºæ–‡ä»¶ï¼Œå› ä¸ºå¯èƒ½é€ æˆé‡å¤å®šä¹‰ï¼›ä½†ä¹Ÿæœ‰ä¸€äº›åœºæ™¯æˆ–è®¸ä¼šç”¨ï¼Œæ¯”å¦‚vscodeé‡Œæ‡’å¾—å†™cmakeè„šæœ¬ï¼Œå°±å¯ä»¥ç”¨include&lt;.cpp&gt;è¿™ç§trickã€‚ã€‚</li></ol>          </div><p><img src="https://s2.loli.net/2023/04/14/oDHRjb3kGdw2ON8.jpg"></p><h1 id="Lecture9ã€Template-Functions"><a href="#Lecture9ã€Template-Functions" class="headerlink" title="Lecture9ã€Template Functions"></a>Lecture9ã€Template Functions</h1><ol><li><p><strong>motivationï¼š</strong>ä¸€ä¸ªåŠŸèƒ½é€šç”¨æ€§å¾ˆå¼ºçš„å‡½æ•°ï¼Œè¦å› ä¸ºæ¥æ”¶å‚æ•°æ•°æ®ç±»å‹ä¸åŒè€Œå¤åˆ¶ç²˜è´´å¤šä¸ªç‰ˆæœ¬å—ï¼Ÿå½“ç„¶ï¼Œfunction overloadingå¯ä»¥ç®€åŒ–è¿™ä¸ªé—®é¢˜ï¼Œä½†ä»ç„¶å¾—å¤åˆ¶ç²˜è´´ï¼Œèƒ½ä¸èƒ½æŠŠè¿™ä¸ªå‡½æ•°ç»™ä¸€èˆ¬åŒ–ï¼Œä»æ ¹æºä¸Šè§£å†³é—®é¢˜æï¼Ÿ</p><p><img src="https://s2.loli.net/2023/04/14/xJfgFth1wOmLb5I.png"></p></li><li><p><strong>æ¨¡æ¿å‡½æ•°ï¼ˆTemplate Functionsï¼‰</strong></p><p><img src="https://s2.loli.net/2023/04/14/9zcsDjKper6XuOI.png"></p><p>å…¶ä¸­typenameå¯ä»¥è®¾å®šé»˜è®¤å‚æ•°ï¼Œå³å†™æˆtemplate<typename Type=int></p><p>åœ¨å®ä¾‹åŒ–ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥æ˜¾å¼å®šä¹‰Type</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cout &lt;&lt; <span class="hljs-built_in">myMin</span>&lt;<span class="hljs-type">int</span>&gt;(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>) &lt;&lt; endl;<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå®ƒè¿˜å¯ä»¥æ›´èªæ˜â€”â€”æˆ‘ä»¬éšå¼å£°æ˜å˜é‡ï¼Œè®©ç¼–è¯‘å™¨è‡ªå·±æ¨æ–­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-keyword">typename</span> U&gt;<br><span class="hljs-function"><span class="hljs-keyword">auto</span> <span class="hljs-title">smarterMyMin</span><span class="hljs-params">(T a, U b)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> a &lt; b ? a : b;<br>&#125;<br><br>cout &lt;&lt; <span class="hljs-built_in">smarterMyMin</span>(<span class="hljs-number">3.2</span>, <span class="hljs-number">4</span>) &lt;&lt; endl;<br></code></pre></td></tr></table></figure><div class="note note-warning">            <p>ğŸ’¡ PS. æ³¨æ„ï¼šæ¨¡æ¿ç±»å’Œæ¨¡æ¿å‡½æ•°éƒ½æ˜¯åœ¨ä½¿ç”¨ï¼ˆå³å®ä¾‹åŒ–ï¼‰ä¹‹åæ‰ä¼šç¼–è¯‘ï¼ä¸ç”¨å°±ä¸ç¼–è¯‘ã€‚ è€Œä¸åŒçš„å®ä¾‹åŒ–ç¼–è¯‘å‡ºçš„ç»“æœä¹Ÿä¸ä¸€æ ·ï¼Œæ‰€ä»¥å…¶å®æ˜¯ç¼–è¯‘å™¨å¸®ä½ å®Œæˆäº†â€œå¤åˆ¶ç²˜è´´å¤šä¸ªç‰ˆæœ¬â€è¿™ä¸€æ­¥ã€‚</p>          </div></li></ol><h1 id="Lecture10ã€Lambda-Functions"><a href="#Lecture10ã€Lambda-Functions" class="headerlink" title="Lecture10ã€Lambda Functions"></a>Lecture10ã€Lambda Functions</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">abssort</span><span class="hljs-params">(<span class="hljs-type">float</span>* x, <span class="hljs-type">unsigned</span> n)</span> </span>&#123;<br>    std::<span class="hljs-built_in">sort</span>(x, x + n,<br>        <span class="hljs-comment">// Lambda expression begins</span><br>        [](<span class="hljs-type">float</span> a, <span class="hljs-type">float</span> b) &#123;<br>            <span class="hljs-built_in">return</span> (std::<span class="hljs-built_in">abs</span>(a) &lt; std::<span class="hljs-built_in">abs</span>(b));<br>        &#125; <span class="hljs-comment">// end of lambda expression</span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/N5Y3hbXFqJDOmaU.png"></p><p><strong>æ•è·åˆ—è¡¨çš„ä½œç”¨ï¼š</strong></p><ol><li>[ ]æ˜¯lambdaå¼•å‡ºç¬¦ï¼Œç¼–è¯‘å™¨æ ¹æ®è¯¥å¼•å‡ºç¬¦åˆ¤æ–­æ¥ä¸‹æ¥çš„ä»£ç æ˜¯å¦æ˜¯lambdaå‡½æ•°</li><li>æ•æ‰ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ä¾›lambdaä½¿ç”¨</li></ol><p><strong>æ•è·åˆ—è¡¨ä½¿ç”¨ï¼š</strong></p><ul><li>[ ]è¡¨ç¤ºä¸æ•è·ä»»ä½•å˜é‡</li><li>[var]ã€[&amp;var]åˆ†åˆ«è¡¨ç¤ºä»¥å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’çš„æ–¹å¼æ•æ‰å˜é‡var</li><li>[&#x3D;]ã€[&amp;]åˆ†åˆ«è¡¨ç¤ºä»¥å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’æ–¹å¼æ•è·æ‰€æœ‰<strong>çˆ¶ä½œç”¨åŸŸ</strong>çš„å˜é‡</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> index = <span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> num = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">auto</span> function = ([]()<br>&#123;num = <span class="hljs-number">1000</span>;<br>index = <span class="hljs-number">2</span>;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;index: &quot;</span>&lt;&lt; index &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> <br>            &lt;&lt; <span class="hljs-string">&quot;num: &quot;</span>&lt;&lt; num &lt;&lt; std::endl; &#125;);<br><br><span class="hljs-built_in">function</span>();<br><span class="hljs-comment">//æŠ¥é”™ï¼Œå› ä¸ºæ²¡å»æ•è·numå’Œindexå°±åœ¨ä½¿ç”¨å®ƒä»¬</span><br><br><span class="hljs-type">int</span> index = <span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> num = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">auto</span> function = ([=]()<br>&#123;num = <span class="hljs-number">1000</span>;<br>index = <span class="hljs-number">2</span>;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;index: &quot;</span>&lt;&lt; index &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> <br>            &lt;&lt; <span class="hljs-string">&quot;num: &quot;</span>&lt;&lt; num &lt;&lt; std::endl; &#125;);<br><br><span class="hljs-built_in">function</span>();<br><span class="hljs-comment">//æŠ¥é”™ï¼Œå› ä¸ºlambdaçš„å€¼å¼•ç”¨é»˜è®¤ä¸èƒ½ä¿®æ”¹ï¼Œè¦ä¿®æ”¹çš„è¯å¾—åŠ mutableå…³é”®å­—</span><br><br><span class="hljs-type">int</span> index = <span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> num = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">auto</span> function = ([=]()<span class="hljs-keyword">mutable</span><br>&#123;num = <span class="hljs-number">1000</span>;<br>index = <span class="hljs-number">2</span>;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;index: &quot;</span>&lt;&lt; index &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> <br>            &lt;&lt; <span class="hljs-string">&quot;num: &quot;</span>&lt;&lt; num &lt;&lt; std::endl; &#125;);<br><br><span class="hljs-built_in">function</span>();<br><span class="hljs-comment">//æ­£ç¡®ï¼Œå› ä¸ºåŠ äº†mutableå…³é”®å­—ï¼Œå€¼ä¼ é€’å˜é‡å¯ä¿®æ”¹ï¼ˆä½†æ”¹çš„ä¹Ÿæ˜¯å‰¯æœ¬ï¼Œä¸å½±å“åŸå€¼ï¼‰</span><br><br><span class="hljs-type">int</span> index = <span class="hljs-number">1</span>;<br><span class="hljs-type">int</span> num = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">auto</span> function = ([&amp;]()<br>&#123;num = <span class="hljs-number">1000</span>;<br>index = <span class="hljs-number">2</span>;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;index: &quot;</span>&lt;&lt; index &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> <br>            &lt;&lt; <span class="hljs-string">&quot;num: &quot;</span>&lt;&lt; num &lt;&lt; std::endl; &#125;);<br><br><span class="hljs-built_in">function</span>();<br><span class="hljs-comment">//æ­£ç¡®ï¼Œå¼•ç”¨ä¼ é€’çš„å€¼å¯ä»¥ä¿®æ”¹</span><br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œæ€è€ƒLambdaçš„æ„ä¹‰ï¼ˆå’Œæ™®é€šå‡½æ•°ç›¸æ¯”ï¼‰ï¼š</p><ol><li><p>çœå»å®šä¹‰ä¸€ä¸ªå®Œæ•´å‡½æ•°ã€ç»™å‡½æ•°å‘½åçš„è¿‡ç¨‹ï¼Œå¯¹äºè¿™ç§<strong>ä¸éœ€è¦å¤ç”¨</strong>ï¼Œä¸”<strong>çŸ­å°</strong>çš„å‡½æ•°ï¼Œç›´æ¥ä¼ é€’å‡½æ•°ä½“å¯ä»¥å¢åŠ ä»£ç çš„å¯è¯»æ€§ã€‚æ‰€ä»¥lambdaå‡½æ•°åˆå«â€œåŒ¿åå‡½æ•°â€ã€‚</p><div class="note note-warning">            <p>ğŸ’¡ PS. ä¸è¦å°çœ‹â€œçœç•¥å‘½åâ€è¿™ä»¶äº‹ï¼Œè¡¨é¢ä¸Šçœ‹å®ƒåªæ˜¯å°‘äº†ä¸ªåå­—ï¼Œä½†å®è´¨æ˜¯æŠŠå®ƒçœ‹ä½œä¸€ä¸ªæ™®é€šçš„â€œæ“ä½œè¿‡ç¨‹â€è€Œéâ€œå¯¹è±¡â€ã€‚å°±åƒä½ ä¼šç»™ä¸€ä¸ªå˜é‡ã€ç±»ã€å‡½æ•°å‘½åï¼Œä½†ä¸ä¼šå•ç‹¬ç»™â€œæŠŠaä¹˜ä¸Šcçš„3æ¬¡æ–¹å†åŠ 123å†é™¤321â€è¿™ç§çº¯è¿‡ç¨‹å»å‘½ä¸ªåï¼ˆé™¤éè¿™ä¸ªæ“ä½œå¤ç”¨ç‡è¶³å¤Ÿé«˜ï¼‰ï¼Œå› ä¸ºå®ƒæŠ½è±¡ç¨‹åº¦å¤ªä½ï¼Œå³ç”¨å³æ‰”ã€‚ <strong>è€Œæ‰€æœ‰å€¼å¾—å»å‘½åçš„ä¸œè¥¿ï¼Œéƒ½åº”è¯¥æ˜¯ä¼šå¤ç”¨ä¸”æŠ½è±¡ç¨‹åº¦è¶³å¤Ÿçš„ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯ç¼–ç¨‹ä¸­çš„ä¸€ç§å“²å­¦æ€æƒ³ã€‚</strong> å¦‚ï¼šä¸€ä¸ªæ™®é€šæ“ä½œå¤ç”¨ç¨‹åº¦è¶³å¤Ÿé«˜æ—¶ï¼ˆæ¯”è¾ƒint aã€int bå¤§å°ï¼‰ï¼Œå°±æŠŠå®ƒæŠ½è±¡ä¸ºä¸€ä¸ªå‡½æ•°ï¼ˆmaxå‡½æ•°ï¼‰ï¼›è€Œè¿™ä¸ªå‡½æ•°å¤ç”¨ç‡å¤Ÿé«˜æ—¶ï¼Œå°±è¿›ä¸€æ­¥æŠ½è±¡ä¸ºtemplate function</p>          </div></li><li><p>å…è®¸å‡½æ•°ä½œä¸ºä¸€ä¸ªå¯¹è±¡è¿›è¡Œ<strong>ä¼ é€’</strong>ï¼šlambdaä¹Ÿå¯ä»¥å‘½åï¼Œç„¶åå°†å…¶è¿›è¡Œä¼ é€’ã€‚è¿™ç§æ–¹å¼å’Œä¼ ç»Ÿçš„å‡½æ•°æŒ‡é’ˆæ¯”èµ·æ¥æ›´åŠ ç®€æ˜ã€‚</p></li><li><p>å¼•å…¥<strong>é—­åŒ…</strong>ï¼šé—­åŒ…æ˜¯æŒ‡å°†å½“å‰ä½œç”¨åŸŸä¸­çš„å˜é‡é€šè¿‡å€¼æˆ–è€…å¼•ç”¨çš„æ–¹å¼å°è£…åˆ°lambdaè¡¨è¾¾å¼å½“ä¸­ï¼Œæˆä¸ºè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä½¿ä½ çš„lambdaè¡¨è¾¾å¼ä»ä¸€ä¸ªæ™®é€šçš„å‡½æ•°å˜æˆäº†ä¸€ä¸ªå¸¦éšè—å‚æ•°çš„å‡½æ•°ã€‚</p></li></ol><p>å¸¸è§åº”ç”¨åœºæ™¯ï¼š</p><ol><li><p><strong>ç”¨äºstlç®—æ³•åº“</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// for_eachåº”ç”¨å®ä¾‹</span><br><span class="hljs-type">int</span> a[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">33</span>, <span class="hljs-number">4</span>&#125;;<br><span class="hljs-built_in">sort</span>(a, a+<span class="hljs-number">4</span>, [=](<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y) -&gt; <span class="hljs-type">bool</span> &#123; <span class="hljs-keyword">return</span> x%<span class="hljs-number">10</span> &lt; y%<span class="hljs-number">10</span>; &#125; );<br>for_each(a, a+<span class="hljs-number">4</span>, [=](<span class="hljs-type">int</span> x) &#123; cout &lt;&lt; x &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;&#125; );<br></code></pre></td></tr></table></figure><div class="note note-warning">            <p>ğŸ’¡ PS. foreach()è¿™ä¸ªä¸œè¥¿åœ¨#include<algorithm>é‡Œï¼Œæ˜¯ä¸ªtemplate functionï¼Œå…¶å‰ä¸¤ä¸ªå‚æ•°æ˜¯beginå’ŒendæŒ‡é’ˆ</p>          </div></li><li><p><em><strong>*ç”¨äºå¤šçº¿ç¨‹åœºæ™¯*</strong></em></p></li><li><p><strong>ä½œä¸ºå‡½æ•°çš„å…¥å‚</strong></p></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">using</span> FuncCallback = std::function&lt;<span class="hljs-built_in">void</span>(<span class="hljs-type">void</span>)&gt;;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DataCallback</span><span class="hljs-params">(FuncCallback callback)</span></span><br><span class="hljs-function"></span>&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;Start FuncCallback!&quot;</span> &lt;&lt; std::endl;<br><span class="hljs-built_in">callback</span>();<br>std::cout &lt;&lt; <span class="hljs-string">&quot;End FuncCallback!&quot;</span> &lt;&lt; std::endl;<br>&#125;<br><br><span class="hljs-keyword">auto</span> callback_handler = [&amp;]()&#123;<br>std::cout &lt;&lt; <span class="hljs-string">&quot;This is callback_handler&quot;</span>;<br>&#125;;<br><br><span class="hljs-built_in">DataCallback</span>(callback_handler);<br></code></pre></td></tr></table></figure><h1 id="Lecture12ã€Specical-Member-Functions-6ä¸ª"><a href="#Lecture12ã€Specical-Member-Functions-6ä¸ª" class="headerlink" title="Lecture12ã€Specical Member Functions(6ä¸ª)"></a>Lecture12ã€Specical Member Functions(6ä¸ª)</h1><ol><li><p><strong>ä»‹ç»ï¼š</strong></p><p>C++ä¸­ç±»çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°æœ‰6ä¸ªï¼Œå¯¹äºä¸€ä¸ªç±»</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setData</span><span class="hljs-params">(<span class="hljs-type">int</span> data)</span> </span>&#123; m_data = data; &#125;<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getData</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>&#123; <span class="hljs-keyword">return</span> m_data; &#125;<br><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span> m_data;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆè¿™äº›ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥ç±»Açš„å®šä¹‰ç­‰ä»·äºå¦‚ä¸‹ï¼Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">A</span>() &#123;&#125;; <span class="hljs-comment">// é»˜è®¤æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">A</span>(<span class="hljs-type">const</span> A&amp; other) &#123; m_data = other.m_data; &#125; <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span><br>    A&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-type">const</span> A&amp; other) &#123; m_data = other.m_data; <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>; &#125; <span class="hljs-comment">// æ‹·è´èµ‹å€¼æ„é€ å‡½æ•°</span><br>    ~<span class="hljs-built_in">A</span>() &#123;&#125; <span class="hljs-comment">// ææ„å‡½æ•°</span><br>    <span class="hljs-built_in">A</span>(A&amp;&amp; other) &#123; m_data = other.m_data; &#125; <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•°</span><br>    A&amp; <span class="hljs-keyword">operator</span>=(A&amp;&amp; other) &#123; m_data = other.m_data; <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>; &#125; <span class="hljs-comment">// ç§»åŠ¨èµ‹å€¼æ„é€ å‡½æ•°</span><br><br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setData</span><span class="hljs-params">(<span class="hljs-type">int</span> data)</span> </span>&#123; m_data = data; &#125;<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getData</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>&#123; <span class="hljs-keyword">return</span> m_data; &#125;<br><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span> m_data;<br>&#125;;<br></code></pre></td></tr></table></figure></li><li><p><strong>æ‹·è´æ„é€ å‡½æ•°ï¼ˆcopy constructorï¼‰</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream &gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">double</span> real, imag;<br>    <span class="hljs-built_in">Complex</span>(<span class="hljs-type">double</span> r, <span class="hljs-type">double</span> i) &#123;<br>        real= r; imag = i;<br>    &#125;<br>&#125;;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">Complex <span class="hljs-title">cl</span><span class="hljs-params">(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></span>;<br>    <span class="hljs-function">Complex <span class="hljs-title">c2</span> <span class="hljs-params">(cl)</span></span>;  <span class="hljs-comment">//ç”¨æ‹·è´æ„é€ å‡½æ•°åˆå§‹åŒ–c2</span><br>    cout&lt;&lt;c2.real&lt;&lt;<span class="hljs-string">&quot;,&quot;</span>&lt;&lt;c2.imag;  <span class="hljs-comment">//è¾“å‡º 1,2</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœç”¨æˆ·è‡ªå·±ç¼–å†™äº†å¤åˆ¶æ„é€ å‡½æ•°ï¼Œåˆ™é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°å°±ä¸å­˜åœ¨äº†</p></li><li><p><strong>æ‹·è´èµ‹å€¼æ„é€ å‡½æ•°ï¼ˆcopy assignment constructorï¼‰</strong></p><p>å¯¹â€œï¼â€è¿›è¡Œé‡è½½ï¼Œä½œç”¨æ˜¯è®©ä¸¤ä¸ªå·²ç»åˆå§‹åŒ–å®Œæ¯•çš„ç±»è¿›è¡Œæ‹·è´</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs CPP">myclass A,Bï¼›<br>A = Bï¼›<br></code></pre></td></tr></table></figure></li></ol><div class="note note-warning">            <p>â€‹ğŸ’¡ PS. ä¸Šè¿°ä¸¤ä¸ªæ„é€ å‡½æ•°çš„åº”ç”¨å…¶å®éƒ½éå¸¸éå¸¸å¹¿æ³› â€”â€” åˆ«å¿˜äº†ï¼Œstlçš„å®¹å™¨å…¨éƒ½æ˜¯ç±»ï¼ vector<int>nums1 &#x3D; nums2ä¹Ÿç”¨äº†æ‹·è´èµ‹å€¼æ„é€ å‡½æ•°ï¼</p>          </div><ol start="4"><li><strong>æ·±æ‹·è´ä¸æµ…æ‹·è´</strong></li></ol><ul><li><p>å¤§éƒ¨åˆ†æ­£å¸¸æƒ…å†µä¸‹åªéœ€è¦æµ…æ‹·è´ï¼ˆå¦‚åŸºæœ¬æ•°æ®ç±»å‹ã€ç®€å•çš„ç±»ï¼‰ï¼Œint A &#x3D; Bï¼Œå°±æ˜¯Bæ‰€åœ¨å†…å­˜ä¸­çš„æ•°æ®æŒ‰äºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰å¤åˆ¶åˆ°Aæ‰€åœ¨çš„å†…å­˜</p></li><li><p>æ·±æ‹·è´ç”¨äºä»€ä¹ˆæƒ…å†µæï¼Ÿå‡è®¾æœ‰æŸä¸ªç±»æœ‰ä¸¤ä¸ªå®ä¾‹Aã€Bï¼Œç±»æŒæœ‰<strong>åŠ¨æ€åˆ†é…çš„å†…å­˜&#x2F;æŒ‡å‘å…¶ä»–æ•°æ®çš„æŒ‡é’ˆï¼Œ</strong>é‚£æ­¤æ—¶å°±ä¸èƒ½ç®€å•åœ°A &#x3D; Bï¼Œå¦åˆ™Aä¸­çš„æŒ‡é’ˆä¹Ÿä¼šæŒ‡å‘Bä¸­æŒ‡é’ˆå¯¹åº”çš„å†…å­˜ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä¸€ä¿®æ”¹Aï¼ŒBä¹Ÿä¼šéšä¹‹è¢«ä¿®æ”¹ï¼Œæ²¡è¾¾åˆ°æ‹·è´çš„æ•ˆæœã€‚</p><p>æ­£ç¡®åšæ³•æ˜¯ï¼Œå»æ˜¾å¼åœ°å®šä¹‰ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œå®ƒé™¤äº†ä¼šå°†åŸæœ‰å¯¹è±¡çš„æ‰€æœ‰æˆå‘˜å˜é‡æ‹·è´ç»™æ–°å¯¹è±¡ï¼Œè¿˜ä¼šä¸ºæ–°å¯¹è±¡å†åˆ†é…ä¸€å—å†…å­˜ï¼Œå¹¶å°†åŸæœ‰å¯¹è±¡æ‰€æŒæœ‰çš„å†…å­˜ä¹Ÿæ‹·è´è¿‡æ¥ã€‚è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œ<strong>åŸæœ‰å¯¹è±¡å’Œæ–°å¯¹è±¡æ‰€æŒæœ‰çš„åŠ¨æ€å†…å­˜æ˜¯ç›¸äº’ç‹¬ç«‹çš„</strong>ï¼Œæ›´æ”¹ä¸€ä¸ªå¯¹è±¡çš„æ•°æ®ä¸ä¼šå½±å“å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚</p></li></ul><div class="note note-warning">            <p>â€‹ğŸ’¡ PS. å¦‚æœä¸€ä¸ªç±»æ‹¥æœ‰æŒ‡é’ˆç±»å‹çš„æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹å°±éœ€è¦æ·±æ‹·è´ï¼Œå› ä¸ºåªæœ‰è¿™æ ·ï¼Œæ‰èƒ½å°†æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹å†å¤åˆ¶å‡ºä¸€ä»½æ¥ï¼Œè®©åŸæœ‰å¯¹è±¡å’Œæ–°ç”Ÿå¯¹è±¡ç›¸äº’ç‹¬ç«‹ï¼Œå½¼æ­¤ä¹‹é—´ä¸å—å½±å“ã€‚å¦‚æœç±»çš„æˆå‘˜å˜é‡æ²¡æœ‰æŒ‡é’ˆï¼Œä¸€èˆ¬æµ…æ‹·è´è¶³çŸ£ã€‚</p>          </div><ul><li><strong>æ·±æ‹·è´çš„å¼€é”€å¾€å¾€æ¯”æµ…æ‹·è´å¤§</strong>ï¼ˆé™¤éæ²¡æœ‰æŒ‡å‘åŠ¨æ€åˆ†é…å†…å­˜çš„å±æ€§ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å€¾å‘äºå°½å¯èƒ½ä½¿ç”¨æµ…æ‹·è´</li></ul><ol start="5"><li><p><strong>å·¦å€¼ã€å³å€¼</strong></p><ul><li><p>å·¦å€¼ï¼ˆlvalueï¼‰ï¼šè¡¨è¾¾å¼ç»“æŸåä¾ç„¶å­˜åœ¨çš„æŒä¹…å¯¹è±¡</p></li><li><p>å³å€¼ï¼ˆrvalueï¼‰ï¼šè¡¨è¾¾å¼ç»“æŸåå°±ä¸å†å­˜åœ¨çš„ä¸´æ—¶å¯¹è±¡ã€‚å­—é¢é‡ï¼ˆå­—ç¬¦å­—é¢é‡é™¤å¤–ï¼‰ã€ä¸´æ—¶çš„è¡¨è¾¾å¼å€¼ã€ä¸´æ—¶çš„å‡½æ•°è¿”è¿˜å€¼è¿™äº›çŸ­æš‚å­˜åœ¨çš„å€¼éƒ½æ˜¯å³å€¼ã€‚</p></li></ul><p>æ›´ç›´è§‚çš„ç†è§£æ˜¯ï¼šæœ‰å˜é‡åçš„å¯¹è±¡éƒ½æ˜¯å·¦å€¼ï¼Œæ²¡æœ‰å˜é‡åçš„éƒ½æ˜¯å³å€¼ã€‚ï¼ˆå› ä¸ºæœ‰æ— å˜é‡åæ„å‘³ç€è¿™ä¸ªå¯¹è±¡æ˜¯å¦åœ¨ä¸‹ä¸€è¡Œä»£ç æ—¶ä¾ç„¶å­˜åœ¨ï¼‰</p></li></ol><p>â€‹<div class="note note-warning">            <p>â€‹ğŸ’¡ PS. å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå­—ç¬¦å­—é¢é‡æ˜¯å”¯ä¸€ä¸å¯ç®—å…¥å³å€¼çš„å­—é¢é‡ï¼Œå› ä¸ºå®ƒå®é™…å­˜å‚¨åœ¨é™æ€å†…å­˜åŒºï¼Œæ˜¯æŒä¹…å­˜åœ¨çš„</p><p>â€‹</p>          </div></p><ol start="6"><li><p><strong>å³å€¼å¼•ç”¨</strong></p><p>å³å€¼å¼•ç”¨ç±»å‹ &amp;&amp;ç”¨äºåŒ¹é…å³å€¼ï¼Œå·¦å€¼å¼•ç”¨&amp;ç”¨äºåŒ¹é…å·¦å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//å·¦å€¼å¼•ç”¨å½¢å‚=&gt;åŒ¹é…å·¦å€¼</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Vector::Copy</span><span class="hljs-params">(Vector&amp; v)</span></span>&#123;<br>    <span class="hljs-keyword">this</span>-&gt;num = v.num;<br>    <span class="hljs-keyword">this</span>-&gt;a = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[num];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;num;++i)&#123;a[i]=v.a[i]&#125;<br>&#125;<br><br><span class="hljs-comment">//å³å€¼å¼•ç”¨å½¢å‚=&gt;åŒ¹é…å³å€¼</span><br><span class="hljs-type">void</span> Vector::<span class="hljs-built_in">Copy</span>(Vector&amp;&amp; temp)&#123;<br>    <span class="hljs-keyword">this</span>-&gt;num = temp.num;<br>    <span class="hljs-keyword">this</span>-&gt;a = temp.a;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå¯¹åº”å…³ç³»ï¼š</p><p>å·¦å€¼ â€”â€” å·¦å€¼å¼•ç”¨ â€”â€” æ·±æ‹·è´</p><p>å³å€¼ â€”â€” å³å€¼å¼•ç”¨ â€”â€” æµ…æ‹·è´</p><p>è¿™å’Œæ·±æµ…æ‹·è´çš„å®šä¹‰æ˜¯ç›¸ç¬¦çš„ï¼Œå› ä¸ºå³å€¼ä¸´æ—¶å­˜åœ¨ï¼Œç”¨å®Œå°±ä¸¢ï¼Œæ‰€ä»¥å°±ä¸å­˜åœ¨æ‹·è´ä¹‹ååŠ¨æ€åˆ†é…å†…å­˜å†²çªçš„é—®é¢˜ï¼Œé‚£å°±åªéœ€è¦æµ…æ‹·è´ï¼›å·¦å€¼åä¹‹</p></li><li><p><strong>å¼ºè½¬å³å€¼std::move()</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span></span>&#123;<br>    Vector result;<br>    <span class="hljs-comment">//...DoSomething with result</span><br><br>    <span class="hljs-keyword">if</span>(xxx)&#123;ans = result;&#125;  <br><span class="hljs-comment">//ç°åœ¨æˆ‘å¸Œæœ›æŠŠç»“æœæå–åˆ°å¤–éƒ¨çš„å˜é‡ansä¸Š</span><br><br><span class="hljs-comment">//...Do other things without result</span><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>resultèµ‹å€¼ç»™ansåå°±ä¸å†è¢«ä½¿ç”¨ï¼Œå› æ­¤æˆ‘ä»¬æœŸæœ›å®ƒè°ƒç”¨çš„æ˜¯<strong>ç§»åŠ¨èµ‹å€¼æ„é€ å‡½æ•°</strong>ã€‚ ä½†æ˜¯resultæ˜¯ä¸€ä¸ªæœ‰å˜é‡åçš„å·¦å€¼ç±»å‹ï¼Œå› æ­¤ans &#x3D; result è°ƒç”¨çš„æ˜¯æ‹·è´èµ‹å€¼æ„é€ å‡½æ•°è€Œéç§»åŠ¨èµ‹å€¼æ„é€ å‡½æ•°</p><p>è§£å†³åŠæ³•ï¼šç”¨c++11æä¾›çš„moveå¼ºè½¬å³å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span></span>&#123;<br>    Vector result;<br>    <span class="hljs-comment">//...DoSomething with result</span><br>   <br><span class="hljs-keyword">if</span>(xxx)&#123;ans = std::<span class="hljs-built_in">move</span>(result);&#125;   <br><span class="hljs-comment">//è°ƒç”¨çš„æ˜¯ç§»åŠ¨èµ‹å€¼æ„é€ å‡½æ•°</span><br><br><span class="hljs-comment">//...Do other things without result</span><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>å³å€¼å¼•ç”¨ç±»å‹å’Œå³å€¼çš„å…³ç³»</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp; o)</span> </span>&#123;std::cout &lt;&lt; <span class="hljs-string">&quot;ä¸ºå·¦å€¼ã€‚&quot;</span> &lt;&lt; std::endl;&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test</span><span class="hljs-params">(<span class="hljs-type">int</span>&amp;&amp; temp)</span> </span>&#123;std::cout &lt;&lt; <span class="hljs-string">&quot;ä¸ºå³å€¼ã€‚&quot;</span> &lt;&lt; std::endl;&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>  <span class="hljs-type">int</span> a;<br><span class="hljs-type">int</span>&amp;&amp; b = <span class="hljs-number">10</span>;<br>  <span class="hljs-comment">//è¯·åˆ†åˆ«å›ç­”ï¼šaã€std::move(a)ã€b åˆ†åˆ«æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Ÿ</span><br><span class="hljs-built_in">test</span>(a);<br><span class="hljs-built_in">test</span>(std::<span class="hljs-built_in">move</span>(a));<br><span class="hljs-built_in">test</span>(b);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç­”ï¼šaæ˜¯å·¦å€¼ï¼Œstd::move(a)æ˜¯å³å€¼ï¼Œä½†bå´æ˜¯å·¦å€¼ã€‚</p><p>åœ¨è¿™é‡Œbè™½ç„¶æ˜¯ int&amp;&amp; ç±»å‹ï¼Œä½†å´å› ä¸ºæœ‰å˜é‡åï¼ˆå³å¯æŒä¹…å­˜åœ¨ï¼‰ï¼Œè¢«ç¼–è¯‘å™¨è®¤ä¸ºæ˜¯å·¦å€¼ã€‚</p><p><strong>ç»“è®ºï¼šå³å€¼å¼•ç”¨ç±»å‹åªæ˜¯ç”¨äºåŒ¹é…å³å€¼ï¼Œè€Œå¹¶éè¡¨ç¤ºä¸€ä¸ªå³å€¼ã€‚å› æ­¤ï¼Œå°½é‡ä¸è¦å£°æ˜å³å€¼å¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œè€Œåªåœ¨å‡½æ•°å½¢å‚ä½¿ç”¨å®ƒä»¥åŒ¹é…å³å€¼ã€‚</strong></p></li><li><p><strong>è¡¥å……ï¼šæ„é€ å‡½æ•°ä¹‹åçš„å†’å·</strong></p><p>c++çš„è¯­æ³•ç‰¹æ€§ï¼Œå†’å·åé¢è·Ÿçš„æ˜¯èµ‹å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">A</span>(<span class="hljs-type">int</span> aa, <span class="hljs-type">int</span> bb):<span class="hljs-built_in">a</span>(aa), <span class="hljs-built_in">b</span>(bb) &#123;&#125;<br><br><span class="hljs-comment">//ç›¸å½“äº</span><br><span class="hljs-built_in">A</span>(<span class="hljs-type">int</span> aa, <span class="hljs-type">int</span> bb)<br>&#123;<br>a=aa;<br>b=bb;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h1 id="Lecture13ã€RAII-and-Smartpointer"><a href="#Lecture13ã€RAII-and-Smartpointer" class="headerlink" title="Lecture13ã€RAII and Smartpointer"></a>Lecture13ã€RAII and Smartpointer</h1><ol><li><p><strong>motivation</strong></p><p>æ‰‹åŠ¨ç”³è¯·åŠ¨æ€å†…å­˜+æ‰‹åŠ¨é‡Šæ”¾ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp">Person* p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Person</span>(id_number);<br><br><span class="hljs-comment">//do something</span><br><br><span class="hljs-keyword">delete</span> p;<br></code></pre></td></tr></table></figure><p>è‹¥åœ¨ç”³è¯·å®Œå†…å­˜ä¹‹åï¼Œdo somethingçš„è¿‡ç¨‹ä¸­ç”¨æŠ›å‡ºäº†å¼‚å¸¸ï¼ˆthrow an exceptionï¼‰ï¼Œé‚£å°±æ— æ³•æ‰§è¡Œdelete pï¼Œä»è€Œé€ æˆå†…å­˜æ³„æ¼ï¼ˆleak memoryï¼‰ã€‚ æ­¤é—®é¢˜è¿˜ä¸æ­¢æ˜¯æŒ‡é’ˆï¼Œæ–‡ä»¶çš„openå’Œcloseã€çº¿ç¨‹çš„try_lockå’Œunlockã€å¥—æ¥å­—çš„socketå’Œcloseï¼Œéƒ½æ˜¯è¿™æ ·çš„â€œé…å¥—æ“ä½œâ€ï¼Œ</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨RAIIï¼ˆResource Acquisition is Initalizationï¼‰åŸåˆ™ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p><ul><li><strong>All resources used by a class should be acquired in the constructor</strong></li><li><strong>All resources used by a class should be released in the destructor</strong></li></ul><p>å³key ideaæ˜¯åˆ©ç”¨<strong>â€œå¯¹è±¡çš„ææ„æ˜¯è‡ªåŠ¨å®Œæˆçš„â€</strong> â€”â€” ç”±äºå¯¹è±¡åœ¨go out of its own scopeåï¼Œææ„å‡½æ•°æ€»æ˜¯ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œé‚£ä¹ˆåªè¦éµå¾ªä¸Šé¢ä¸¤ç‚¹åŸåˆ™ï¼Œå°±å¯ä»¥é¿å…å†…å­˜æ³„æ¼äº†</p></li><li><p><strong>å®ä¾‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br> <br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10000000</span>; i++)<br>&#123;<br><span class="hljs-type">int32_t</span> *ptr = <span class="hljs-keyword">new</span> <span class="hljs-type">int32_t</span>[<span class="hljs-number">3</span>];<br>ptr[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>ptr[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;<br>ptr[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;<br><span class="hljs-comment">//delete ptr;     //å‡è®¾å¿˜è®°äº†é‡Šæ”¾å†…å­˜</span><br>&#125;<br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯æƒ³è€ŒçŸ¥ä¼šå æ®æå¤§çš„å†…å­˜ç©ºé—´</p><p>æˆ‘ä»¬å°†å…¶æ”¹è¿›ä¸ºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span><br> <br><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">auto_release_ptr</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-built_in">auto_release_ptr</span>(T *t) :<span class="hljs-type">_t</span>(t)&#123;&#125;;<br>~<span class="hljs-built_in">auto_release_ptr</span>()<br>&#123;<br><span class="hljs-keyword">delete</span> <span class="hljs-type">_t</span>;<br>&#125;;<br> <br><span class="hljs-function">T * <span class="hljs-title">getPtr</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-type">_t</span>;<br>&#125;<br> <br><span class="hljs-keyword">private</span>:<br>T *<span class="hljs-type">_t</span>;<br>&#125;;<br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10000000</span>; i++)<br>&#123;<br><span class="hljs-keyword">auto</span> arp = <span class="hljs-built_in">auto_release_ptr</span>&lt;<span class="hljs-type">int32_t</span>&gt;(<span class="hljs-keyword">new</span> <span class="hljs-type">int32_t</span>[<span class="hljs-number">3</span>]);<br><span class="hljs-type">int32_t</span> *ptr = arp.<span class="hljs-built_in">getPtr</span>();<br>ptr[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>ptr[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;<br>ptr[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;<br>&#125;<br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ€è·¯ï¼š</strong>å°†ç”³è¯·çš„intæŒ‡é’ˆæ‰˜ç®¡ç»™æ¨¡æ¿ç±»auto_release_ptrï¼Œå†å»å£°æ˜ä¸€ä¸ªæ™®é€šintæŒ‡é’ˆæŒ‡å‘ç”³è¯·çš„å†…å­˜ç©ºé—´ï¼ˆé€šè¿‡æ¥æ”¶ç±»æˆå‘˜å‡½æ•°çš„è¿”å›å€¼å®ç°ï¼‰ï¼Œä»è€Œè®©ptr ä¸ auto_release_ptr æ‹¥æœ‰äº†ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¯æ¬¡forå¾ªç¯è‡ªåŠ¨ææ„é‡Šæ”¾ï¼Œéå¸¸å¦™ã€‚</p></li><li><p><strong>æ™ºèƒ½æŒ‡é’ˆ</strong></p><p><strong>ï¼ˆ1ï¼‰std : : unique_ptr</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//æ™®é€šæŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">raw_ptr_fun</span><span class="hljs-params">()</span></span>&#123;<br>Node* n = <span class="hljs-keyword">new</span> Node;<br><span class="hljs-comment">//do things with n </span><br><span class="hljs-keyword">delete</span> n;<br>&#125;<br><br><span class="hljs-comment">//æ™ºèƒ½æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">smart_ptr_fun</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-function">std::unique_ptr&lt;Node&gt; <span class="hljs-title">n</span><span class="hljs-params">(<span class="hljs-keyword">new</span> node)</span></span>;<br><span class="hljs-comment">//do things with n </span><br><span class="hljs-comment">//automatically freed!</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>æ— æ³•è¿›è¡Œå·¦å€¼çš„èµ‹å€¼æˆ–èµ‹å€¼æ„é€ ï¼Œä½†å…è®¸ä¸´æ—¶å³å€¼èµ‹å€¼æ„é€ å’Œèµ‹å€¼ï¼ˆç”¨moveè¯­ä¹‰ï¼‰</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">unique_ptr&lt;string&gt; <span class="hljs-title">p1</span><span class="hljs-params">(<span class="hljs-keyword">new</span> string(<span class="hljs-string">&quot;I&#x27;m Li Ming!&quot;</span>))</span></span>;<br><span class="hljs-function">unique_ptr&lt;string&gt; <span class="hljs-title">p2</span><span class="hljs-params">(<span class="hljs-keyword">new</span> string(<span class="hljs-string">&quot;I&#x27;m age 22.&quot;</span>))</span></span>;<br><br>cout &lt;&lt; <span class="hljs-string">&quot;p1ï¼š&quot;</span> &lt;&lt; p1.<span class="hljs-built_in">get</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;p2ï¼š&quot;</span> &lt;&lt; p2.<span class="hljs-built_in">get</span>() &lt;&lt; endl;<br><br><span class="hljs-comment">//p1 = p2;// errorï¼ç¦æ­¢å·¦å€¼èµ‹å€¼</span><br><span class="hljs-comment">//unique_ptr&lt;string&gt; p3(p2);// errorï¼ç¦æ­¢å·¦å€¼èµ‹å€¼æ„é€ </span><br><br><span class="hljs-function">unique_ptr&lt;string&gt; <span class="hljs-title">p3</span><span class="hljs-params">(std::move(p1))</span></span>;<br>p1 = std::<span class="hljs-built_in">move</span>(p2);<span class="hljs-comment">// ä½¿ç”¨moveæŠŠå·¦å€¼è½¬æˆå³å€¼å°±å¯ä»¥èµ‹å€¼äº†</span><br><br>cout &lt;&lt; <span class="hljs-string">&quot;p1 = p2 èµ‹å€¼åï¼š&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;p1ï¼š&quot;</span> &lt;&lt; p1.<span class="hljs-built_in">get</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;p2ï¼š&quot;</span> &lt;&lt; p2.<span class="hljs-built_in">get</span>() &lt;&lt; endl;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/SjMudQh6KBbCa21.png"></p><div class="note note-warning">            <p>ğŸ’¡ PS. åœ¨è¿™é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒæŠŠp2 moveæˆä¸´æ—¶å€¼ä¹‹åï¼Œä¸€èµ‹å€¼ç»™p1ï¼Œå®ƒå°±è¢«é‡Šæ”¾æ‰äº†ï¼Œå†…å­˜åœ°å€ä¸ºnullptr</p>          </div><ul><li>æ’å®ƒå¼èµ„æºäº«ç”¨ï¼šä¸¤ä¸ªæŒ‡é’ˆä¸èƒ½æŒ‡å‘åŒä¸€ä¸ªèµ„æº</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">unique_ptr&lt;string&gt; p1;<br>string *str = <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>(<span class="hljs-string">&quot;æ™ºèƒ½æŒ‡é’ˆçš„å†…å­˜ç®¡ç†é™·é˜±&quot;</span>);<br>p1.<span class="hljs-built_in">reset</span>(str);<span class="hljs-comment">// p1æ‰˜ç®¡stræŒ‡é’ˆ</span><br>&#123;<br>unique_ptr&lt;string&gt; p2;<br>p2.<span class="hljs-built_in">reset</span>(str);<span class="hljs-comment">// p2æ¥ç®¡stræŒ‡é’ˆæ—¶ï¼Œä¼šå…ˆå–æ¶ˆp1çš„æ‰˜ç®¡ï¼Œç„¶åå†å¯¹strçš„æ‰˜ç®¡</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p2:&quot;</span> &lt;&lt;  *p2 &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// æ­¤æ—¶p1å·²ç»æ²¡æœ‰æ‰˜ç®¡å†…å®¹æŒ‡é’ˆäº†ï¼Œä¸ºNULLï¼Œåœ¨ä½¿ç”¨å®ƒå°±ä¼šå†…å­˜æŠ¥é”™ï¼</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p1:&quot;</span> &lt;&lt; *p1 &lt;&lt; endl;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/R8OfldcxjaFIHEV.png"></p><p><strong>ï¼ˆ2ï¼‰std : : shared_ptr</strong></p><p><strong>idea:</strong> è®°å½•å¼•ç”¨ç‰¹å®šå†…å­˜å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆæ•°é‡ï¼Œå½“å¤åˆ¶æˆ–æ‹·è´æ—¶ï¼Œ<strong>å¼•ç”¨è®¡æ•°åŠ 1</strong>ï¼Œå½“æ™ºèƒ½æŒ‡é’ˆææ„æ—¶ï¼Œ<strong>å¼•ç”¨è®¡æ•°å‡1</strong>ï¼Œå¦‚æœè®¡æ•°ä¸ºé›¶ï¼Œä»£è¡¨å·²ç»æ²¡æœ‰æŒ‡é’ˆæŒ‡å‘è¿™å—å†…å­˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±é‡Šæ”¾å®ƒ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-built_in">Person</span>() &#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;æ„é€ å‡½æ•° \\t &quot;</span> &lt;&lt; endl;<br>&#125;<br><br>~<span class="hljs-built_in">Person</span>() &#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;ææ„å‡½æ•° \\t &quot;</span> &lt;&lt; endl;<br>&#125;<br><br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>shared_ptr&lt;Person&gt; sp1;<br><br><span class="hljs-function">shared_ptr&lt;Person&gt; <span class="hljs-title">sp2</span><span class="hljs-params">(<span class="hljs-keyword">new</span> Person())</span></span>;<br><br><span class="hljs-comment">// è·å–æ™ºèƒ½æŒ‡é’ˆç®¡æ§çš„å…±äº«æŒ‡é’ˆçš„æ•°é‡use_count()ï¼šå¼•ç”¨è®¡æ•°</span><br>cout &lt;&lt; <span class="hljs-string">&quot;sp1use_count() = &quot;</span> &lt;&lt; sp1.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;sp2use_count() = &quot;</span> &lt;&lt; sp2.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl &lt;&lt; endl;<br><br><span class="hljs-comment">// å…±äº«,å³sp1å’Œsp2å…±åŒæ‰˜ç®¡åŒä¸€ä¸ªæŒ‡é’ˆ</span><br>sp1 = sp2;<br><br>cout &lt;&lt; <span class="hljs-string">&quot;sp1use_count() = &quot;</span> &lt;&lt; sp1.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;sp2use_count() = &quot;</span> &lt;&lt; sp2.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl &lt;&lt; endl;<br><br><span class="hljs-function">shared_ptr&lt;Person&gt; <span class="hljs-title">sp3</span><span class="hljs-params">(sp1)</span></span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;sp1use_count() = &quot;</span> &lt;&lt; sp1.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;sp2use_count() = &quot;</span> &lt;&lt; sp2.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;sp2use_count() = &quot;</span> &lt;&lt; sp3.<span class="hljs-built_in">use_count</span>() &lt;&lt; endl;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/cK9a5qX7MnjQHlv.png"></p><p><strong>ï¼ˆ3ï¼‰std : : weak_ptr</strong></p><p>â€‹TO-DO</p></li><li><p><strong>æ™ºèƒ½æŒ‡é’ˆåˆå§‹åŒ–æ–¹å¼</strong></p><p>å¸¸è§„åˆå§‹åŒ–æ–¹å¼æœ‰ä¸¤ç§ï¼šæ˜¾å¼è°ƒç”¨newã€ä½¿ç”¨make_unique()å‡½æ•°</p></li></ol><p><img src="https://s2.loli.net/2023/04/14/dIVEwpKhf47G5aH.png"></p><p><strong>Q:</strong> Which is betterï¼Ÿ</p><p><strong>A:</strong> std : : make_uniqueå’Œstd : : make_sharedæ›´å¥½ï¼Œå› ä¸º<strong>æ˜¾å¼è°ƒç”¨newä¼šåˆ†é…ä¸¤æ¬¡å†…å­˜</strong>ï¼ˆä¸€æ¬¡ç»™upï¼Œä¸€æ¬¡æ˜¯new Tï¼‰</p><hr><h1 id="Assignmentï¼šHashMap"><a href="#Assignmentï¼šHashMap" class="headerlink" title="Assignmentï¼šHashMap"></a>Assignmentï¼šHashMap</h1><ol><li><p><strong>usingå…³é”®å­—</strong></p><p>å¯ç”¨äºè®¾ç½®åˆ«åï¼ŒåŠŸèƒ½ç±»ä¼¼äºtypedef</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">using</span> value_type = std::pair&lt;<span class="hljs-type">const</span> K, M&gt;;<br></code></pre></td></tr></table></figure></li><li><p><strong>explicitå…³é”®å­—</strong></p><p>ä¿®é¥°classçš„constructorï¼Œä»¤å…¶åªèƒ½æ˜¾å¼å£°æ˜ï¼Œä¸èƒ½éšå¼è½¬æ¢orèµ‹å€¼åˆå§‹åŒ–</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-type">size_t</span> bucket_count, <span class="hljs-type">const</span> H&amp; hash = H())</span></span>;<br> <br><span class="hljs-function">HashMap&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; <span class="hljs-title">map</span><span class="hljs-params">(<span class="hljs-number">1.0</span>)</span></span>;  <span class="hljs-comment">// double -&gt; int conversion not allowed.</span><br>HashMap&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; map = <span class="hljs-number">1</span>;   <span class="hljs-comment">// copy-initialization, does not compile.</span><br></code></pre></td></tr></table></figure></li><li><p><strong>æˆå‘˜å‡½æ•°æœ«å°¾åŠ const â€”â€” å¸¸æˆå‘˜å‡½æ•°</strong></p><p>constæˆå‘˜å‡½æ•°å¯ä»¥ä½¿ç”¨ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å˜é‡ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹å®ƒä»¬çš„å€¼ï¼Œè¿™ç§æªæ–½ä¸»è¦ç›®çš„è¿˜æ˜¯ä¿æŠ¤æ•°æ®ã€‚é€šå¸¸å°† getç±»å‹çš„å‡½æ•°ï¼ˆget_valueã€get_sizeã€‚ã€‚ï¼‰è®¾ç½®ä¸ºå¸¸æˆå‘˜å‡½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">size_t</span> <span class="hljs-title">size</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> <span class="hljs-keyword">noexcept</span></span>;<br></code></pre></td></tr></table></figure><p>â€‹</p><div class="note note-warning">            <p>ğŸ’¡ PS.</p><ol><li>éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå¿…é¡»åœ¨æˆå‘˜å‡½æ•°çš„å£°æ˜å’Œå®šä¹‰å¤„åŒæ—¶åŠ ä¸Š const å…³é”®å­—ã€‚<code>char *getname() const</code>å’Œ<code>char *getname()</code>æ˜¯ä¸¤ä¸ªä¸åŒçš„å‡½æ•°åŸå‹ï¼Œå¦‚æœåªåœ¨ä¸€ä¸ªåœ°æ–¹åŠ  const ä¼šå¯¼è‡´å£°æ˜å’Œå®šä¹‰å¤„çš„å‡½æ•°åŸå‹å†²çªã€‚</li><li>åŒºåˆ†ä¸€ä¸‹ const çš„ä½ç½®ï¼š<ul><li>å‡½æ•°å¼€å¤´çš„ const ç”¨æ¥ä¿®é¥°å‡½æ•°çš„è¿”å›å€¼ï¼Œè¡¨ç¤ºè¿”å›å€¼æ˜¯ const ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è¢«ä¿®æ”¹ï¼Œä¾‹å¦‚<code>const char * getname()</code></li><li>å‡½æ•°å¤´éƒ¨çš„ç»“å°¾åŠ ä¸Š const è¡¨ç¤ºå¸¸æˆå‘˜å‡½æ•°ï¼Œè¿™ç§å‡½æ•°åªèƒ½è¯»å–æˆå‘˜å˜é‡çš„å€¼ï¼Œè€Œä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡çš„å€¼ï¼Œä¾‹å¦‚<code>char * getname() const</code></li></ul></li></ol>          </div></li><li><p><strong>noexceptå…³é”®å­—</strong></p><p>ç¨‹åºå‘˜åœ¨è¯­ä¹‰å±‚é¢å£°æ˜â€œæˆ‘ä¿è¯è¿™ä¸ªå‡½æ•°ä¸ä¼šå¼‚å¸¸ï¼Œç¼–è¯‘å™¨ä½ ä¸ç”¨æ£€æŸ¥äº†â€ï¼Œä¹‹åç¼–è¯‘å™¨å°±ä¸ä¼šå¯¹è¯¥å‡½æ•°è¿›è¡Œå¼‚å¸¸æ£€æŸ¥ï¼Œä¹Ÿæ²¡åŠæ³•å®æ–½try-catchæ“ä½œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func_not_throw</span><span class="hljs-params">()</span> <span class="hljs-keyword">noexcept</span> </span>&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-number">1</span>;<br><span class="hljs-comment">// noexceptå‡½æ•°ä¸­æœ¬ä¸åº”æœ‰throwï¼Œæ²¡æ„ä¹‰ï¼Œä½†ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥æ˜¯å¦æœ‰throw</span><br><span class="hljs-comment">// æ‰€ä»¥ç¼–è¯‘é€šè¿‡ï¼Œä¸ä¼šæŠ¥é”™ï¼ˆå¯èƒ½ä¼šæœ‰è­¦å‘Šï¼‰</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-built_in">func_not_throw</span>(); <span class="hljs-comment">// ç›´æ¥ terminateï¼Œä¸ä¼šè¢« catch</span><br>    &#125; <span class="hljs-built_in">catch</span> (<span class="hljs-type">int</span>) &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;catch int&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>æ³¨æ„ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br> <br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">CTest</span><br>&#123;<br><span class="hljs-keyword">public</span>:<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span><br><span class="hljs-function"></span>&#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;const&quot;</span> &lt;&lt; endl;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;normal&quot;</span> &lt;&lt; endl;<br>&#125;<br>&#125;;<br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>CTest a;<br>a.<span class="hljs-built_in">show</span>();<br> <br><span class="hljs-type">const</span> CTest b;<br>b.<span class="hljs-built_in">show</span>();<br> <br><span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/48HvQ9oENy1ksPd.png"></p><p>è¿™ä¸¤ä¸ªshowå‡½æ•°å¯ä¸æ˜¯é‡è½½ï¼<strong>é‡è½½å‡½æ•°çš„å½¢å‚å¿…é¡»ä¸åŒï¼ï¼</strong>è¿™ä¿©å°±ä¸æ˜¯åŒä¸€ä¸ªå‡½æ•°åŸå‹ï¼ˆå› ä¸ºåŠ äº†constï¼Œæ˜¯å¸¸æˆå‘˜å‡½æ•°ï¼‰</p><p>é‚£ä¹ˆè°ƒç”¨çš„æ—¶å€™å¦‚ä½•åŒºåˆ†è¿™ä¿©æï¼Ÿ</p><p>å®ƒä»¬å„è‡ªè¢«è°ƒç”¨çš„æ—¶æœºä¸ºï¼š<strong>å¦‚æœå®šä¹‰çš„å¯¹è±¡æ˜¯å¸¸å¯¹è±¡ï¼Œåˆ™è°ƒç”¨çš„æ˜¯constæˆå‘˜å‡½æ•°ï¼Œå¦‚æœå®šä¹‰çš„å¯¹è±¡æ˜¯éå¸¸å¯¹è±¡ï¼Œåˆ™è°ƒç”¨é‡è½½çš„éconstæˆå‘˜å‡½æ•°ã€‚</strong></p><div class="note note-warning">            <p> ğŸ’¡ PS. ä¸è¿‡ä»å¦ä¸€ä¸ªè§’åº¦æ¥ç†è§£ï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒä¿©çœ‹æˆé‡è½½ â€”â€” é¦–å…ˆç†è§£ä¸‹å‡½æ•°ç­¾åï¼šå®ƒåŒ…å«ç€ä¸€ä¸ªå‡½æ•°çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬<strong>å‡½æ•°åã€å‚æ•°ç±»å‹ã€å‚æ•°ä¸ªæ•°ã€é¡ºåºä»¥åŠå®ƒæ‰€åœ¨çš„ç±»å’Œå‘½åç©ºé—´ï¼Œ</strong>ä¸¤ä¸ªå‡½æ•°åªæœ‰åœ¨ç­¾åä¸åŒæ—¶æ‰èƒ½è¢«åŒºåˆ†ã€‚<br>é‚£ä¸Šé¢ä¸¤ä¸ªshow( )çš„ç­¾ååˆ°åº•å“ªé‡Œä¸åŒäº†æï¼Ÿ ç­”æ¡ˆæ˜¯å‚æ•°ç±»å‹ï¼Œæ¯ä¸ªæˆå‘˜å‡½æ•°çš„å‚æ•°ä¸­å…¶å®è‡ªå¸¦thisæŒ‡é’ˆï¼Œåªä¸è¿‡è—èµ·æ¥äº†ï¼Œè°è°ƒç”¨æˆå‘˜å‡½æ•°ï¼Œthis å°±æŒ‡å‘è°ã€‚<strong>è€Œæˆå‘˜å‡½æ•°å°¾å·´ä¸Šçš„constï¼Œå®è´¨ä¿®é¥°çš„æ˜¯thisæŒ‡é’ˆï¼</strong> å½“aè°ƒç”¨showæ–¹æ³•æ—¶ï¼Œå‡½æ•°ç­¾åä¸ºshow(a){}ï¼Œå³aä¼ ç»™thisæŒ‡é’ˆï¼Œä¸€çœ‹ï¼Œè¯¶ï¼aä¸ºéå¸¸å¯¹è±¡ï¼Œå¯¹åº”æ™®é€šthisæŒ‡é’ˆï¼Œå³éconstç‰ˆæœ¬çš„show()ï¼›båŒç†ã€‚</p>          </div></li><li><p><strong>typenameå…³é”®å­—ä½œç”¨</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Map, <span class="hljs-type">bool</span> IsConst&gt;<br><span class="hljs-keyword">typename</span> HashMapIterator&lt;Map, IsConst&gt;::reference HashMapIterator&lt;Map, IsConst&gt;::<span class="hljs-keyword">operator</span>*() <span class="hljs-type">const</span> &#123;<br>    <span class="hljs-keyword">return</span> _node-&gt;value; <br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>ä½œä¸ºç±»å‹å£°æ˜ï¼Œæ•ˆæœå®Œå…¨ç­‰åŒäºclass â€”â€” ä»£ç ä¸­çš„typename Mapç­‰åŒäºclass Mapï¼Œå®ƒä¿©éƒ½æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œâ€œæˆ‘åé¢è·Ÿç€çš„è¿™ä¸ªæ˜¯ä¸ªç±»å‹åç§°ï¼Œè€Œä¸æ˜¯æˆå‘˜å˜é‡æˆ–æˆå‘˜å‡½æ•°â€ã€‚ï¼ˆè¿™å¥½åƒä¹Ÿèƒ½æ˜ è¯â€œæ¨¡æ¿å‡½æ•°åœ¨å®ä¾‹åŒ–åæ‰ä¼šè¢«ç¼–è¯‘â€ï¼‰</p></li><li><p>ä½œä¸º<strong>ä¿®é¥°å…³é”®å­—ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">fun</span><span class="hljs-params">(<span class="hljs-type">const</span> T&amp; proto)</span></span>&#123;<br>    <span class="hljs-function">T::const_iterator <span class="hljs-title">it</span><span class="hljs-params">(proto.begin())</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>motivationï¼š</strong>è™½ç„¶äººç±»ç¼–ç¨‹è€…ä¸€çœ¼å°±çŸ¥é“const_iteratoræ˜¯ä¸ªç±»å‹åç§°ï¼Œä½†ç¼–è¯‘å™¨ä¸çŸ¥é“å‘€ï¼Œä¸‡ä¸€å®ƒæ˜¯ä¸ªå˜é‡å‘¢ï¼Ÿåœ¨æ¨¡æ¿å®ä¾‹åŒ–ä¹‹å‰ï¼Œå®Œå…¨æ²¡æœ‰åŠæ³•æ¥åŒºåˆ†å®ƒä»¬ï¼Œæ‰€ä»¥è¿™ä¸ªå†™æ³•æ˜¯ä¼šerrorçš„ï¼ æ€ä¹ˆåŠæï¼Ÿ è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨typenameå…³é”®å­—æ¥ä¿®é¥°ï¼Œç¼–è¯‘å™¨æ‰ä¼šå°†è¯¥åç§°å½“æˆæ˜¯ç±»å‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">typename</span> T::const_iterator <span class="hljs-title">it</span><span class="hljs-params">(proto.begin())</span></span>;<br></code></pre></td></tr></table></figure><p>è¿™æ ·ç¼–è¯‘å™¨å°±å¯ä»¥ç¡®å®šT: :const_iteratoræ˜¯ä¸€ä¸ªç±»å‹ï¼Œè€Œä¸å†éœ€è¦ç­‰åˆ°å®ä¾‹åŒ–æ—¶æœŸæ‰èƒ½ç¡®å®šï¼Œå› æ­¤æ¶ˆé™¤äº†å‰é¢æåˆ°çš„æ­§ä¹‰ã€‚</p><div class="note note-warning">            <p>ğŸ’¡ PS. æ€»ç»“ï¼šåŒæ—¶ä½¿ç”¨æ¨¡æ¿ç±»Tå’ŒåŸŸè§£æç¬¦: : æ—¶ï¼Œå°±å¾—åŠ typename</p>          </div></li></ul></li><li><p>æ¨¡æ¿ç±»ä¸­çš„æˆå‘˜å‡½æ•°ï¼ˆå¾€å¾€ä¹Ÿæ˜¯æ¨¡æ¿å‡½æ•°ï¼‰çš„å…·ä½“å®ç°é€šå¸¸ä¹Ÿä¼šæ”¾åœ¨.hä¸­ï¼Œé™¤éå‡½æ•°å¤ªå¤šå¤ªé•¿</p></li><li><p>ä¸¤ä¸ªæŒ‡é’ˆç›¸å‡ &#x3D; ä¸¤æŒ‡é’ˆçš„åœ°å€å·®å€¼&#x2F;sizeof(æ•°æ®ç±»å‹)ï¼Œå³å¾—åˆ°çš„ç»“æœå°±æ˜¯ä¸¤æŒ‡é’ˆä¹‹é—´é—´éš”çš„å…ƒç´ ä¸ªæ•°</p><p>æ³¨æ„ï¼š ä¸éœ€è¦äººä¸ºæ‰‹åŠ¨å»é™¤sizeofå“ˆï¼å‡å·è‡ªåŠ¨ä¼šå®Œæˆè¿™ä¸ªæ“ä½œï¼ˆcå’Œcppä¸­éƒ½æ˜¯ï¼‰</p></li><li><p><strong>è¿ç®—ç¬¦é‡è½½</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">//ç§’è¡¨ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">stopwatch</span>&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">stopwatch</span>(): <span class="hljs-built_in">m_min</span>(<span class="hljs-number">0</span>), <span class="hljs-built_in">m_sec</span>(<span class="hljs-number">0</span>)&#123; &#125;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setzero</span><span class="hljs-params">()</span></span>&#123; m_min = <span class="hljs-number">0</span>; m_sec = <span class="hljs-number">0</span>; &#125;<br>    <span class="hljs-function">stopwatch <span class="hljs-title">run</span><span class="hljs-params">()</span></span>;  <span class="hljs-comment">// è¿è¡Œ</span><br>    stopwatch <span class="hljs-keyword">operator</span>++();  <span class="hljs-comment">//++iï¼Œå‰ç½®å½¢å¼</span><br>    stopwatch <span class="hljs-keyword">operator</span>++(<span class="hljs-type">int</span> n);  <span class="hljs-comment">//i++ï¼Œåç½®å½¢å¼</span><br>    <span class="hljs-keyword">friend</span> ostream &amp; <span class="hljs-keyword">operator</span>&lt;&lt;( ostream &amp;, <span class="hljs-type">const</span> stopwatch &amp;);<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-type">int</span> m_min;  <span class="hljs-comment">//åˆ†é’Ÿ</span><br>    <span class="hljs-type">int</span> m_sec;  <span class="hljs-comment">//ç§’é’Ÿ</span><br>&#125;;<br><br><span class="hljs-function">stopwatch <span class="hljs-title">stopwatch::run</span><span class="hljs-params">()</span></span>&#123;<br>    ++m_sec;<br>    <span class="hljs-keyword">if</span>(m_sec == <span class="hljs-number">60</span>)&#123;<br>        m_min++;<br>        m_sec = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>&#125;<br><br>stopwatch stopwatch::<span class="hljs-keyword">operator</span>++()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">run</span>();<br>&#125;<br><br>stopwatch stopwatch::<span class="hljs-keyword">operator</span>++(<span class="hljs-type">int</span> n)&#123;<br>    stopwatch s = *<span class="hljs-keyword">this</span>;<br>    <span class="hljs-built_in">run</span>();<br>    <span class="hljs-keyword">return</span> s;<br>&#125;<br><br>ostream &amp;<span class="hljs-keyword">operator</span>&lt;&lt;( ostream &amp; out, <span class="hljs-type">const</span> stopwatch &amp; s)&#123;<br>    out&lt;&lt;<span class="hljs-built_in">setfill</span>(<span class="hljs-string">&#x27;0&#x27;</span>)&lt;&lt;<span class="hljs-built_in">setw</span>(<span class="hljs-number">2</span>)&lt;&lt;s.m_min&lt;&lt;<span class="hljs-string">&quot;:&quot;</span>&lt;&lt;<span class="hljs-built_in">setw</span>(<span class="hljs-number">2</span>)&lt;&lt;s.m_sec;<br>    <span class="hljs-keyword">return</span> out;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    stopwatch s1, s2;<br><br>    s1 = s2++;<br>    cout &lt;&lt; <span class="hljs-string">&quot;s1: &quot;</span>&lt;&lt; s1 &lt;&lt;endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;s2: &quot;</span>&lt;&lt; s2 &lt;&lt;endl;<br>    s1.<span class="hljs-built_in">setzero</span>();<br>    s2.<span class="hljs-built_in">setzero</span>();<br><br>    s1 = ++s2;<br>    cout &lt;&lt; <span class="hljs-string">&quot;s1: &quot;</span>&lt;&lt; s1 &lt;&lt;endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;s2: &quot;</span>&lt;&lt; s2 &lt;&lt;endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>C++è¿ç®—ç¬¦é‡è½½ï¼Œæœ¬è´¨ä¸Šç­‰äºå®šä¹‰ä¸€ä¸ªæˆå‘˜å‡½æ•°(å®é™…ä¸Šä¹Ÿå¯èƒ½æ˜¯å…¨å±€å‡½æ•°)ã€‚ä¾‹å¦‚a+bï¼Œæœ¬è´¨ä¸Šç­‰åŒäºè°ƒç”¨å‡½æ•°<strong>ã€Œa.operator+(b)ã€</strong>ï¼Œè¯¥å‡½æ•°çš„åå­—å«ã€Œoperator+ã€ ++çš„é‡è½½åˆ†ä¸ºå‰ç½®å’Œåç½®æƒ…å†µï¼Œa &#x3D; ++b;(å‰ç½®)ï¼Œ a &#x3D; b++;(åç½®)ã€‚å› ä¸ºç¬¦å·ä¸€æ ·ï¼Œæ‰€ä»¥ç»™åç½®ç‰ˆæœ¬åŠ ä¸€ä¸ªintå½¢å‚ä½œä¸ºåŒºåˆ†ï¼Œè¿™ä¸ªå½¢å‚æ˜¯0ï¼Œä½†æ˜¯åœ¨å‡½æ•°ä½“ä¸­æ˜¯ç”¨ä¸åˆ°çš„ï¼Œåªæ˜¯ä¸ºäº†åŒºåˆ†å‰ç½®åç½®ã€‚ è‡³äºä¸ºå•¥åŠ äº†ä¸ªå½¢å‚å°±èƒ½åŒºåˆ†å‰åç¼€ï¼Œæ²¡æƒ³æ‡‚ï¼Œä¹Ÿæ²¡æŸ¥åˆ°èµ„æ–™</p></li><li><p><strong>thisæŒ‡é’ˆ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> K, <span class="hljs-keyword">typename</span> M, <span class="hljs-keyword">typename</span> H&gt;<br>HashMap&lt;K, M, H&gt;::~<span class="hljs-built_in">HashMap</span>() &#123;<br>    <span class="hljs-built_in">clear</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè°ƒç”¨clear()ç”¨ä¸ç”¨åŠ thisæŒ‡é’ˆï¼Ÿ ç­”æ¡ˆæ˜¯å¯åŠ å¯ä¸åŠ ï¼Œç¼–è¯‘å™¨éƒ½ä¼šéšå¼è°ƒç”¨</p><p>Q: ä»€ä¹ˆæ—¶å€™thisæŒ‡é’ˆæ˜¯å¿…ä¸å¯å°‘çš„æï¼Ÿ </p><p>A: å½“ä½ åœ¨å¯¹è±¡æ–¹æ³•é‡Œéœ€è¦<strong>æ˜ç¡®</strong>ä½¿ç”¨è‡ªå·±çš„æ—¶å€™ï¼Œæ¯”å¦‚åŒºåˆ†åŒåçš„å½¢å‚å’Œæˆå‘˜å˜é‡</p></li><li><p>å½“ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¸ºå¼•ç”¨ç±»å‹æ—¶ï¼Œ<strong>ä¸è¦return æŸä¸ªåœ¨stackä¸Šçš„å˜é‡çš„å¼•ç”¨ï¼</strong>ï¼ˆå¦åˆ™è¯¥å‡½æ•°ä¸€é€€å‡ºï¼Œstackå°±é‡Šæ”¾ï¼Œå¼•ç”¨å°±æ‰äº†ï¼‰</p></li><li><p><strong>éå†ç±»çš„å®ä¾‹åŒ–å¯¹è±¡ï¼ˆè‡ªå®šä¹‰ç±»çš„è¿­ä»£å™¨ï¼‰</strong></p></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">bool</span> <span class="hljs-keyword">operator</span>==(<span class="hljs-type">const</span> HashMap&lt;K, M, H&gt;&amp; lhs, <span class="hljs-type">const</span> HashMap&lt;K, M, H&gt;&amp; rhs) &#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> [key, mapped] : lhs)&#123;<br>        ã€‚ã€‚ã€‚<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Q: lhsæ˜¯è‡ªå®šä¹‰çš„HashMapç±»ï¼Œå…¶æˆå‘˜å˜é‡ä¸åªæ˜¯è£…æœ‰&lt;key, mapped&gt;çš„é“¾è¡¨ï¼Œè¿˜æœ‰å„ç§int sizeã€int load_factorç­‰å±æ€§å•Šï¼Œä¸ºå•¥å¯ä»¥ç›´æ¥ç”¨ : è¿›è¡Œrange based for loopæï¼Ÿæˆ–è€…è¯´ï¼Œä¸ºå•¥åªä¼šå¾ªç¯åˆ°æƒ³è¦çš„é“¾è¡¨ï¼Œè€Œä¸ä¼šè®¿é—®å…¶å®ƒæˆå‘˜å˜é‡æï¼Ÿ</p><p>A: ä¹‹æ‰€ä»¥ä¼šæœ‰ä¸Šè¿°è¯¯åŒºï¼Œ<strong>æ˜¯å› ä¸ºæŠŠrange basedå¾ªç¯å½“æˆäº†ç¼–è¯‘å™¨å†…ç½®è¿ç®—ç¬¦ï¼Œäº‹å®ä¸Šæ˜¯è‡ªå·±è¦ä¸ºè¯¥ç±»å®šä¹‰ä¸€ä¸ªiteratorç±»ï¼</strong></p><p>range basedçš„ : ç¬¦å·åªæ˜¯ä¸€ç§ç®€ç•¥å†™æ³•ï¼Œå®ƒçš„æºç å®ç°å¤§æ¦‚ä¸ºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">for</span> ( range_declaration : range_expression) loop_statement<br>&#123;  <br>    <span class="hljs-keyword">auto</span> &amp;&amp; __range = range_expression ;   <br>    <span class="hljs-keyword">auto</span> __begin = <span class="hljs-built_in">begin_expr</span>(__range);   <br>    <span class="hljs-keyword">auto</span> __end = <span class="hljs-built_in">end_expr</span>(__range);   <br>    <span class="hljs-keyword">for</span> (;__begin != __end; ++__begin) &#123;  <br>        range_declaration = *__begin;   <br>        loop_statement   <br>    &#125;   <br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ï¼Œè‡ªå®šä¹‰çš„iteratorç±»è‡³å°‘è¦æœ‰5ä¸ªåŠŸèƒ½ï¼š</p><ul><li>begin( )</li><li>end( )</li><li>é‡è½½++ã€*ã€! &#x3D;ä¸‰ä¸ªè¿ç®—ç¬¦</li></ul><p>å…¶ä¸­begin( )ã€end( )è¿”å›ç±»å‹å°±æ˜¯iterator</p><p>ç°åœ¨å°±å¯ä»¥ç†è§£ä¸ºå•¥å¯ç”¨range basedå¾ªç¯è·å–è‡ªå®šä¹‰ç±»ä¸­æƒ³è¦çš„æ•°æ®äº† â€”â€” iteratoråŠŸèƒ½å…¨æ˜¯ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ï¼Œæƒ³è·å–å•¥å°±è·å–å•¥æ</p><ol start="13"><li><strong>Q: å³å€¼å¼•ç”¨çš„ç±»å¯¹è±¡çš„å±æ€§ä¹Ÿæ˜¯å³å€¼å—ï¼Ÿ</strong></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//ç§»åŠ¨æ„é€ å‡½æ•°</span><br><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> K, <span class="hljs-keyword">typename</span> M, <span class="hljs-keyword">typename</span> H&gt;<br>HashMap&lt;K, M, H&gt;::<span class="hljs-built_in">HashMap</span>(HashMap&amp;&amp; rhs):<br>    _size&#123;rhs._size&#125;,<br>    _hash_function&#123;rhs._hash_function&#125;,<br>    _buckets_array&#123;rhs.<span class="hljs-built_in">bucket_count</span>(), <span class="hljs-literal">nullptr</span>&#125; &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">bucket_count</span>(); i++)&#123;<br>        _buckets_array[i] = rhs._buckets_array[i];<br>        rhs._buckets_array[i] = <span class="hljs-literal">nullptr</span>;<br>    &#125;<br>    rhs._size = <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>A: å°†ç±»å¯¹è±¡ç”¨move()å¼ºè½¬ä¸ºå³å€¼ï¼Œå¹¶ä¸å½±å“ç±»ä¸­æˆå‘˜å˜é‡çš„å·¦å³å€¼å±æ€§ï¼Œè¯¥æ˜¯å•¥è¿˜æ˜¯å•¥</p><ol start="14"><li><p><strong>å¯¹ä¸Šé¢è¿™ä¸ªé—®é¢˜çš„è¿›ä¸€æ­¥æ·±å±‚ç†è§£ï¼š</strong></p><p>Q: è¢«move()è¿‡çš„å˜é‡ä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨ç»™é”€æ¯å—ï¼Ÿå¦‚æœä¼šï¼Œé‚£ä¸ºå•¥è¿˜è¦æ‰‹åŠ¨è®©rhs._buckets_array[i] æŒ‡å‘nullptrï¼Ÿå¦‚æœä¸ä¼šï¼Œé‚£å¼ºè½¬å³å€¼æœ‰å•¥æ„ä¹‰å•Šï¼Ÿ</p><p>A: å˜é‡ä¼šè¢«æ€ä¹ˆå¤„ç†ï¼Œä¸å®ƒæ˜¯å¦è¢«move()è¿‡æ²¡åŠæ¯›é’±å…³ç³»ï¼Œ<strong>move()å¹¶ä¸æ”¹å˜å˜é‡æœ¬èº«ï¼Œåªæ˜¯é¢å¤–æä¾›äº†ä¸€ä¸ªreturnçš„å³å€¼</strong>ï¼Œè¿™ä¸€ç‚¹çœ‹æºç å³å¯æ˜ç™½</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// FUNCTION TEMPLATE move</span><br><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">_Ty</span>&gt;<br><span class="hljs-function"><span class="hljs-type">remove_reference_t</span>&lt;_Ty&gt;&amp;&amp; <span class="hljs-title">move</span><span class="hljs-params">(_Ty&amp;&amp; _Arg)</span> <span class="hljs-keyword">noexcept</span> </span>&#123; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-type">remove_reference_t</span>&lt;_Ty&gt;&amp;&amp;&gt;(_Arg);<br>&#125;<br><span class="hljs-comment">//åªæ˜¯æŠŠè¿”å›å€¼ç”¨static_castå¼ºåˆ¶è½¬æ¢æˆå³å€¼ï¼Œä½†ä¼ å…¥çš„åŸå˜é‡è¯¥æ˜¯å•¥è¿˜æ˜¯å•¥</span><br></code></pre></td></tr></table></figure><p>é‚£move()çš„æ„ä¹‰æ˜¯å•¥æ â€”â€” <strong>å¤šæä¾›ä¸€ç§æ•°æ®ç±»å‹ï¼Œç”¨äºé‡è½½å‡½æ•°çš„å½¢å‚åŒ¹é…</strong>ã€‚ è¯´ç™½äº†ï¼Œå°±æ˜¯<strong>æ‰‹åŠ¨å¸®åŠ©ç¼–è¯‘å™¨é€‰æ‹©é‡è½½å‡½æ•°ï¼ŒåŒæ—¶å‘ç¼–è¯‘å™¨å‘èª“å†ä¹Ÿä¸ç¢°è¿™ä¸ªå¯¹è±¡</strong>ï¼ é‚£è¿™ä¸ªä½œç”¨çš„motivationåˆæ˜¯å•¥æ â€”â€” è‹¥æ²¡æœ‰å³å€¼å¼•ç”¨ï¼Œé‚£æ‹·è´å‡½æ•°å°±è¦åˆ†æˆdeep_copy()å’Œshallow_copy()ä¸¤ä¸ªç‰ˆæœ¬æ¥å†™ï¼Œä¸”æ¯æ¬¡éƒ½è¦æ‰‹åŠ¨æ˜¾å¼è°ƒç”¨ â€”â€” è¿™æ—¢éº»çƒ¦ï¼Œåˆå®¹æ˜“å‡ºé”™ï¼›ä½†åˆ©ç”¨é‡è½½å†™æˆcopy(const T&amp; val)å’Œcopy(T&amp;&amp; val)åï¼Œå°±å¯ä»¥è®©ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨ã€‚è€Œè‹¥ç”¨æˆ·è‡ªå·±å‘ç°ï¼Œè¯¶ï¼è¿™ä¸ªæŒ‡é’ˆaè™½ç„¶æ˜¯å·¦å€¼ï¼Œä½†æˆ‘ä¹‹åä¸ç”¨äº†ï¼Œå¯ä»¥ç›´æ¥æµ…æ‹·è´ï¼Œokï¼Œé‚£ç”¨move()å¼ºè½¬ä¸€æ¬¡å³å¯ï¼Œå³æ‰€è°“çš„â€œæ‰‹åŠ¨å¸®ç¼–è¯‘å™¨é€‰æ‹©é‡è½½å‡½æ•°â€ã€‚ å›åˆ°ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œç»move()çš„å˜é‡ä¼šè¢«é”€æ¯å’©ï¼Ÿ é‚£å¾—çœ‹ç§»åŠ¨æ„é€ å‡½æ•°&#x2F;ç§»åŠ¨èµ‹å€¼æ„é€ å‡½æ•°æ˜¯å’‹å®ç°çš„ï¼šåœ¨ä¸Šé¢HashMapçš„é‚£ä¸ªç§»åŠ¨æ„é€ å‡½æ•°ä¸­ï¼Œæ‰‹åŠ¨é‡Šæ”¾äº†æŒ‡é’ˆå¹¶è®©sizeæ¸…é›¶ï¼ˆè¿™ä¹Ÿæ˜¯ç¬¦åˆå®é™…å†™ä»£ç çš„æ€è·¯çš„ï¼Œæ—¢ç„¶è®¤å®šäº†â€œè¿™ä¸ªå¯¹è±¡ä¸ä¼šå†ç¢°â€ï¼Œé‚£å°±åº”è¯¥é‡Šæ”¾å®ƒï¼Œç•™ç€æ—¢å ç©ºé—´ã€åˆæœ‰ä¿®æ”¹å†…å­˜çš„é£é™©ï¼‰ï¼›åä¹‹ï¼Œå¦‚æœç§»åŠ¨æ„é€ å‡½æ•°ä¸­æ²¡é‡Šæ”¾å³å€¼ï¼Œé‚£å®ƒå°±åŸå°ä¸åŠ¨åœ°åœ¨é‚£å„¿ â€”â€” è¯´åˆ°åº•ï¼Œè¿˜æ˜¯<strong>ä¸å˜é‡æ˜¯å·¦å€¼&#x2F;å³å€¼æœ¬èº«æ²¡åŠæ¯›é’±å…³ç³»ï¼Œè€Œæ˜¯å–å†³äºSMFä¸­æ€ä¹ˆå»å¤„ç†è¿™ä¸ªå˜é‡</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test_fun</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; val)</span></span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;value: &quot;</span> &lt;&lt; val&lt;&lt; <span class="hljs-string">&quot;, type: å·¦å€¼&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test_fun</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp;&amp; val)</span></span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;value: &quot;</span> &lt;&lt; val&lt;&lt; <span class="hljs-string">&quot;, type: å³å€¼&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> b = <span class="hljs-built_in">move</span>(a);<br>    <span class="hljs-built_in">test_fun</span>(a); <span class="hljs-comment">//aæ²¡æœ‰è¢«é”€æ¯</span><br>    <span class="hljs-built_in">test_fun</span>(b);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/H3Y1s7jSPFquXCK.png"></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>æ ¸å¿ƒç§‘æŠ€çœ‹ç¾å¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>c++</tag>
      
      <tag>æ–¯å¦ç¦</tag>
      
      <tag>hashmap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŠCS61Cç¬”è®°ã€‹</title>
    <link href="/2023/04/14/%E3%80%8ACS61C%E7%AC%94%E8%AE%B0%E3%80%8B/"/>
    <url>/2023/04/14/%E3%80%8ACS61C%E7%AC%94%E8%AE%B0%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>è¯¾ç¨‹æ¥æºï¼šUCB-CS61C(20 summer)</p><p>è¯¾ç¨‹ä»‹ç»ï¼š<a href="https://github.com/qlhhahaha/CS61C-SU20">https://github.com/qlhhahaha/CS61C-SU20</a></p>          </div><h1 id="ã€ŠCS61Cç¬”è®°ã€‹-qlhhahaha"><a href="#ã€ŠCS61Cç¬”è®°ã€‹-qlhhahaha" class="headerlink" title="ã€ŠCS61Cç¬”è®°ã€‹@qlhhahaha"></a>ã€ŠCS61Cç¬”è®°ã€‹@qlhhahaha</h1><hr><h3 id="Q-C-å®Œå…¨å…¼å®¹Cï¼Œä¸ºä»€ä¹ˆCè¿˜æœ‰å•ç‹¬å­˜åœ¨çš„å¿…è¦ï¼Ÿ"><a href="#Q-C-å®Œå…¨å…¼å®¹Cï¼Œä¸ºä»€ä¹ˆCè¿˜æœ‰å•ç‹¬å­˜åœ¨çš„å¿…è¦ï¼Ÿ" class="headerlink" title="Q: C++å®Œå…¨å…¼å®¹Cï¼Œä¸ºä»€ä¹ˆCè¿˜æœ‰å•ç‹¬å­˜åœ¨çš„å¿…è¦ï¼Ÿ"></a>Q: C++å®Œå…¨å…¼å®¹Cï¼Œä¸ºä»€ä¹ˆCè¿˜æœ‰å•ç‹¬å­˜åœ¨çš„å¿…è¦ï¼Ÿ</h3><h3 id="A"><a href="#A" class="headerlink" title="A:"></a>A:</h3><h3 id="ä¸€ã€å¤§é“è‡³ç®€ï¼Œå¤šå¹¶éå¥½ï¼šç”¨æ›´å°‘çš„èµ„æºåšåŒæ ·çš„äº‹ï¼ˆå•ç‰‡æœºã€åº•å±‚èŠ¯ç‰‡èµ„æºæœ‰é™ï¼‰"><a href="#ä¸€ã€å¤§é“è‡³ç®€ï¼Œå¤šå¹¶éå¥½ï¼šç”¨æ›´å°‘çš„èµ„æºåšåŒæ ·çš„äº‹ï¼ˆå•ç‰‡æœºã€åº•å±‚èŠ¯ç‰‡èµ„æºæœ‰é™ï¼‰" class="headerlink" title="ä¸€ã€å¤§é“è‡³ç®€ï¼Œå¤šå¹¶éå¥½ï¼šç”¨æ›´å°‘çš„èµ„æºåšåŒæ ·çš„äº‹ï¼ˆå•ç‰‡æœºã€åº•å±‚èŠ¯ç‰‡èµ„æºæœ‰é™ï¼‰"></a>ä¸€ã€å¤§é“è‡³ç®€ï¼Œå¤šå¹¶éå¥½ï¼šç”¨æ›´å°‘çš„èµ„æºåšåŒæ ·çš„äº‹ï¼ˆå•ç‰‡æœºã€åº•å±‚èŠ¯ç‰‡èµ„æºæœ‰é™ï¼‰</h3><h3 id="äºŒã€è·¨å¹³å°å…¼å®¹æ€§ï¼šä»…æœ‰Cèƒ½åšåˆ°å®Œç¾è·¨å¹³å°ï¼ˆè¿™ä¹Ÿæ˜¯å› ä¸ºå®ƒç®€å•ï¼ŒC-ç‰ˆæœ¬å¤ªå¤šã€æ ‡å‡†åè®®éƒ½ä¸ç»Ÿä¸€ï¼Œè€ä¸€ç‚¹çš„æœºå™¨å¯èƒ½æ ¹æœ¬å°±ä¸æ”¯æŒC17ç”šè‡³C11ç­‰ç°ä»£è¯­æ³•ï¼‰"><a href="#äºŒã€è·¨å¹³å°å…¼å®¹æ€§ï¼šä»…æœ‰Cèƒ½åšåˆ°å®Œç¾è·¨å¹³å°ï¼ˆè¿™ä¹Ÿæ˜¯å› ä¸ºå®ƒç®€å•ï¼ŒC-ç‰ˆæœ¬å¤ªå¤šã€æ ‡å‡†åè®®éƒ½ä¸ç»Ÿä¸€ï¼Œè€ä¸€ç‚¹çš„æœºå™¨å¯èƒ½æ ¹æœ¬å°±ä¸æ”¯æŒC17ç”šè‡³C11ç­‰ç°ä»£è¯­æ³•ï¼‰" class="headerlink" title="äºŒã€è·¨å¹³å°å…¼å®¹æ€§ï¼šä»…æœ‰Cèƒ½åšåˆ°å®Œç¾è·¨å¹³å°ï¼ˆè¿™ä¹Ÿæ˜¯å› ä¸ºå®ƒç®€å•ï¼ŒC++ç‰ˆæœ¬å¤ªå¤šã€æ ‡å‡†åè®®éƒ½ä¸ç»Ÿä¸€ï¼Œè€ä¸€ç‚¹çš„æœºå™¨å¯èƒ½æ ¹æœ¬å°±ä¸æ”¯æŒC17ç”šè‡³C11ç­‰ç°ä»£è¯­æ³•ï¼‰"></a>äºŒã€è·¨å¹³å°å…¼å®¹æ€§ï¼šä»…æœ‰Cèƒ½åšåˆ°å®Œç¾è·¨å¹³å°ï¼ˆè¿™ä¹Ÿæ˜¯å› ä¸ºå®ƒç®€å•ï¼ŒC++ç‰ˆæœ¬å¤ªå¤šã€æ ‡å‡†åè®®éƒ½ä¸ç»Ÿä¸€ï¼Œè€ä¸€ç‚¹çš„æœºå™¨å¯èƒ½æ ¹æœ¬å°±ä¸æ”¯æŒC17ç”šè‡³C11ç­‰ç°ä»£è¯­æ³•ï¼‰</h3><h3 id="ä¸‰ã€C-å¤ªéš¾ï¼ŒäººåŠ›æˆæœ¬é«˜ï¼Œå­¦ä¹ é™¡å³­ã€ç»´æŠ¤å›°éš¾"><a href="#ä¸‰ã€C-å¤ªéš¾ï¼ŒäººåŠ›æˆæœ¬é«˜ï¼Œå­¦ä¹ é™¡å³­ã€ç»´æŠ¤å›°éš¾" class="headerlink" title="ä¸‰ã€C++å¤ªéš¾ï¼ŒäººåŠ›æˆæœ¬é«˜ï¼Œå­¦ä¹ é™¡å³­ã€ç»´æŠ¤å›°éš¾"></a>ä¸‰ã€C++å¤ªéš¾ï¼ŒäººåŠ›æˆæœ¬é«˜ï¼Œå­¦ä¹ é™¡å³­ã€ç»´æŠ¤å›°éš¾</h3><h3 id="ï¼ˆæ–°å¢ï¼šå››ã€ä¸¤ç§è¯­è¨€åœ¨å®é™…åº”ç”¨ä¸­çš„ä½¿ç”¨æ€è·¯å…¶å®å·®å¼‚éå¸¸å¤§ï¼ŒCç¼–ç¨‹è€…å†™C-åªèƒ½å†™å‡ºC-with-classï¼Œå±äºæœ‰äº†å¤§ç‚®è¿˜ç”¨æ£’æ£’æˆ³ï¼›C-è€…å†™Cä¼šå‘ç°æŠ€èƒ½å…¨è¢«å°å°ï¼Œä¸çŸ¥å¦‚ä½•ç”¨å¹³Aæ‰“bossâ€”â€”æ€»ä¹‹ä¸€å¥è¯ï¼Œè®©å‰‘å®—å’Œæ°”å®—å„è‡ªå»åšè‡ªå·±çš„äº‹å§ï¼‰"><a href="#ï¼ˆæ–°å¢ï¼šå››ã€ä¸¤ç§è¯­è¨€åœ¨å®é™…åº”ç”¨ä¸­çš„ä½¿ç”¨æ€è·¯å…¶å®å·®å¼‚éå¸¸å¤§ï¼ŒCç¼–ç¨‹è€…å†™C-åªèƒ½å†™å‡ºC-with-classï¼Œå±äºæœ‰äº†å¤§ç‚®è¿˜ç”¨æ£’æ£’æˆ³ï¼›C-è€…å†™Cä¼šå‘ç°æŠ€èƒ½å…¨è¢«å°å°ï¼Œä¸çŸ¥å¦‚ä½•ç”¨å¹³Aæ‰“bossâ€”â€”æ€»ä¹‹ä¸€å¥è¯ï¼Œè®©å‰‘å®—å’Œæ°”å®—å„è‡ªå»åšè‡ªå·±çš„äº‹å§ï¼‰" class="headerlink" title="ï¼ˆæ–°å¢ï¼šå››ã€ä¸¤ç§è¯­è¨€åœ¨å®é™…åº”ç”¨ä¸­çš„ä½¿ç”¨æ€è·¯å…¶å®å·®å¼‚éå¸¸å¤§ï¼ŒCç¼–ç¨‹è€…å†™C++åªèƒ½å†™å‡ºC with classï¼Œå±äºæœ‰äº†å¤§ç‚®è¿˜ç”¨æ£’æ£’æˆ³ï¼›C++è€…å†™Cä¼šå‘ç°æŠ€èƒ½å…¨è¢«å°å°ï¼Œä¸çŸ¥å¦‚ä½•ç”¨å¹³Aæ‰“bossâ€”â€”æ€»ä¹‹ä¸€å¥è¯ï¼Œè®©å‰‘å®—å’Œæ°”å®—å„è‡ªå»åšè‡ªå·±çš„äº‹å§ï¼‰"></a>ï¼ˆæ–°å¢ï¼šå››ã€ä¸¤ç§è¯­è¨€åœ¨å®é™…åº”ç”¨ä¸­çš„ä½¿ç”¨æ€è·¯å…¶å®å·®å¼‚éå¸¸å¤§ï¼ŒCç¼–ç¨‹è€…å†™C++åªèƒ½å†™å‡ºC with classï¼Œå±äºæœ‰äº†å¤§ç‚®è¿˜ç”¨æ£’æ£’æˆ³ï¼›C++è€…å†™Cä¼šå‘ç°æŠ€èƒ½å…¨è¢«å°å°ï¼Œä¸çŸ¥å¦‚ä½•ç”¨å¹³Aæ‰“bossâ€”â€”æ€»ä¹‹ä¸€å¥è¯ï¼Œè®©å‰‘å®—å’Œæ°”å®—å„è‡ªå»åšè‡ªå·±çš„äº‹å§ï¼‰</h3><h1 id="Lecture4ã€C-Memory-Management"><a href="#Lecture4ã€C-Memory-Management" class="headerlink" title="Lecture4ã€C Memory Management"></a>Lecture4ã€C Memory Management</h1><ol><li>sizeof( )å¯ä»¥æŸ¥çœ‹æ•°ç»„çš„å¤§å°ï¼Œä½†ä¸èƒ½æŸ¥çœ‹æŒ‡é’ˆæ‰€æŒ‡åŒºåŸŸçš„å¤§å°ï¼ˆä½†è¿™ä»ç„¶ä¸åº”æˆä¸ºä¸€ç§æ™®éç”¨æ³•ï¼Œæ›´å¥½çš„åšæ³•æ˜¯ä½¿ç”¨ä¸¤ä¸ªå‚æ•°ï¼šæ•°ç»„æŒ‡é’ˆå’Œæ•°ç»„é•¿åº¦ï¼‰</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> a[<span class="hljs-number">61</span>] ;<br><span class="hljs-type">int</span>* ptr = a;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;the size of a is: %d, ptr is %d&quot;</span>, <span class="hljs-keyword">sizeof</span>(a), <span class="hljs-keyword">sizeof</span>(ptr))<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/14/KyR5fEG2k4iWZjo.png"></p><ol start="2"><li>ä¸€ç§å¸¸è§çš„å†…å­˜æ³„æ¼bug â€”â€” æ”¹å˜æŒ‡é’ˆå´æœªç•™å‰¯æœ¬</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">plk = (<span class="hljs-type">int</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">2</span>*<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>));<br>...<br>plk++;<br></code></pre></td></tr></table></figure><h1 id="Lecture6ã€Assembly-Language-RISC-V-Intro"><a href="#Lecture6ã€Assembly-Language-RISC-V-Intro" class="headerlink" title="Lecture6ã€Assembly Language, RISC-V Intro"></a>Lecture6ã€Assembly Language, RISC-V Intro</h1><ol><li><strong>ä¸»æµæ¶æ„</strong></li></ol><p><img src="https://s2.loli.net/2023/04/14/t67yLVeOrbdn9z2.png"></p><ul><li><strong>x86ï¼š</strong>å±äºCISC(complex instruction set computer)ï¼Œintelå’ŒAMDéƒ½ä½¿ç”¨x86æ¶æ„ï¼ŒMacBookå’Œpc(Core i3, i5, i7, M)çš†ä½¿ç”¨x86æŒ‡ä»¤é›†</li><li><strong>ARMï¼š</strong>å±äºRISC(reduced instruction set computer)ï¼Œç”¨äºæ™ºèƒ½æ‰‹æœºã€æ ‘è“æ´¾ã€åµŒå…¥å¼ç³»ç»Ÿ</li><li><strong>risc-Vï¼š</strong>å±äºRISCï¼Œæ–°å…´æ¶æ„ï¼Œæœ€å¤§ä¼˜ç‚¹æ˜¯å¼€æºï¼Œå¸¸ç”¨äºäº‘è®¡ç®—ã€ç‰©è”ç½‘ç­‰</li></ul><ol start="2"><li><strong>memory hierarchy</strong></li></ol><p><img src="https://s2.loli.net/2023/04/14/VH4ydbQIkExq7zZ.png"></p><ol start="3"><li><p><strong>riscvç®€ä»‹</strong></p><p> å…±32ä¸ªå¯„å­˜å™¨ï¼Œæœ‰äº›ç”¨äºå­˜ç¼–ç¨‹ä¸­çš„å˜é‡ï¼Œæœ‰äº›ç”¨äºå­˜ä¸´æ—¶å˜é‡</p><p> <img src="https://s2.loli.net/2023/04/14/4O7d1hY6rEVZkRH.png"></p><p> <strong>åŸºæœ¬è¯­æ³•ï¼š</strong></p><p> <img src="https://s2.loli.net/2023/04/14/TtZaqi3FPbB8Swk.png"></p><p> <strong>æ•°æ®ä¼ è¾“æŒ‡ä»¤ï¼š</strong></p><ul><li>Load Wordï¼ˆlwï¼‰ï¼šè¯»å†…å­˜ï¼Œå³memory åˆ°register</li><li>Store Wordï¼ˆswï¼‰ï¼šåä¹‹</li></ul><p> <img src="https://s2.loli.net/2023/04/14/F6iyTX91EgADKzV.png"></p><p> <strong>å†…å­˜è¯»å†™æŒ‡ä»¤ï¼š</strong></p><ul><li>lbï¼šlb rd,imm(rs) â€”â€” ä»å†…å­˜ imm+rs å¤„è¯»å–8bitæ•°æ®(ç¬¦å·æ‹“å±•)åˆ° rd ä¸­</li><li>sbï¼šsb rs2,imm(rs1) â€”â€” å°†rs2ä¸­çš„8bitæ•°æ®å†™å…¥å†…å­˜imm+rs1å¤„</li></ul><p> <img src="https://s2.loli.net/2023/04/14/WaCwBDVMZFRTnUS.png"></p></li></ol><div class="note note-warning">            <p>ğŸ’¡ PS.</p><ol><li>riscvé‡‡ç”¨çš„æ˜¯å°å­—èŠ‚åºï¼Œå³å¯¹äºs0ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚å­˜80ï¼Œç¬¬äºŒä¸ªå­˜01è¿™æ ·å­</li><li>offsetçš„å•ä½æ˜¯å­—èŠ‚</li><li>å› ä¸ºlbåªè¯»å†™8ä¸ªbitï¼Œè€Œriscvæ˜¯32ä½æ¶æ„ï¼Œæ‰€ä»¥è¦è¿›è¡Œç¬¦å·æ‹“å±•ã€‚å¦‚ç»™s2ä¸­è¯»å…¥0x80ï¼Œå³1000 0000ï¼Œæ‹“å±•ås2çš„å‰24ä½å°±éƒ½å˜æˆäº†F</li><li>ä¹Ÿæœ‰å…¶å®ƒçš„è¯»å†™æŒ‡ä»¤ï¼Œå¦‚lwå’Œswæ˜¯è¯»å†™32bitæ•°æ®</li></ol>          </div><p>â€‹<strong>æ§åˆ¶æŒ‡ä»¤ï¼š</strong></p><p><img src="https://s2.loli.net/2023/04/14/iqQIOF7pmfMrJR9.png"></p><ul><li>beqï¼šç›¸ç­‰åˆ™è·³</li><li>bneï¼šnot equal</li><li>bltï¼šbranch less than</li><li>bgeï¼šbranch greater than</li><li>jalï¼ˆjump and linkï¼‰ï¼šjal rd,labelæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€å­˜å…¥rd,è·³è½¬åˆ°label</li></ul><p>â€‹<strong>æ¯”è¾ƒæŒ‡ä»¤ï¼š</strong></p><p><img src="https://s2.loli.net/2023/04/14/LP9hcsIFHp67Cm5.png"></p><h1 id="Lecture7ã€RISC-V-Functions"><a href="#Lecture7ã€RISC-V-Functions" class="headerlink" title="Lecture7ã€RISC-V Functions"></a>Lecture7ã€RISC-V Functions</h1><ol><li><p><strong>ä½æ•°æ‹“å±•</strong></p><p>æ‹“å±•ç¬¦å·ä½å³å¯ï¼Œå³æ­£æ•°è¡¥å……0ï¼Œè´Ÿæ•°è¡¥å……1</p><p><img src="https://s2.loli.net/2023/04/14/PRQYrc2WsikVbDe.png"></p></li><li><p><strong>å‡½æ•°</strong></p><p><img src="https://s2.loli.net/2023/04/14/ieJP4dKS5mn3faZ.png"></p><p>å…¶ä¸­jalçš„å‚æ•°raæ˜¯x1å¯„å­˜å™¨ï¼Œå­˜æ”¾å‡½æ•°è¿”å›åœ°å€ï¼ˆreturn addressï¼‰</p><p>è€Œä¼ªæŒ‡ä»¤jç­‰æ•ˆäºjal x0 labelï¼Œç”±äºx0æ’ä¸º0ä¸”æ— æ³•æ›´æ”¹ï¼Œæ‰€ä»¥ç›¸å½“äºåªè·³è½¬è€Œä¸è®°å½•è¿”å›åœ°å€ï¼›</p><p>jrç­‰æ•ˆäºjalr x0,0(rs)ï¼Œ(rs+imm)ä½ç½®çš„å†…å­˜åˆ°x0ï¼ˆå®é™…æ— æ•ˆï¼‰ï¼Œå¹¶è·³è½¬åˆ°rså¯„å­˜å™¨ä¿å­˜çš„åœ°å€</p><div class="note note-warning">            <p>ğŸ’¡ PS. jalå’Œjéƒ½æ˜¯ç”¨labelè·³è½¬ï¼›jræ˜¯ç”¨å¯„å­˜å™¨è·³è½¬</p>          </div></li></ol><h1 id="Lecture8ã€RISC-V-Instruction-Formats"><a href="#Lecture8ã€RISC-V-Instruction-Formats" class="headerlink" title="Lecture8ã€RISC-V Instruction Formats"></a>Lecture8ã€RISC-V Instruction Formats</h1><ol><li><p><strong>æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºäºŒè¿›åˆ¶ä»£ç ï¼š</strong></p><p>æ€è·¯ï¼šå°†ä¸€æ¡æ±‡ç¼–è¯­å¥åˆ†ä¸ºå„ä¸ªfieldï¼Œæ¯ä¸ªfieldå æ®ä¸€å®šçš„ä½é•¿ï¼Œè¡¨ç¤ºç‰¹å®šå«ä¹‰ï¼ˆä¸€æ¡æ±‡ç¼–è¯­å¥å æ®32bitï¼‰</p><p>å¦‚R-Formatè¯­å¥ï¼šè¾“å…¥3ä¸ªå¯„å­˜å™¨ï¼ˆaddã€mulç­‰ï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/p3OV82MSdCsLbn6.png"></p><p>å¯„å­˜å™¨çš„fieldéƒ½æ˜¯5bitï¼Œæ­£å¥½å¯ä»¥è¡¨ç¤º32ä¸ªå¯„å­˜å™¨</p></li></ol><h1 id="Lecture10ã€digital-logic"><a href="#Lecture10ã€digital-logic" class="headerlink" title="Lecture10ã€digital logic"></a>Lecture10ã€digital logic</h1><ol><li><strong>å¸ƒå°”ä»£æ•°è¿ç®—</strong></li></ol><p><img src="https://s2.loli.net/2023/04/14/bgfhmUysV6zwXRJ.png"></p><ol start="2"><li><strong>æ•°ç”µç³»ç»Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ï¼š</strong></li></ol><ul><li><p><strong>combinational logicï¼ˆCLï¼‰ï¼š</strong>è¾“å‡ºä»…ä»…æ˜¯è¾“å…¥çš„å‡½æ•°ï¼Œä¸å†å²çŠ¶æ€æ— å…³ï¼ˆå¦‚cpuä¸­çš„åŠ æ³•è¿ç®—å™¨ï¼‰</p></li><li><p><strong>sequential logicï¼ˆSLï¼‰ï¼š</strong>ä¸å†å²çŠ¶æ€æœ‰å…³ï¼ˆå¦‚memory and registersï¼‰</p></li></ul><h1 id="Lecture12ã€RISC-V-Datapath-Single-Cycle-Control-Intro"><a href="#Lecture12ã€RISC-V-Datapath-Single-Cycle-Control-Intro" class="headerlink" title="Lecture12ã€RISC-V Datapath, Single-Cycle Control Intro"></a>Lecture12ã€RISC-V Datapath, Single-Cycle Control Intro</h1><ol><li><p><strong>cpuæ‰§è¡Œæ±‡ç¼–è¯­å¥çš„ç¡¬ä»¶å®ç°</strong></p><p><strong>ç‰ˆæœ¬1.0ï¼š</strong>å®ç°R-typeè¯­å¥ï¼ˆä»¥add t0 t2 t3ä¸ºä¾‹ï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/xiFk6514aodpylg.png"></p><p>(1) è·å–æ±‡ç¼–æŒ‡ä»¤ï¼šåœ¨PCå¯„å­˜å™¨ä¸­è·å–å½“å‰æŒ‡ä»¤çš„åœ°å€ï¼Œå°†æŒ‡ä»¤å†…å®¹ä¼ ç»™IMEMï¼ˆinstruction memoryï¼‰ï¼ŒåŒæ—¶åŠ 4byteè¿”å›ç»™PCï¼ˆå³ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼‰</p><p>(2) å°†æŒ‡ä»¤åˆ†æ®µæˆå„ä¸ªfield</p><p>(3) å°†å¯„å­˜å™¨åœ°å€ä¼ ç»™å¯„å­˜å™¨å †ï¼ˆregister fileï¼‰ï¼Œè·å–å¯„å­˜å™¨ä¸­çš„å€¼</p><p>(4) å°†è·å–çš„å€¼ä¼ ç»™è¿ç®—å™¨ALUï¼Œå¹¶ç”±æ§åˆ¶ä½ALUSel(ect)å†³å®šé‡‡ç”¨å“ªç§è¿ç®—ï¼ˆaddã€subã€xorã€‚ã€‚ï¼‰</p><p>(5) ALUè¾“å‡ºè¿ç®—ç»“æœå¹¶å°†å€¼returnç»™register files</p><p><strong>ç‰ˆæœ¬2.0ï¼š</strong>å®ç°loadsç±»å‹è¯­å¥ï¼ˆlbã€sbï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/7XGujUOA5wZpdix.png"></p><p>è¯´æ˜ï¼š</p><p>ï¼ˆ1ï¼‰å¤šäº†ä¸€ä¸ªimmediate generatorï¼Œç”¨äºç”Ÿæˆç«‹å³æ•°ï¼Œå†åœ¨01é€‰æ‹©å™¨å¤„è¿›è¡Œé€‰æ‹©ï¼Œå³addå’Œaddiçš„åŒºåˆ«</p><p>ï¼ˆ2ï¼‰å¤šäº†ä¸€ä¸ªdata memoryï¼Œç”¨äºæ‰§è¡Œloadsç±»å‹çš„æŒ‡ä»¤ï¼ˆåœ¨å†…å­˜ä¸­è¯»å†™æ•°æ®ï¼‰ï¼Œå…¶ä¸­MemRWï¼ˆmemory read and writeï¼‰ç”¨äºé€‰æ‹©è¯»&#x2F;å†™ï¼šä¸º0æ—¶è¯»æ•°æ®ï¼Œå°†Addrå¤„çš„æ•°æ®è¾“å‡ºï¼›ä¸º1æ—¶å†™æ•°æ®ï¼Œå°†è¾“å…¥çš„æ•°æ®å­˜åˆ°Addrå¤„çš„å†…å­˜ä¸­</p><p><img src="https://s2.loli.net/2023/04/14/jSRNUOicTJhrd4B.png"></p><p><strong>ç‰ˆæœ¬3.0ï¼š</strong>å®ç°åˆ†æ”¯æ§åˆ¶è¯­å¥ï¼ˆbeqã€bltï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/asl3DvzpPGjbSAc.png"></p><p>è¯´æ˜ï¼šå¤šäº†åˆ†æ”¯æ§åˆ¶æ¨¡å—ï¼Œå°†DataAå’ŒDataBè¿›è¡Œæ¯”è¾ƒï¼Œæ ¹æ®ç»“æœå°†ä¸‹é¢BrUnå‡ ä¸ªæ§åˆ¶ä½è®¾ä¸º0&#x2F;1ï¼Œå†ç”¨ASelæ§åˆ¶01é€‰æ‹©å™¨ï¼Œä½¿ALUçš„è¾“å‡ºä¸ºè¦è·³è½¬çš„åœ°å€ï¼Œreturnç»™PC</p></li></ol><p>â€‹<strong>æœ€ç»ˆç‰ˆæœ¬ï¼š</strong>å®ç°è·³è½¬è¯­å¥</p><p><img src="https://s2.loli.net/2023/04/14/1rKli23jMkvx87Z.png"></p><h1 id="Lecture13ã€RISC-V-Single-Cycle-Control-and-Pipelining"><a href="#Lecture13ã€RISC-V-Single-Cycle-Control-and-Pipelining" class="headerlink" title="Lecture13ã€RISC-V Single-Cycle Control and Pipelining"></a>Lecture13ã€RISC-V Single-Cycle Control and Pipelining</h1><ol><li><p><strong>æ§åˆ¶å™¨è®¾è®¡</strong></p><p>ä»¥PCSelä¸ºä¾‹ï¼Œé»˜è®¤è¾“å‡º0ï¼Œä»…å½“opcodeä¸ºbranchè¯­å¥ï¼ˆ63ï¼‰æˆ–jumpè¯­å¥ï¼ˆ67æˆ–6fï¼‰æ—¶æ‰ä¼šè¾“å‡º1ï¼Œåˆ™åœ¨muxä¸­é€‰æ‹©ALUè¾“å‡º</p><p><img src="https://s2.loli.net/2023/04/14/IURA27kP5EHxicZ.png"></p></li><li><p><strong>æ§åˆ¶å™¨ç»“æ„</strong></p><p>è§‚å¯Ÿä¸Šé¢çš„CPUç»“æ„å¯çŸ¥ï¼Œæ§åˆ¶å™¨ä¸€å…±æœ‰ä¸‰ä¸ªè¾“å…¥ï¼Œå…¶ä½™çš„çš†æ˜¯è¾“å‡º</p><p>å®é™…ä¸­ç”±ROMå®ç°æ§åˆ¶å™¨</p><p><img src="https://s2.loli.net/2023/04/14/m7x2VWFOSo1rshY.png"></p></li><li><p><strong>pipeline</strong></p><p><strong>motivationï¼š</strong>å•æ¡æŒ‡ä»¤è¿è¡Œæ—¶ï¼Œå¤§éƒ¨åˆ†ç‰ˆå—éƒ½å¤„äºç©ºé—²çŠ¶æ€ï¼Œ</p><p><img src="https://s2.loli.net/2023/04/14/wWYksDqCdZnixHG.png"></p><p><strong>cpuæ€§èƒ½è¡¨ç°ï¼š</strong></p><p><img src="https://s2.loli.net/2023/04/14/spvkcf2x5ITZz9Y.png"></p><p> ï¼ˆ1ï¼‰æ¯ä¸ªç¨‹åºçš„æŒ‡ä»¤æ•°å–å†³äºï¼š</p><ul><li>ç¨‹åºç®—æ³•çš„æ—¶é—´å¤æ‚åº¦</li><li>ç¼–ç¨‹è¯­è¨€</li><li>ç¼–è¯‘å™¨</li><li>ISA</li></ul><p> ï¼ˆ2ï¼‰æ¯æ¡æŒ‡ä»¤è¦æ‰§è¡Œå¤šå°‘ä¸ªcpuå¾ªç¯</p><ul><li>æŒ‡ä»¤å¤æ‚ç¨‹åº¦</li></ul><p> ï¼ˆ3ï¼‰æ¯ä¸ªcpuå¾ªç¯æ‰€è€—è´¹çš„æ—¶é—´</p><ul><li>cpuè®¾è®¡</li><li>ç”µå­å‚æ•°ï¼ˆæ™¶ä½“ç®¡å°ºå¯¸ã€ç”µå‹å¤§å°ï¼‰</li></ul><p> <strong>æµæ°´çº¿æŠ€æœ¯ï¼š</strong></p><p> <img src="https://s2.loli.net/2023/04/14/6DrgXQPSoFdTafs.png"></p> <div class="note note-warning">            <p>ğŸ’¡ PS. æµæ°´çº¿ä¸­ï¼Œå•ä¸ªæ¿å—çš„è€—æ—¶ç”±çŸ­æ¿å†³å®š   </p>          </div></li></ol><p><img src="https://s2.loli.net/2023/04/14/kOFKpimAJRhWtNu.png"></p><p>â€‹<strong>riscvçš„5æ®µæµæ°´çº¿</strong><br><img src="https://s2.loli.net/2023/04/14/hRSsPQYO7Jpzu12.png" alt="Untitled"></p><h1 id="Lecture14ã€RISC-V-5-Stage-Pipeline"><a href="#Lecture14ã€RISC-V-5-Stage-Pipeline" class="headerlink" title="Lecture14ã€RISC-V 5-Stage Pipeline"></a>Lecture14ã€RISC-V 5-Stage Pipeline</h1><ol><li><p>æµæ°´çº¿è®¾è®¡ä¹Ÿä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼š</p><p><strong>ç»“æ„æ€§é—®é¢˜ï¼š</strong>æŠ¢å èµ„æºï¼Œå¦‚ä¸¤æ¡æŒ‡ä»¤åŒæ—¶éœ€è¦ç”¨åˆ°RegFile</p><p>è§£å†³æ€è·¯ï¼š</p><ul><li>è®©è¯»&#x2F;å†™ç«¯å£ç›¸äº’ç‹¬ç«‹</li><li>åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„å‰åŠéƒ¨åˆ†å†™æ•°æ®ï¼ŒååŠéƒ¨åˆ†è¯»æ•°æ®ï¼ˆè¿™åœ¨ç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºRegFileçš„access timeè¿œä½äºæ—¶é’Ÿå‘¨æœŸçš„ä¸€åŠï¼‰</li></ul><p><img src="https://s2.loli.net/2023/04/14/wNPK5C8cMFSGinW.png"></p><p><strong>æ•°æ®æ›´æ–°é—®é¢˜ï¼š</strong>ä¸€ä¸ªå…¸å‹æ¡ˆä¾‹ï¼Œå¤šæ¡è¯­å¥éƒ½è¦å¯¹t0è¿›è¡Œä¿®æ”¹ï¼Œä½†ç¬¬ä¸€æ¬¡è¿˜æ²¡ç”Ÿæ•ˆï¼Œåé¢å‡ æ¬¡å°±å¼€å§‹ç”¨äº†</p><p><img src="https://s2.loli.net/2023/04/14/qfBl9nzE2GigCsW.png"></p><p>è§£å†³æ€è·¯ï¼š</p><ul><li>è´®å­˜ï¼šåŠ å…¥ä¸€äº›ç©ºæŒ‡ä»¤è¿›è¡Œæ‹–å»¶ï¼Œç¡®ä¿ä¸Šä¸€æ¡æŒ‡ä»¤çš„ç»“æœå†™å…¥åï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤æ‰å¼€å§‹è¯»å–</li></ul><p><img src="https://s2.loli.net/2023/04/14/H6gGC5djiPaKeyW.png"></p><ul><li>è½¬å‘ï¼šç»“æœç®—å‡ºåç«‹é©¬ä¼ è¾“ç»™ä¹‹åçš„ALUï¼Œè€Œä¸æ˜¯ä»RegFileä¸­è¯»å–</li></ul><p><img src="https://s2.loli.net/2023/04/14/8ATpVMf9w7khNyb.png"></p><p><strong>åˆ†æ”¯æ§åˆ¶é—®é¢˜ï¼š</strong>â€ç­‰å¾…branchè¯­å¥äº§ç”Ÿç»“æœâ€œè¿™ä¸€è¡Œä¸ºä¼šå¸¦æ¥å·¨å¤§çš„å»¶è¿Ÿï¼Œå¦‚æ‰€è°“çš„æµæ°´çº¿æ‰“å—ï¼ˆpipeline hiccupï¼‰äº§ç”Ÿæ°”æ³¡ï¼ˆbubbleï¼‰ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>åˆ†æ”¯é¢„æµ‹ï¼ˆbranch predictionï¼‰</strong>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼Œåœ¨ä¸€ä¸ªå¤§å°ä¸º32768çš„æ•°ç»„ä¸­éšæœºã€å‡åŒ€åœ°æ”¾å…¥0~255çš„æ•°å­—ï¼Œå†å»ç»Ÿè®¡æ•°ç»„ä¸­ï¼128çš„æ•°çš„æ€»å’Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctime&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// éšæœºäº§ç”Ÿæ•´æ•°ï¼Œç”¨åˆ†åŒºå‡½æ•°å¡«å……ï¼Œä»¥é¿å…å‡ºç°åˆ†æ¡¶ä¸å‡</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> arraySize = <span class="hljs-number">32768</span>;<br>    <span class="hljs-type">int</span> data[arraySize];<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> c = <span class="hljs-number">0</span>; c &lt; arraySize; ++c)<br>        data[c] = std::<span class="hljs-built_in">rand</span>() % <span class="hljs-number">256</span>;<br><br>    <span class="hljs-comment">// !!! æ’åºåä¸‹é¢çš„Loopè¿è¡Œå°†æ›´å¿«</span><br>    std::<span class="hljs-built_in">sort</span>(data, data + arraySize);<br><br>    <span class="hljs-comment">// æµ‹è¯•éƒ¨åˆ†</span><br>    <span class="hljs-type">clock_t</span> start = <span class="hljs-built_in">clock</span>();<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> sum = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; ++i)<br>    &#123;<br>        <span class="hljs-comment">// ä¸»è¦è®¡ç®—éƒ¨åˆ†ï¼Œé€‰ä¸€åŠå…ƒç´ å‚ä¸è®¡ç®—</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">unsigned</span> c = <span class="hljs-number">0</span>; c &lt; arraySize; ++c)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (data[c] &gt;= <span class="hljs-number">128</span>)<br>                sum += data[c];<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-type">double</span> elapsedTime = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">double</span>&gt;(<span class="hljs-built_in">clock</span>() - start) / CLOCKS_PER_SEC;<br><br>    std::cout &lt;&lt; elapsedTime &lt;&lt; std::endl;<br>    std::cout &lt;&lt; <span class="hljs-string">&quot;sum = &quot;</span> &lt;&lt; sum &lt;&lt; std::endl;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºæœ‰åºæ•°ç»„ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/YbFymqfUp5kreCM.png"></p><p>è€Œå¯¹äºæ— åºæ•°ç»„ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/NfwLXZRz7yISuW5.png"></p><p>ä¸Šè¿°è€—æ—¶å·®å¼‚ç”±åˆ†æ”¯é¢„æµ‹å¯¼è‡´ï¼Œè€Œå®é™…ä¸­çš„åˆ†æ”¯é¢„æµ‹å¸¸ç”±å†å²æ•°æ®å†³å®šã€‚å¯¹äºæœ‰åºæ•°æ®ï¼Œå‰ä¸€åŠçš†ï¼œ128ï¼Œå¤„ç†å™¨å¾ˆå®¹æ˜“æ‰¾å‡ºå…¶ä¸­çš„patternï¼›æ— åºæ•°ç»„åˆ™ç›¸å½“äºçè’™ï¼Œåªæœ‰50%çš„å‘½ä¸­ç‡</p><p><img src="https://s2.loli.net/2023/04/14/kSy1c4aegBpC8NE.png"></p><div class="note note-warning">            <p>ğŸ’¡ PS. è¿™ä¸ªä¾‹å­ç»™æˆ‘ä»¬å¯ç¤º: åœ¨å¤§è§„æ¨¡å¾ªç¯é€»è¾‘ä¸­è¦å°½é‡é¿å…æ•°æ®å¼ºä¾èµ–çš„åˆ†æ”¯(data-dependent branching).</p>          </div><p>åˆ†æ”¯é¢„æµ‹çš„ç­–ç•¥å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šé™æ€é¢„æµ‹å’ŒåŠ¨æ€é¢„æµ‹</p><p><strong>é™æ€é¢„æµ‹ï¼š</strong>å›ºå®šçš„é¢„æµ‹ç­–ç•¥ï¼Œå¦‚â€â‰¥æŒ‡ä»¤ä¸€å¾‹è·³ï¼Œï¼œä¸€å¾‹ä¸è·³â€œã€â€ä¸ä¸Šæ¬¡takenä¿æŒä¸€è‡´â€œï¼Œè¿™ç±»ç­–ç•¥ç®€å•æ˜“å®ç°ä¸”èƒ½è€—å°ï¼Œä¹Ÿå¯ä»¥ä¿æŒä¸é”™çš„æ­£ç¡®ç‡ï¼ˆ70%ä»¥ä¸Šï¼‰ï¼Œå¯¹æ€§èƒ½è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜ä½†åˆè¦ä½åŠŸè€—ä½æˆæœ¬çš„ç³»ç»Ÿå¯ä»¥ä½¿ç”¨</p><p><strong>åŠ¨æ€é¢„æµ‹ï¼š</strong>å¦‚2-bit çŠ¶æ€æœºï¼š åˆå§‹å€¼ä¸º00ï¼Œæ¯å½“ä¸€ä¸ªbranch takenå°±+1ï¼Œbranchæ²¡æœ‰takenåˆ™-1ã€‚æ ¹æ®ç¬¬ä¸€ä½çš„å€¼æ¥è¿›è¡Œé¢„æµ‹ï¼Œä¾‹å¦‚11é¢„æµ‹takenï¼Œ01é¢„æµ‹ not takenã€‚ ç”¨ä¸€ä¸ª2bitçŠ¶æ€æœºçš„æ ¸å¿ƒæ€è·¯å°±æ˜¯ï¼š<strong>è¿™æ¬¡é¢„æµ‹é”™äº†ä¸è¦ç´§ï¼Œå†ç»™ä½ ä¸€æ¬¡æœºä¼šï¼Œè¿˜æ˜¯é¢„æµ‹é”™äº†çš„è¯é‚£å†æ”¹å˜é¢„æµ‹ç»“æœ</strong>ã€‚æ€»ä¹‹å°±æ˜¯æä¾›äº†ä¸€å®šçš„å®¹é”™ç‡ï¼Œå¯æƒ³è€ŒçŸ¥è¿™æ ·çš„é¢„æµ‹å‡†ç¡®ç‡è‡ªç„¶ä¹Ÿæ˜¯æé«˜äº†çš„ã€‚</p></li></ol><h1 id="Lecture15-17ã€-Cache"><a href="#Lecture15-17ã€-Cache" class="headerlink" title="Lecture15-17ã€ Cache"></a>Lecture15-17ã€ Cache</h1><ol><li><strong>å…¸å‹å†…å­˜åˆ†çº§</strong></li></ol><p><img src="https://s2.loli.net/2023/04/14/jL2HfckoJCMQ5NX.png"></p><p>â€‹cacheç”¨static RAMï¼šæ›´å¿«ï¼ˆ1nsï¼‰ï¼Œä½†åŠŸè€—æ›´é«˜ä¹Ÿæ›´è´µï¼Œé€šç”µæ—¶å†…å®¹ä¸€ç›´åœ¨</p><p>â€‹ä¸»å­˜ç”¨dynamic RAMï¼šæ›´ä¾¿å®œä¹Ÿæ›´æ…¢ï¼ˆ70nsï¼‰ï¼Œå®šæ—¶æ›´æ–°å†…å®¹</p><ol start="2"><li><p><strong>ä¸¤ä¸ªåŸºæœ¬åŸç†ï¼š</strong>æ—¶é—´å±€éƒ¨æ€§ï¼ˆå¦‚æœä¸€ä¸ªåœ°å€è¢«è®¿é—®äº†ä¸€æ¬¡ï¼Œé‚£ä¹ˆå®ƒæ¥ä¸‹æ¥è¿˜å¯èƒ½è¢«è®¿é—®å¾ˆå¤šæ¬¡ï¼‰ä¸ç©ºé—´å±€éƒ¨æ€§ï¼ˆå¦‚æœä¸€ä¸ªåœ°å€è¢«è®¿é—®äº†ä¸€æ¬¡ï¼Œé‚£ä¹ˆå®ƒå‘¨å›´çš„å†…å­˜ä¹Ÿå¯èƒ½è¢«è®¿é—®ï¼Œå¦‚æ•°ç»„ï¼‰</p></li><li><p><strong>ä»¥ç›´æ¥æ˜ å°„ï¼ˆdirect mappingï¼‰ä¸ºä¾‹ï¼Œå®Œæ•´å™è¿°cacheå·¥ä½œè¿‡ç¨‹</strong></p><p> å‡è®¾cacheå¤§å°64bytesï¼Œåˆ†ä¸º8ä¸ªcache lineï¼ˆæˆ–ç§°cache blockï¼‰ï¼Œåˆ™æ¯ä¸ªlineå¤§å°ä¸º8bytes</p> <div class="note note-warning">            <p>ğŸ’¡ PS. cache lineæ˜¯cacheå’Œä¸»å­˜ä¹‹é—´ä¼ è¾“æ•°æ®çš„æœ€å°å•ä½ï¼Œline å¤§å°ä¸€èˆ¬è®¾ä¸ºwordçš„æ•´æ•°å€ï¼ˆ4byteã€8byteè¿™æ ·å­ï¼‰ï¼Œå¾ˆå°‘ä¼šåšæˆ1byteï¼Œä¸ºä»€ä¹ˆæï¼Ÿè§ä¸‹æ–‡åˆ†æ</p>          </div><p> <img src="https://s2.loli.net/2023/04/14/DyBX4L6cQtol7s5.png"></p><p> å‡è®¾åœ°å€ä½å®½ä¸º48bitï¼Œcpuç°åœ¨è¦åœ¨åœ°å€ä¸º0x0654ç©ºé—´ä¸­è¯»æ•°æ®ï¼Œé‚£ä¹ˆå¦‚å›¾ï¼Œé¦–å…ˆé€šè¿‡é»„è‰²éƒ¨åˆ†çš„010ï¼ˆç§°ä¹‹ä¸º<strong>index</strong>ï¼‰<strong>æ‰¾åˆ°å¯¹åº”ä½ç½®çš„cache line</strong>ï¼ˆè¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç§°ä¹‹ä¸ºä¸€æ¬¡hashï¼‰ï¼Œä½†å…‰æ‰¾åˆ°lineè¿˜ä¸å¤Ÿï¼Œå› ä¸ºå¦‚æœä¸¤ä¸ªä¸åŒåœ°å€çš„bit3-bit5ä¸€æ ·çš„è¯ï¼Œç»è¿‡hashåéƒ½ä¼šæ‰¾åˆ°åŒä¸€ä¸ªcache lineã€‚ ä¸‹ä¸€æ­¥æ˜¯æ¯”è¾ƒç»¿è‰²çš„tagâ€”â€”<strong>æ¯ä¸€ä¸ªcache lineéƒ½å¯¹åº”å”¯ä¸€ä¸€ä¸ªtag</strong>ï¼Œtagä¸­ä¿å­˜çš„æ˜¯æ•´ä¸ª48bitåœ°å€é™¤å»indexå’Œoffsetåçš„å‰©ä½™éƒ¨åˆ†ã€‚è‹¥åœ°å€çš„tagå’Œlineå¯¹åº”çš„tagç›¸ç­‰ï¼Œåˆ™è¯´æ˜cacheç¡®å®æŠŠå†…å­˜ä¸­å‰45ä½åœ°å€ä¸º00â€¦.011001010xxxçš„é‚£8byteç©ºé—´å…¨æè¿›æ¥äº†ï¼Œå³cache hitã€‚okï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥åªéœ€è¦é€šè¿‡<strong>è“è‰²çš„offsetå°±å¯åœ¨lineä¸­æ‰¾åˆ°å…·ä½“çš„é‚£ä¸ªbyte</strong>ï¼›è‹¥tagä¸ç›¸ç­‰ï¼Œåˆ™cache missã€‚è¿™ä¹Ÿè§£ç­”äº†æˆ‘ä»¬ä¹‹å‰çš„ä¸€ä¸ªç–‘é—®â€œä¸ºå•¥cache lineä¸åšæˆä¸€ä¸ªbyteâ€ï¼Œå› ä¸ºåŸæœ¬8byteå¯¹åº”ä¸€ä¸ªtagï¼Œç°åœ¨éœ€è¦8ä¸ªtagï¼Œå ç”¨å¤ªå¤šç©ºé—´ï¼ˆtagä¹Ÿæ˜¯cacheçš„ä¸€éƒ¨åˆ†ï¼Œä½†æˆ‘ä»¬è°ˆåˆ°cache sizeçš„æ—¶å€™å¹¶ä¸è€ƒè™‘tagå ç”¨çš„å†…å­˜éƒ¨åˆ†ï¼‰ã€‚ å›¾ä¸­è¿˜å¯ä»¥çœ‹åˆ°tagæ—çš„valid bitï¼Œå®ƒç”¨æ¥è¡¨ç¤ºcache lineä¸­çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆï¼Œå¦‚ç³»ç»Ÿåˆšå¯åŠ¨æ—¶ï¼Œcacheä¸­çš„æ•°æ®åº”è¯¥éƒ½æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºè¿˜æ²¡æœ‰ç¼“å­˜ä»»ä½•æ•°æ®ã€‚æ‰€ä»¥å®é™…ä¸­æ¯”è¾ƒtagå‰è¿˜ä¼šæ£€æŸ¥valid bitæ˜¯å¦æœ‰æ•ˆï¼Œæ— æ•ˆåˆ™ç›´æ¥åˆ¤å®šcache missã€‚</p> <div class="note note-warning">            <p>ğŸ’¡ PS. ä½“ä¼šä¸€ä¸‹ä¸Šè¿°æŸ¥æ‰¾cacheçš„è¿‡ç¨‹ï¼Œä¼šå‘ç°è™½ç„¶çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œä½†æœ¬è´¨ä¸Šå°±æ˜¯ä¸ªé€šè¿‡åœ°å€æ‰¾å¯¹åº”æ•°æ®çš„è¿‡ç¨‹â€”â€”å…ˆåˆ¤æ–­cacheä¸­æ˜¯å¦æœ‰è¿™å‰45ä½åœ°å€ï¼Œæœ‰çš„è¯ç›´æ¥å¾€åæ‰¾æˆ‘è¦çš„é‚£ä¸ªæ•°æ®ï¼Œæ²¡æœ‰çš„è¯cache miss</p>          </div><p> ç›´æ¥æ˜ å°„ä¼˜ç‚¹ï¼šç¡¬ä»¶è®¾è®¡ç®€å•ã€æˆæœ¬ä½ ç¼ºç‚¹ï¼šç¨‹åºä¾æ¬¡è®¿é—®0x00ã€0x40ã€0x80ï¼ˆè¿™3ä¸ªåœ°å€çš„indexä¸€æ ·çš„ï¼‰æ—¶ï¼Œé¦–å…ˆè®¿é—®ç¬¬0ä¸ªlineï¼Œå†è®¿é—®0x40åœ°å€æ—¶ä¾ç„¶ä¼šæ£€ç´¢åˆ°ç¬¬0ä¸ªï¼Œç„¶åå‘ç°æ•°æ®ç¼ºå¤±ï¼Œäºæ˜¯ä»ä¸»å­˜ä¸­åŠ è½½0x0åœ°å€æ•°æ®åˆ°ç¬¬ä¸€ä¸ªlineï¼Œ0x80äº¦æ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥æ­¤æ—¶cacheçš„å­˜åœ¨å¹¶æ²¡æœ‰å¯¹æ€§èƒ½æœ‰å•¥æå‡ï¼Œè¿™ç§è¿ç»­åŠ è½½æ›¿æ¢cacheçš„ç°è±¡å«åš<strong>cacheé¢ ç°¸ï¼ˆcache thrashingï¼‰</strong>ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¼•å…¥å¤šè·¯ç»„ç›¸è¿ç¼“å­˜</p></li><li><p><strong>ä¸¤è·¯ç›¸è¿ç¼“å­˜ï¼ˆtwo-way set associative cacheï¼‰</strong></p><p>ä¾ç„¶å‡è®¾64 Bytes cache sizeï¼Œcache line sizeæ˜¯8 Bytesã€‚ä¸¤è·¯ç»„ç›¸è¿ç¼“å­˜å°±æ˜¯å°†cacheå¹³å‡åˆ†æˆ2ä»½ï¼Œæ¯ä»½32 Bytesã€‚</p><p><img src="https://s2.loli.net/2023/04/14/g4pRkofIhutGd7x.png"></p><p>cacheè¢«åˆ†æˆ2è·¯ï¼Œæ¯è·¯åŒ…å«4è¡Œcache lineã€‚æˆ‘ä»¬å°†æ‰€æœ‰indexä¸€æ ·çš„cache lineç»„åˆåœ¨ä¸€èµ·ç§°ä¹‹ä¸ºä¸€ä¸ªsetã€‚ä¾‹å¦‚ï¼Œä¸Šå›¾ä¸­ä¸€ä¸ªç»„æœ‰ä¸¤ä¸ªcache lineï¼Œæ€»å…±4ä¸ªç»„ã€‚æˆ‘ä»¬ä¾ç„¶å‡è®¾ä»åœ°å€0x0654åœ°å€è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®ã€‚ç”±äºcache line sizeæ˜¯8 Bytesï¼Œå› æ­¤offsetéœ€è¦3 bitsï¼Œè¿™å’Œä¹‹å‰ç›´æ¥æ˜ å°„ç¼“å­˜ä¸€æ ·ï¼›ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯indexï¼Œåœ¨ä¸¤è·¯ç»„ç›¸è¿ç¼“å­˜ä¸­ï¼Œindexåªéœ€è¦2 bitsï¼Œå› ä¸ºä¸€è·¯åªæœ‰4è¡Œcache lineã€‚ä¸Šé¢çš„ä¾‹å­æ ¹æ®indexæ‰¾åˆ°ç¬¬2è¡Œcache lineï¼ˆä»0å¼€å§‹è®¡ç®—ï¼‰ï¼Œç¬¬2è¡Œå¯¹åº”2ä¸ªcache lineï¼Œåˆ†åˆ«å¯¹åº”way 0å’Œway 1ã€‚å› æ­¤indexä¹Ÿå¯ä»¥ç§°ä½œset indexï¼ˆç»„ç´¢å¼•ï¼‰ã€‚å…ˆæ ¹æ®indexæ‰¾åˆ°setï¼Œç„¶åå°†ç»„å†…çš„æ‰€æœ‰cache lineå¯¹åº”çš„tagå–å‡ºæ¥å’Œåœ°å€ä¸­çš„tagéƒ¨åˆ†å¯¹æ¯”ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªç›¸ç­‰å°±æ„å‘³ç€å‘½ä¸­ã€‚ å› æ­¤ï¼Œä¸¤è·¯ç»„ç›¸è¿ç¼“å­˜è¾ƒç›´æ¥æ˜ å°„ç¼“å­˜æœ€å¤§çš„å·®å¼‚å°±æ˜¯ï¼šç¬¬ä¸€ä¸ªåœ°å€å¯¹åº”çš„æ•°æ®å¯ä»¥å¯¹åº”2ä¸ªcache lineï¼Œè€Œç›´æ¥æ˜ å°„ç¼“å­˜ä¸€ä¸ªåœ°å€åªå¯¹åº”ä¸€ä¸ªcache line</p></li><li><p><strong>å…¨ç›¸è¿ç¼“å­˜(Full associative cache)</strong></p><p>è¿›ä¸€æ­¥æŠŠæ‰€æœ‰çš„cache lineæ”¾åœ¨ä¸€ä¸ªç»„é‡Œï¼Œç§°ä¹‹ä¸ºå…¨ç›¸è¿ç¼“å­˜</p><p><img src="https://s2.loli.net/2023/04/14/Eefgy3G5dYlxDtH.png"></p><p>ç”±äºæ‰€æœ‰çš„cache lineéƒ½åœ¨ä¸€ä¸ªç»„å†…ï¼Œå› æ­¤åœ°å€ä¸­ä¸éœ€è¦set indexéƒ¨åˆ†ã€‚å› ä¸ºï¼Œåªæœ‰ä¸€ä¸ªç»„è®©ä½ é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯æ²¡å¾—é€‰ã€‚æˆ‘ä»¬æ ¹æ®åœ°å€ä¸­çš„tagéƒ¨åˆ†å’Œæ‰€æœ‰çš„cache lineå¯¹åº”çš„tagè¿›è¡Œæ¯”è¾ƒï¼ˆç¡¬ä»¶ä¸Šå¯èƒ½å¹¶è¡Œæ¯”è¾ƒä¹Ÿå¯èƒ½ä¸²è¡Œæ¯”è¾ƒï¼‰ã€‚å“ªä¸ªtagæ¯”è¾ƒç›¸ç­‰ï¼Œå°±æ„å‘³ç€å‘½ä¸­æŸä¸ªcache lineã€‚å› æ­¤ï¼Œåœ¨å…¨ç›¸è¿ç¼“å­˜ä¸­ï¼Œä»»æ„åœ°å€çš„æ•°æ®å¯ä»¥ç¼“å­˜åœ¨ä»»æ„çš„cache lineä¸­ã€‚æ‰€ä»¥ï¼Œè¿™å¯ä»¥æœ€å¤§ç¨‹åº¦çš„é™ä½cacheé¢ ç°¸çš„é¢‘ç‡ï¼Œä½†æ˜¯ç¡¬ä»¶æˆæœ¬ä¸Šä¹Ÿæ˜¯æ›´é«˜ã€‚</p></li><li><p><strong>ç¼“å­˜å‘½ä¸­</strong></p><p>cache hitï¼šcacheä¸­æœ‰blockçš„æœ‰æ•ˆå‰¯æœ¬ï¼Œæ‰€ä»¥èƒ½è¿”å›æœŸæœ›æ•°æ®</p><p>cache missï¼šcacheä¸­æ²¡æœ‰æƒ³è¦çš„blockï¼Œæ‰€ä»¥åªèƒ½ä»memoryä¸­å–å‡º</p><p>block replacementï¼šè‹¥cacheæ»¡äº†ï¼Œå°±è¦æ’¤é”€å…¶ä¸­ä¸€ä¸ªblockï¼Œç”¨æœŸå¾…è¯»å–çš„æ•°æ®æ›¿æ¢ã€‚ä½†æ˜¯æ›¿æ¢å“ªä¸ªblockæï¼Ÿ</p><p>å¸¸ç”¨çš„cacheç®—æ³•ï¼š</p><ul><li><p>éšæœºæ›¿æ¢</p></li><li><p>Least Recently Usedï¼ˆLRUï¼‰ï¼šæœ€è¿‘ä¸€æ¬¡è®¿é—®æ—¶é—´æœ€ä¹…è¿œçš„é‚£ä¸ªblock</p></li></ul></li><li><p><strong>å¤šçº§cacheä¹‹é—´çš„é…åˆå·¥ä½œ:</strong></p><p><img src="https://s2.loli.net/2023/04/14/X14bpdWwz5aSgCn.png"></p><p>å½“CPUè¯•å›¾ä»æŸåœ°å€loadæ•°æ®æ—¶ï¼Œé¦–å…ˆä»L1 cacheä¸­æŸ¥è¯¢æ˜¯å¦å‘½ä¸­ï¼Œå¦‚æœå‘½ä¸­åˆ™æŠŠæ•°æ®è¿”å›ç»™CPUã€‚å¦‚æœL1 cacheç¼ºå¤±ï¼Œåˆ™ç»§ç»­ä»L2 cacheä¸­æŸ¥æ‰¾ã€‚å½“L2 cacheå‘½ä¸­æ—¶ï¼Œæ•°æ®ä¼šè¿”å›ç»™L1 cacheåŠCPUã€‚å¦‚æœL2 cacheä¹Ÿç¼ºå¤±ï¼Œå¾ˆä¸å¹¸ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸»å­˜ä¸­loadæ•°æ®ï¼Œå°†æ•°æ®è¿”å›ç»™L2 cacheã€L1 cacheåŠCPUã€‚è¿™ç§å¤šçº§cacheçš„å·¥ä½œæ–¹å¼ç§°ä¹‹ä¸ºinclusive cacheã€‚æŸä¸€åœ°å€çš„æ•°æ®å¯èƒ½å­˜åœ¨å¤šçº§ç¼“å­˜ä¸­ã€‚ä¸inclusive cacheå¯¹åº”çš„æ˜¯exclusive cacheï¼Œè¿™ç§cacheä¿è¯æŸä¸€åœ°å€çš„æ•°æ®ç¼“å­˜åªä¼šå­˜åœ¨äºå¤šçº§cacheå…¶ä¸­ä¸€çº§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»æ„åœ°å€çš„æ•°æ®ä¸å¯èƒ½åŒæ—¶åœ¨L1å’ŒL2 cacheä¸­ç¼“å­˜</p></li><li><p><strong>å†™æ“ä½œï¼š</strong></p><p>å†™æ“ä½œä¼šé€ æˆcacheå’Œä¸»å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯æ•°æ®æ“ä½œæ­£ç¡®æï¼Ÿ</p><ul><li><p>é€šå†™ï¼ˆwrite throughï¼‰ï¼šæŠŠæ•°æ®å†™å…¥cacheçš„åŒæ—¶ä¹Ÿå†™å…¥ä¸»å­˜ï¼Œå¥½å¤„æ˜¯ä¿æŒä¸€è‡´æ€§ï¼Œåå¤„æ˜¯æå…¶å½±å“å†™é€Ÿåº¦</p><p><img src="https://s2.loli.net/2023/04/14/EJbRZ36jGACeOsL.png"></p></li><li><p>å›å†™ï¼ˆwrite backï¼‰ï¼šå…ˆæŠŠæ•°æ®å†™å›cacheï¼Œå½“cacheä¸­çš„æ•°æ®è¢«æ›¿æ¢æ—¶å†å†™å›ä¸»å­˜ã€‚å…·ä½“é€šè¿‡dirty bitå®ç°ï¼Œæ•°æ®ä¿®æ”¹åˆ™ç½®ä½ã€‚</p></li></ul><p><img src="https://s2.loli.net/2023/04/14/DHV7LmUpOwS63Ic.png"></p></li><li><p><strong>AMATï¼ˆAverage Memory Access Timeï¼‰</strong></p><p>åŒæ—¶è€ƒè™‘å‘½ä¸­å’Œä¸¢å¤±æ—¶çš„è·å–memoryä¸­æ•°æ®çš„å¹³å‡æ—¶é—´</p></li></ol><p><img src="https://s2.loli.net/2023/04/14/qd5wpKOuEiGHbyA.png"></p><p><img src="https://s2.loli.net/2023/04/14/5eh9B36T7NISdHL.png"></p><p>â€‹AMAT&#x3D;1+0.02*50&#x3D;2 clock cycles&#x3D;400ps</p><p>â€‹â€”â€”190ps clockï¼š2 cycles&#x3D;2*190&#x3D;380</p><p>â€‹â€”â€”MP of 40 clock cyclesï¼š1+0.02*40&#x3D;360</p><p>â€‹<strong>â€”â€”MR of 0.015*50&#x3D;350 ï¼ˆâˆšï¼‰</strong></p><h1 id="Lecture18-19ã€Operating-Systems-amp-Virtual-Memory"><a href="#Lecture18-19ã€Operating-Systems-amp-Virtual-Memory" class="headerlink" title="Lecture18-19ã€Operating Systems &amp; Virtual Memory"></a>Lecture18-19ã€Operating Systems &amp; Virtual Memory</h1><ol><li><p>OSçš„æœ€å…¸å‹ç‰¹å¾ä¹‹ä¸€å°±æ˜¯<strong>å¤šä»»åŠ¡</strong>ï¼Œä¾èµ–äºä¸åŒå¤„ç†å™¨çš„è¿›ç¨‹åˆ‡æ¢ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹å¯èƒ½å¯¼è‡´å†…å­˜èµ„æºåœ°å€ç­‰å‘ç”Ÿå˜åŒ–</p><p><img src="https://s2.loli.net/2023/04/14/cwJQEKZl3WgzmU4.png"></p><p><img src="https://s2.loli.net/2023/04/14/yGSTfc3ELUFu4nQ.png"></p><p>é€ æˆè¿™ç§ç°è±¡çš„åŸå› æ˜¯åº”ç”¨æœªå®Œå…¨éš”ç¦»ï¼Œä¸€ä¸ªåº”ç”¨å¯ä»¥è¦†å†™å¦ä¸€ä¸ªåº”ç”¨çš„å†…å­˜ï¼ŒåŒæ—¶è€ƒè™‘åˆ°ä¸€äº›å…¶ä»–é—®é¢˜ï¼ˆå¦‚å¯èƒ½ä¼šå¤„ç†æ¯”æˆ‘ä»¬çœŸæ­£éœ€æ±‚è¦å¤šä¸å°‘çš„å†…å­˜ï¼Œåƒç¨€ç–çŸ©é˜µï¼‰ï¼Œæˆ‘ä»¬å¼•å…¥è™šæ‹Ÿå†…å­˜</p></li><li><p><strong>virtual memory</strong></p><ul><li>è™šæ‹Ÿå†…å­˜VMï¼šç»™æ¯ä¸ªè¿›ç¨‹éš”ç¦»çš„ç©ºé—´ï¼Œè¿›ç¨‹è®¤ä¸ºå…¶å†…å­˜è¶³å¤Ÿå¤§ï¼Œå¹¶ä¸”å®Œå…¨å±äºè‡ªå·±ï¼ˆä»…è‡ªå·±æœ‰è®¿é—®æƒï¼‰</li><li>ç‰©ç†å†…å­˜PMï¼šç”µè„‘ä¸­çœŸå®çš„é™åˆ¶æ€§çš„RAM</li></ul><p><strong>key ideaï¼š</strong>ç”±äºç¨‹åºå¤§å°çš„è†¨èƒ€ï¼Œä¸”ç³»ç»ŸåŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œç»å¸¸ä¼šå‡ºç°éœ€è¦ç©ºé—´&gt;å®é™…å†…å­˜çš„é—®é¢˜ï¼Œè€Œè™šæ‹Ÿå†…å­˜å¯æœ‰æ•ˆè§£å†³è¯¥é—®é¢˜ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æŒæœ‰å„è‡ªçš„è™šæ‹Ÿå†…å­˜ï¼Œ<strong>åˆ†ä¸ºå¾ˆå¤šä¸ªé¡µ</strong>ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰é¡µéƒ½å¿…é¡»åœ¨å†…å­˜ä¸­æ—¶æ‰èƒ½è¿è¡Œç¨‹åºã€‚ç”¨åˆ°å“ªä¸€é¡µï¼Œå°±ä½œæ˜ å°„å»ç‰©ç†åœ°å€å¯»æ‰¾æ•°æ®ï¼›è‹¥æ˜ å°„è¿™ä¸ªç‰©ç†åœ°å€ä¸åœ¨å†…å­˜ä¸­æ€ä¹ˆåŠæï¼Ÿé‚£å®ƒåœ¨å“ªé‡Œæï¼Ÿç­”æ¡ˆæ˜¯ï¼š<strong>å¤–å­˜ï¼Œå³disk</strong>ã€‚æ¥ä¸‹æ¥ç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆå°†å¤–å­˜è°ƒå…¥å†…å­˜çš„çš„å·¥ä½œï¼›è€Œå½“å†…å­˜ç©ºé—´ä¸å¤Ÿæ—¶ï¼Œç³»ç»ŸæŒ‰ä¸€å®šç®—æ³•<strong>é‡Šæ”¾æŸéƒ¨åˆ†å†…å­˜ç©ºé—´</strong>ã€‚ é€šè¿‡ä¸Šè¿°æ“ä½œï¼Œå°±èƒ½è®©ç¨‹åºåœ¨è¿è¡Œä¸­æ„Ÿè§‰åˆ°æ‹¥æœ‰ä¸€ä¸ªä¸å—å†…å­˜å®¹é‡çº¦æŸçš„ã€è™šæ‹Ÿçš„ã€èƒ½å¤Ÿæ»¡è¶³è‡ªå·±éœ€æ±‚çš„å­˜å‚¨å™¨ã€‚</p><p>ä¸»è¦éœ€è¦è¾¾æˆçš„å‡ ä¸ªç›®æ ‡ï¼š</p><ul><li><p>è¿›ç¨‹éš”ç¦»</p></li><li><p>æœ‰é™åˆ°æ— é™ç©ºé—´çš„è¿‡æ¸¡</p></li><li><p>VMã€PMåœ°å€çš„è½¬æ¢</p></li></ul></li><li><p><strong>è§£å†³æ€è·¯ï¼šåˆ†æ®µå†…å­˜ï¼ˆsegmented memoryï¼‰</strong></p><p>æ¯ä¸ªæ®µç”¨åŸºåœ°å€ï¼ˆbaseï¼‰å’Œåç§»åœ°å€ï¼ˆboundï¼‰è¡¨ç¤ºï¼Œæ¯ä¸ªç¨‹åºç‹¬äº«ä¸€ä¸ªsegmentï¼Œåœ¨å„è‡ªçš„å†…å­˜è§†è§’ä¸­ï¼Œéƒ½è®¤ä¸ºè‡ªå·±è¿™ä¸ªæ®µçš„æ®µé¦–åœ°å€æ˜¯0x0000</p><p>åœ¨è£¸çš„äº”æ®µæµæ°´çº¿ä¸­ï¼ŒPCè¾“å‡ºçš„æ˜¯çœŸå®çš„ç‰©ç†åœ°å€ï¼›ä½†åœ¨base and boundæœºåˆ¶ä¸­ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/sEHDjNy6hVXOwtf.png"></p><p>ä½†åˆ†æ®µå†…å­˜ä»æœ‰ä¸€äº›é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬éœ€è¦çš„åœ°å€æ¯”æ®µç©ºé—´å¤§æï¼ŸRAMéƒ½åˆ†æˆäº†æ®µå¯¼è‡´è¿ç»­ç©ºé—´ä¸å¤Ÿæï¼Ÿ</p></li><li><p><strong>åˆ†é¡µå†…å­˜ï¼ˆpaged memoryï¼‰</strong></p><p><strong>key ideaï¼š</strong>æŠŠç‰©ç†å†…å­˜å‡åˆ†ä¸ºå¤šä¸ªpageï¼Œæ¯ä¸ªè¿›ç¨‹å¯ä»¥ç‹¬äº«å¤šä¸ªpageã€‚pageåœ¨RAMä¸­ä¸å¿…çœŸçš„è¿ç»­ï¼Œä½†åœ¨å„ä¸ªè¿›ç¨‹çš„è§†è§’çœ‹æ¥ï¼Œå®ƒä»¬å¯¹è‡ªå·±æ¥è¯´å°±æ˜¯è¿ç»­çš„</p><p>é‚£VMã€PMåœ°å€å¦‚ä½•è½¬æ¢å‘¢â€”â€”page tableï¼Œæ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€å¼ ï¼Œç”¨äºè®°å½•è‡ªå·±å ç”¨çš„pageå’Œå…¶çœŸå®ç‰©ç†åœ°å€</p><p><img src="https://s2.loli.net/2023/04/14/uHglNXbaPYtRD8G.png"></p><p>æ³¨æ„ï¼šè™šæ‹Ÿå†…å­˜åœ¨RAMæ²¡æœ‰å¯¹åº”æ˜¯ä¸€ä»¶å¾ˆæ­£å¸¸çš„äº‹å“ˆï¼ˆå›¾ä¸­é»„è‰²çš„é‚£äº›é¡µï¼‰ï¼ŒCç›˜é‡Œé‚£ä¸ªå·¨å¤§çš„PageFile.Syså°±æ˜¯æ”¾åœ¨å¤–å­˜é‡Œçš„è™šæ‹Ÿå†…å­˜</p></li><li><p><strong>åœ°å€è½¬æ¢</strong></p><p><img src="https://s2.loli.net/2023/04/14/X95WOrG2kMZ7HAp.png"></p><p><img src="https://s2.loli.net/2023/04/14/IUG75RzLhYKfJ6F.png"></p><p><strong>è½¬æ¢ç®—æ³•ï¼š</strong></p><p>1ï¼‰é€šè¿‡virtual page numberåœ¨è¡¨ä¸­æ‰¾åˆ°å¯¹åº”ä½ç½®</p><p>2ï¼‰æ£€æŸ¥validå’Œaccess rightsä½æ˜¯å¦æœ‰æ•ˆ</p><p>3ï¼‰é€šè¿‡physical page numberå’Œoffsetç®—å‡ºç‰©ç†åœ°å€</p></li><li><p><strong>é¡µé¢è¡¨</strong></p><p>è‹¥æ˜¯ç®€å•çš„çº¿æ€§ç»“æ„è¡¨ï¼Œéœ€è¦è¡¨0å’Œè¡¨næ—¶å¾—éå†æ•´ä¸ªè¡¨ï¼Œå¾ˆè€—æ—¶é—´ï¼ˆä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸­page tableé‡Œçš„entryå¯å¤šè¾¾æ•°ç™¾ä¸‡æ¡ï¼‰ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›æ”¹è¿›ç»“æ„</p><ul><li><p><strong>åˆ†çº§åˆ†é¡µ</strong></p><p><img src="https://s2.loli.net/2023/04/14/pfaS9cNI3jtsAvB.png"></p></li></ul></li><li><p><strong>é¡µè¡¨ç¼“å†²TLBï¼ˆTranslation Lookaside Bufferï¼‰</strong></p><p>åœ¨åˆ†çº§åˆ†é¡µä¸­ï¼Œè·å–ä¸€ä¸ªæ•°æ®å¯èƒ½éœ€è¦å¤šæ¬¡è®¿é—®physical addressï¼Œé€ æˆé€Ÿåº¦ç¼“æ…¢ï¼Œè€Œæ—¢ç„¶pageä¸­ä¹Ÿå­˜åœ¨å±€éƒ¨æ€§ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨å’Œcacheçš„ç±»ä¼¼çš„ç¼“å­˜ç»“æ„</p><p><img src="https://s2.loli.net/2023/04/14/J7bRiFxkNu6yQHD.png"></p><ul><li>TLBä¸­å­˜çš„ä¸æ˜¯å†…å­˜æ•°æ®ï¼Œè€Œæ˜¯VPNâ†’PPNçš„æ˜ å°„</li><li>TLBé€šå¸¸å¾ˆå°ï¼Œä¸€èˆ¬å­˜32-128æ¡entry</li><li>é€Ÿåº¦æ¯”cacheå¿«å¾ˆå¤š</li></ul><p><strong>TLBå’Œcacheçš„ç»„åˆå·¥ä½œåŸç†ï¼š</strong>å…ˆåœ¨TLBä¸­æŸ¥è™šæ‹Ÿåœ°å€ï¼Œå‘½ä¸­åˆ™ç›´æ¥åœ¨cacheä¸­è¯»ç‰©ç†åœ°å€ï¼›å¦åˆ™åœ¨page tableä¸­æ‰¾æ˜ å°„å…³ç³»</p><p><img src="https://s2.loli.net/2023/04/14/kE78VqNFfGBLZlj.png"></p></li></ol><h1 id="Lecture20ã€IO"><a href="#Lecture20ã€IO" class="headerlink" title="Lecture20ã€IO"></a>Lecture20ã€IO</h1><ol><li><p><strong>disks are I&#x2F;Oï¼š</strong>å› ä¸ºcpuæ— æ³•ä»ç£ç›˜ï¼ˆåŒ…æ‹¬ssdå’Œæœºæ¢°ï¼‰ä¸­ç›´æ¥è¯»å†™æ•°æ®ï¼Œpageä»diskç§»å‘RAMåæ‰ä¼šå˜æˆmemoryï¼›ç”µè„‘æ²¡diskä¹Ÿèƒ½è·‘</p></li><li><p><strong>IOæ“ä½œæ–¹å¼ï¼š</strong></p><p>å¤„ç†å™¨é¢‘ç‡ä¸€èˆ¬è¿œå¤§äºIOè®¾å¤‡ï¼Œæ‰€ä»¥éœ€è¦ä¸€å®šæ–¹å¼è¿›è¡Œæ“ä½œ</p><ul><li><p><strong>è½®è¯¢ï¼ˆpollingï¼‰</strong></p><p>å¤„ç†å™¨åœ¨å¾ªç¯ä¸­ä¸æ–­ç­‰å¾…control registerä¿¡å·ï¼Œè‹¥ready bitç½®ä¸€ï¼Œåˆ™å¤„ç†å™¨å‘data registerä¸­è¯»å†™æ•°æ®ï¼Œcè¯­è¨€ä¸­çš„while(getchar()&#x3D;&#x3D;â€˜xâ€™)å…¶å®å°±æ˜¯ä¸€ç§æœ€ç®€å•çš„è½®è¯¢æ€æƒ³ è½®è¯¢å¯¹äºä¸€äº›ç®€å•è®¾å¤‡æ²¡é—®é¢˜ï¼Œå¦‚é¼ æ ‡ï¼Œä¸€ç§’åªåš30æ¬¡pollingï¼Œcpuè€—æ—¶æ¯”ä¾‹å¾ˆä½ï¼›ä½†ç£ç›˜æ¯ç§’è¯»å†™æ•°MBçš„æ•°æ®ï¼Œç®—ä¸‹æ¥cpué«˜è¾¾40%çš„æ—¶é—´éƒ½è€—åœ¨è½®è¯¢ä¸Šï¼Œæ˜¾ç„¶ä¸å¯æ¥å—</p></li><li><p><strong>ä¸­æ–­ï¼ˆinterruptï¼‰</strong></p><p><img src="https://s2.loli.net/2023/04/14/D5sxBgJl7cUIuOw.png"></p><p>ç»è®¡ç®—ï¼Œä¸­æ–­å¯æŠŠcpuåœ¨ç£ç›˜è¯»å†™ä¸Šçš„è€—æ—¶é™åˆ°2%ï¼Œä½†è¿˜å¯ä»¥ä¼˜åŒ–</p></li><li><p><strong>DMAï¼š</strong>memoryå’ŒIOè®¾å¤‡ç›´æ¥ä¼ æ•°æ®ï¼Œä¸ç»è¿‡cpu</p><p>ä¸€ä¸ªæ¯”å–»ï¼špollingåƒé¥¿äº†å»é¤é¦†ï¼Œè¿‡ä¸€ä¼šå„¿é—®ä¸‹â€œèœå¥½æ²¡â€ï¼›interruptåƒåœ¨çº¿ä¸‹å•ï¼Œä½ ç»§ç»­å¹²æ´»ï¼Œåšå¥½äº†å†å«ä½ ï¼Œå»äº†ç›´æ¥æ‹¿ç›´æ¥èµ°ï¼›dmaåˆ™åƒä¸‹ä¸€å•å¤–å–ï¼Œæ‹¿å–éƒ½å–æ¶ˆï¼Œåªç®¡ç­‰ä¸œè¥¿æ¥</p><p><img src="https://s2.loli.net/2023/04/14/gMWR4TAvKzIw9Jk.png"></p><p>ç»è®¡ç®—ï¼Œdmaå¯æŠŠcpuåœ¨ç£ç›˜è¯»å†™ä¸Šçš„è€—æ—¶é™åˆ°0.2%</p></li></ul></li></ol><h1 id="Lecture21ã€Data-level-Parallelism"><a href="#Lecture21ã€Data-level-Parallelism" class="headerlink" title="Lecture21ã€Data-level Parallelism"></a>Lecture21ã€Data-level Parallelism</h1><ol><li><p><strong>motivationï¼š</strong>æ™¶ä½“ç®¡çš„å‘å±•å—é™ï¼Œæ— æ³•é€šè¿‡æé«˜æ—¶é’Ÿé¢‘ç‡è¿›ä¸€æ­¥æå‡cpuæ€§èƒ½ï¼Œè€Œå¹¶è¡Œæ­£æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„å¥½æ–¹æ³•</p></li><li><p><strong>å¹¶è¡ŒåŒ–åˆ†ç±»</strong></p><p><img src="https://s2.loli.net/2023/04/14/zlKvwu2JBD8m4aL.png"></p></li><li><p><strong>SIMD(Single Instruction Multiple Data)æ¶æ„</strong></p><p>è®¸å¤šåŸºæœ¬æ•°æ®ç±»å‹ä¸º8bitï¼Œè€Œç°åœ¨å¤„ç†å™¨æ˜¯32&#x2F;64bitï¼Œè‹¥ä¸€æ¬¡åªç”¨64ä½ä¸­çš„ä½å…«ä½å¤„ç†æ•°æ®æ˜¾ç„¶å¾ˆæµªè´¹ï¼Œä½†è‹¥å°†64ä½å¯„å­˜å™¨æ‹†æˆ8ä¸ª8ä½å¯„å­˜å™¨å°±èƒ½åŒæ—¶å®Œæˆ8ä¸ªæ“ä½œï¼Œè®¡ç®—æ•ˆç‡æå‡8å€ï¼Œè¿™å°±æ˜¯SIMDçš„åˆè¡·ï¼Œå…·ä½“è¡¨ç°ä¸ºå‘é‡è¿ç®—</p><p><img src="https://s2.loli.net/2023/04/14/DeBKghxMAmLtojf.png"></p><p>intelçš„ä¸€äº›æ‹“å±•æŒ‡ä»¤é›†SSEï¼ˆStreaming SIMD Extensionsï¼‰ã€AVXï¼ˆAdvanced Vector Extensionsï¼‰ç”¨äºè¿›è¡ŒSIMDè¿ç®—</p><p>å…·ä½“å®ç°ä¸Šï¼Œå¸¸ç”¨å†…ç½®å‡½æ•°ï¼ˆintrinsicsï¼‰æ–¹å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºè®©ä¸¤æ•°ç»„ç›¸åŠ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">add_no_SSE</span><span class="hljs-params">(<span class="hljs-type">int</span> size, <span class="hljs-type">int</span> *first_array, <span class="hljs-type">int</span> *second_array)</span> </span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i) &#123;<br>first_array[i] += second_array[i];<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">add_SSE</span><span class="hljs-params">(<span class="hljs-type">int</span> size, <span class="hljs-type">int</span> *first_array, <span class="hljs-type">int</span> *second_array)</span> </span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i + <span class="hljs-number">4</span> &lt;= size; i+=<span class="hljs-number">4</span>) &#123; <span class="hljs-comment">// only works if (size%4) == 0</span><br><span class="hljs-comment">// load 128-bit chunks of each array</span><br>__m128i first_values = _mm_loadu_si128((__m128i*) &amp;first_array[i]);<br>__m128i second_values = _mm_loadu_si128((__m128i*) &amp;second_array[i]);<br><span class="hljs-comment">// add each pair of 32-bit integers in the 128-bit chunks</span><br>first_values = _mm_add_epi32(first_values, second_values);<br><span class="hljs-comment">// store 128-bit chunk to first array</span><br>_mm_storeu_si128((__m128i*) &amp;first_array[i], first_values);<br>&#125;<br>...<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>å¾ªç¯å±•å¼€</strong></p><p><img src="https://s2.loli.net/2023/04/14/wW4sJ17DUOF3xtM.png"></p><p>ä¸ºä»€ä¹ˆè¿™ç§å¾ªç¯å±•å¼€å¯ä»¥åŠ é€Ÿè¿ç®—å‘¢ï¼Ÿ</p><p>æœªå±•å¼€æ—¶çš„æ±‡ç¼–ä»£ç ï¼šæ¯ä¸ªå…ƒç´ æ“ä½œå®Œåéƒ½è¦è·³ä¸€æ¬¡loop</p><p><img src="https://s2.loli.net/2023/04/14/Z68HIYsCQLaOqRk.png"></p><p>å±•å¼€åï¼šæ±‡ç¼–ä»£ç é‡æ’ï¼Œå¯åˆ©ç”¨SIMDæœºåˆ¶</p></li></ol><p><img src="https://s2.loli.net/2023/04/14/se4LKvalYpqyCRH.png"></p><h1 id="Lecture22ã€Thread-level-Parallelism"><a href="#Lecture22ã€Thread-level-Parallelism" class="headerlink" title="Lecture22ã€Thread-level Parallelism"></a>Lecture22ã€Thread-level Parallelism</h1><ol><li><p><strong>å¤šå¤„ç†å™¨è¿è¡Œå¤šè¿›ç¨‹(å¹¶è¡Œ)</strong></p><p><img src="https://s2.loli.net/2023/04/14/5xt7rjyhSsvkwz1.png"></p><p>æ¯ä¸ªè¿›ç¨‹åœ¨å„è‡ªçš„å¤„ç†å™¨ä¸Šè¿è¡Œï¼Œä½†äº«ç”¨åŒæ ·çš„ç³»ç»Ÿå†…å­˜</p></li><li><p><strong>å•å¤„ç†å™¨è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼ˆå¹¶å‘ï¼‰</strong></p><p>å„ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„PCã€å¯„å­˜å™¨ã€æ ˆç©ºé—´ï¼Œäº«ç”¨ç›¸åŒçš„é™æ€ç©ºé—´ã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯æµè§ˆå™¨ä¸­å¼€å¤šä¸ªé¡µé¢ï¼Œæ¯ä¸ªé¡µé¢çš„æµè§ˆå™¨æºç å’Œå…¨å±€è®¾ç½®æ˜¯ä¸€æ ·çš„ï¼Œä½†æœ‰ç€å„è‡ªä¸åŒçš„stackå’Œå¯„å­˜å™¨ï¼ˆä½†äº‹å®ä¸Šç°åœ¨çš„æµè§ˆå™¨å‡ºäºå®‰å…¨å’Œæ€§èƒ½åŸå› ï¼Œç»™æ¯ä¸ªé¡µé¢ç”¨çš„æ˜¯ç‹¬ç«‹çš„å¤„ç†å™¨ï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/vyPLMpWEcDRr6kB.png"></p><p>å¤šçº¿ç¨‹æœ‰å•¥å¥½å¤„å‘¢ï¼šå¤„ç†å™¨çš„èµ„æºå®è´µï¼Œå¤šçº¿ç¨‹å¯ä»¥å°½å¯èƒ½<strong>é¿å…å…¶ç©ºé—²ï¼Œ</strong>å¦‚cache missåæœ‰ä¸ªå¾ˆé•¿çš„memory latencyï¼Œåˆ™ç›´æ¥åˆ‡æ¢åˆ°å…¶å®ƒçº¿ç¨‹ï¼ˆæ‰€ä»¥åˆ‡æ¢ä¸Šä¸‹æ–‡çš„å¼€é”€å¾—å°äºcache miss latencyï¼‰</p></li><li><p><strong>å¹¶å‘ä¸­çš„ä¸€äº›é—®é¢˜</strong></p><ul><li><p><strong>åŠ é€Ÿæ€§èƒ½</strong></p><p>é˜¿å§†è¾¾å°”å®šå¾‹ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/tj3WE45JF9sIxfg.png"></p><p>å¯çŸ¥å¯¹äºä¸€ä¸ª5%çš„æ—¶é—´ä½¿ç”¨å¹¶è¡Œï¼Œå³ä½¿ç”¨5ä¸ªå¤„ç†å™¨ï¼Œå…¶åŠ é€Ÿæ€§èƒ½ä¹Ÿä¸è¿‡æ˜¯ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/cHliG971Uqwv6Sn.png"></p><p>åªæœ‰å¹¶è¡Œè¿ç®—å æ¯”è¶³å¤Ÿé«˜æ—¶ï¼Œå¤„ç†å™¨æ•°é‡çš„å¢åŠ æ‰ä¼šå¸¦æ¥æ˜æ˜¾æ€§èƒ½æå‡</p><p><img src="https://s2.loli.net/2023/04/14/hgDJ5ktYdTmsX8K.png"></p><p>ä½†è¿™æ ·çš„åŠ é€Ÿä¹Ÿæœ‰ç“¶é¢ˆï¼Œç”±é˜¿å§†è¾¾å°”å®šå¾‹å¯çŸ¥ï¼ŒSè¶³å¤Ÿå¤§æ—¶ï¼Œspeedupæ¥è¿‘äºå¸¸æ•°</p><p><strong>è§£å†³æ€è·¯ï¼š</strong>åŸå§‹è¿ç®—ä¸­å°½å¯èƒ½å°‘ç”¨æ ‡é‡è¿ç®—ï¼Œä¹Ÿå°±æ˜¯å°½é‡æå‡å¹¶è¡ŒåŒ–å æ¯”</p></li><li><p><strong>æ•°æ®ç«äº‰</strong></p><p>çº¿ç¨‹è°ƒåº¦æ˜¯<strong>ä¸ç¡®å®šçš„</strong>ï¼Œå› æ­¤å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå˜é‡æ“ä½œæ—¶ï¼Œå…¶æœ€ç»ˆçš„å€¼ä¹Ÿæ˜¯ä¸ç¡®å®šçš„</p><p><strong>è§£å†³æ€è·¯ï¼š</strong>ä¸è¦å¾€ç›¸åŒçš„å†…å­˜å†™æ•°æ®ï¼›è®©è¯»å†™åŒæ­¥ï¼Œä»è€Œè·å¾—ç¡®å®šè¡Œä¸º</p></li></ul></li><li><p><strong>é”åŒæ­¥</strong></p><p>ç”¨lockæ¥å¯¹é‡è¦åŒºåŸŸï¼ˆæ¯”å¦‚æœ‰å…±åŒæ“ä½œçš„å˜é‡çš„å†…å­˜åŒºåŸŸï¼‰ä½œè®¿é—®é™åˆ¶ï¼Œä»¥ä¾¿ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®</p><p><img src="https://s2.loli.net/2023/04/14/lkWcYZOyRASI84p.png"></p></li><li><p><strong>cache coherence</strong></p><p><img src="https://s2.loli.net/2023/04/14/wDslLqVnNKrOdg3.png"></p><p>å‡è®¾ä¸¤ä¸ªcoreåŒæ—¶è¿è¡Œä¸¤ä¸ªçº¿ç¨‹ï¼Œéƒ½å¯¹å˜é‡iè¿›è¡Œæ“ä½œï¼Œè¿™æ—¶Aæ‰§è¡Œäº†i++ï¼Œcacheé‡‡ç”¨å†™å›ç­–ç•¥ï¼Œå³å…ˆæ”¾åˆ°è‡ªå·±çš„cacheé‡Œå¹¶æŠŠdirty bitç½®ä¸€ï¼Œå¹¶æœªåŒæ­¥åˆ°memoryã€‚è¿™æ—¶Bä»å†…å­˜è¯»içš„å€¼ï¼Œåˆ™è¯»åˆ°çš„å°†ä¼šæ˜¯é”™è¯¯å€¼ï¼Œå³æ‰€è°“çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</p><p>è§£å†³æ–¹æ³•ï¼š</p><ul><li><p><strong>å†™ä¼ æ’­ï¼ˆwrite propagationï¼‰</strong></p><p>key ideaï¼šå½“æŸä¸ªcoreæ›´æ–°äº†cacheä¸­çš„æ•°æ®æ—¶ï¼Œè¦æŠŠè¯¥äº‹ä»¶å¹¿æ’­é€šçŸ¥åˆ°å…¶å®ƒcore ï¼Œæœ€å¸¸è§çš„å®ç°æ–¹æ³•æ˜¯<strong>æ€»çº¿å—…æ¢ï¼ˆbus snoopingï¼‰</strong></p><p>å¦‚core Aæ”¹å˜äº†içš„å€¼åï¼Œä¼šé€šè¿‡æ€»çº¿æŠŠè¿™ä¸ªäº‹ä»¶å¹¿æ’­ç»™å…¶å®ƒæ‰€æœ‰coreï¼›å…¶å®ƒcoreéšæ—¶ä¿æŒç›‘å¬æ€»çº¿ä¸Šçš„å¹¿æ’­äº‹ä»¶ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒçš„æ•°æ®åœ¨è‡ªå·±çš„cacheé‡Œï¼Œè‹¥æœ‰åˆ™æ›´æ–°</p><p>ä½†è¿™ä¸ªæ–¹æ³•å¹¶ä¸å®Œç¾ï¼šä¸€æ¥æ¯ä¿®æ”¹ä¸€ä¸ªæ•°æ®éƒ½è¦å¹¿æ’­ä¸€æ¬¡ï¼Œä¼šåŠ é‡æ€»çº¿è´Ÿè½½ï¼›äºŒæ¥æ€»çº¿å—…æ¢åªèƒ½ä¿è¯æŸä¸ª CPU æ ¸å¿ƒçš„ Cache æ›´æ–°æ•°æ®è¿™ä¸ªäº‹ä»¶èƒ½è¢«å…¶ä»– CPU æ ¸å¿ƒçŸ¥é“ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯äº‹åŠ¡ä¸²è¡ŒåŒ–ï¼ˆå³ä¸çŸ¥é“è°å…ˆæ”¹è°åæ”¹ï¼‰</p></li><li><p><strong>MESI åè®®</strong></p><p>MESI åè®®å…¶å®æ˜¯ 4 ä¸ªçŠ¶æ€å•è¯çš„å¼€å¤´å­—æ¯ç¼©å†™ï¼Œåˆ†åˆ«æ˜¯ï¼šModifiedï¼ˆå·²ä¿®æ”¹ï¼‰ã€Exclusiveï¼ˆç‹¬å ï¼‰ã€Sharedï¼ˆå…±äº«ï¼‰ã€Invalidatedï¼ˆå·²å¤±æ•ˆï¼‰ï¼Œè¿™å››ä¸ªçŠ¶æ€æ¥æ ‡è®° Cache Line å››ä¸ªä¸åŒçš„çŠ¶æ€</p><p>æ•´ä¸ª MESI çŠ¶æ€çš„å˜æ›´ï¼Œåˆ™æ˜¯æ ¹æ®æ¥è‡ªæœ¬åœ° CPU æ ¸å¿ƒçš„è¯·æ±‚ï¼Œæˆ–è€…æ¥è‡ªå…¶ä»– CPU æ ¸å¿ƒé€šè¿‡æ€»çº¿ä¼ è¾“è¿‡æ¥çš„è¯·æ±‚ï¼Œä»è€Œæ„æˆä¸€ä¸ªæµåŠ¨çš„çŠ¶æ€æœºã€‚å¦å¤–ï¼Œå¯¹äºåœ¨ã€Œå·²ä¿®æ”¹ã€æˆ–è€…ã€Œç‹¬å ã€çŠ¶æ€çš„ Cache Lineï¼Œä¿®æ”¹æ›´æ–°å…¶æ•°æ®ä¸éœ€è¦å‘é€å¹¿æ’­ç»™å…¶ä»– CPU æ ¸å¿ƒ</p><p><img src="https://s2.loli.net/2023/04/14/mTnkYR1GqaQlJEA.png"></p></li></ul></li></ol><h1 id="Lecture24ã€Warehouse-Scale-Computers-MapReduce"><a href="#Lecture24ã€Warehouse-Scale-Computers-MapReduce" class="headerlink" title="Lecture24ã€Warehouse Scale Computers, MapReduce"></a>Lecture24ã€Warehouse Scale Computers, MapReduce</h1><ol><li><p><strong>å…¸å‹ç»“æ„</strong></p><p><img src="https://s2.loli.net/2023/04/14/RLmXyJhxjcdo2OT.png"></p><p>ä¸€ä¸ªWSCä¸­åŒ…å«å¤šä¸ªarrayï¼ˆaka clusterï¼‰ï¼Œä¸€ä¸ªarrayä¸­æœ‰å¤šä¸ªrackï¼ˆæœºæ¶ï¼‰ï¼Œä¸€ä¸ªrackä¸­åˆåŒ…å«å¤šä¸ªæœåŠ¡å™¨</p></li><li><p><strong>é˜è¿°wscæ¶æ„å·¥ä½œè¿‡ç¨‹ï¼ˆä»¥googleæœç´¢hustä¸ºä¾‹ï¼‰</strong></p><ol><li>å‘é€è¯·æ±‚ç»™æœ€è¿‘çš„Google warehouse scale computer</li><li>å‰ç«¯å¹³è¡¡è´Ÿè½½ï¼Œåœ¨ä¼—å¤šclusterä¸­æ‰¾å‡ºæœ€åˆé€‚çš„é‚£ä¸ª</li><li>åœ¨clusterå†…éƒ¨æ‰¾å‡ºä¸€ä¸ªgoogle web serversæ¥å¤„ç†è¯·æ±‚ï¼Œç”Ÿæˆç½‘é¡µ</li><li>google web serverså’Œå†…éƒ¨æœåŠ¡å™¨äº¤æµï¼Œæ‰¾åˆ°åŒ…å«â€œhustâ€çš„é‚£ä¸ªæ–‡ä»¶</li><li>è¿”å›ç›¸å…³çš„æ–‡ä»¶åˆ—è¡¨ä»¥åŠå¯¹åº”çš„å…³è”åˆ†æ•°</li></ol><p>æ­¤å¤–ï¼Œéšä¹‹å‘ç”Ÿçš„è¿˜å¯èƒ½æœ‰ï¼š</p><ul><li>æ¨èç³»ç»Ÿç”Ÿæˆç›¸å…³å¹¿å‘Š</li><li>æ ¹æ®å…³è”åˆ†æ•°å¯¹æœç´¢ç»“æœè¿›è¡Œæ’åºï¼Œåœ¨ç½‘é¡µä¸­æ˜¾ç¤º</li><li>å¯¹ç´¢å¼•å’Œæ–‡ä»¶ç”Ÿæˆå‰¯æœ¬ï¼Œç”¨äºæé«˜request-level parallelism</li></ul></li></ol><h1 id="Lecture-Bonus"><a href="#Lecture-Bonus" class="headerlink" title="Lecture_Bonus"></a>Lecture_Bonus</h1><ol><li><p><strong>è¿›ç¨‹ä¸çº¿ç¨‹</strong></p><p>CPUæ‰§è¡Œä¸€ä¸ªå‡½æ•°çš„æœ¬è´¨æ˜¯é‚£ä¹ˆ<strong>æŠŠè¯¥å‡½æ•°å¯¹åº”çš„ç¬¬ä¸€æ¡æœºå™¨æŒ‡ä»¤çš„åœ°å€å†™å…¥PCå¯„å­˜å™¨</strong>ï¼Œè€Œæœºå™¨æŒ‡ä»¤è¦åŠ è½½åˆ°å†…å­˜ä¸­æ‰§è¡Œï¼Œéœ€è¦è®°å½•ä¸‹å†…å­˜çš„èµ·å§‹åœ°å€å’Œé•¿åº¦ï¼ŒåŒæ—¶è¦æ‰¾åˆ°å‡½æ•°çš„å…¥å£åœ°å€å¹¶å†™åˆ°PCå¯„å­˜å™¨ä¸­â€”â€”è¿™æ­£æ˜¯æ„å»º<strong>è¿›ç¨‹</strong>çš„æ€è·¯</p> <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">process</span>&#123;<br>   <span class="hljs-type">void</span>* start_addr;<br>   <span class="hljs-type">int</span> len;<br>   <br>   <span class="hljs-type">void</span>* start_point;<br>&#125;;<br></code></pre></td></tr></table></figure></li></ol><p>â€‹å¸¸è§„ç¨‹åºä¸­ï¼Œmain()æ˜¯ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„ï¼›ä½†æ˜¯æˆ‘ä»¬èƒ½å…ˆæ‰§è¡Œå…¶å®ƒå‡½æ•°å—ï¼Ÿèƒ½ï¼å› ä¸ºmain()å’Œå…¶å®ƒå‡½æ•°å¹¶æ— æœ¬è´¨åŒºåˆ«ï¼Œæ—¢ç„¶å¯ä»¥æŠŠPCå¯„å­˜å™¨æŒ‡å‘main()ï¼Œå°±ä¹Ÿå¯ä»¥æŠŠPCæŒ‡å‘ä»»ä½•ä¸€ä¸ªå‡½æ•°ï¼›è€Œå½“æˆ‘ä»¬æŒ‡å‘émain()å‡½æ•°çš„æ—¶å€™ï¼Œ<strong>çº¿ç¨‹ï¼ˆthreadï¼‰</strong>å°±è¯ç”Ÿäº†</p><p><img src="https://s2.loli.net/2023/04/14/resuH62xw1tSl5D.png"></p><p>â€‹é‚£ä¹ˆè¿›ä¸€æ­¥è§£æ”¾æ€æƒ³â€”â€”ä¸€ä¸ªè¿›ç¨‹å†…æœ‰å¤šä¸ªå…¥å£å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„æœºå™¨æŒ‡ä»¤å¯ä»¥è¢«å¤šä¸ªCPUåŒæ—¶æ‰§è¡Œï¼Œå³å¤šçº¿ç¨‹å¹¶å‘</p><div class="note note-warning">            <p>ğŸ’¡ PS.</p><ol><li>å¹¶ä¸æ˜¯ä¸€å®šå¾—æœ‰å¤šæ ¸æ‰èƒ½å¤šçº¿ç¨‹ï¼Œå•æ ¸åŒæ ·å¯ä»¥ï¼Œå› ä¸º<strong>çº¿ç¨‹æ˜¯OSå±‚é¢çš„å®ç°ï¼Œä¸æœ‰å¤šå°‘ä¸ªæ ¸å¿ƒæ— å…³</strong>ï¼ŒCPUåœ¨æ‰§è¡Œæœºå™¨æŒ‡ä»¤æ—¶ä¹Ÿæ„è¯†ä¸åˆ°æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤å±äºå“ªä¸ªçº¿ç¨‹</li><li>ä¸Šè¿°ç†è®ºä¹Ÿè¯´æ˜äº†ä¸ºå•¥OSè¦ç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªæ ˆï¼Œå› ä¸ºæ¯ä¸ªçº¿ç¨‹çš„æ‰§è¡Œæµéƒ½éœ€è¦ä¿å­˜è‡ªå·±æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°çš„æ•°æ®ï¼ˆå‚æ•°ã€å±€éƒ¨å˜é‡ã€è¿”å›åœ°å€ç­‰ï¼‰</li></ol>          </div><ol start="2"><li><p><strong>çº¿ç¨‹æ± </strong></p><p><strong>motivationï¼š</strong>å¯¹äºçŸ­ä»»åŠ¡ï¼ˆä¸€æ¬¡ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢ï¼‰ï¼Œè‹¥æ¥ä¸€ä¸ªè¯·æ±‚å°±åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œç”¨å®Œå†æ‘§æ¯ï¼Œåˆ™å³è€—æ—¶é—´åˆè´¹å†…å­˜ï¼›å¦‚æœä½ æ˜¯å…¬å¸è€æ¿ï¼Œå’Œâ€œæ¥ä¸€ä¸ªä»»åŠ¡æ‹›ä¸€ä¸ªäººâ€ç›¸æ¯”ï¼Œæ›´å¥½çš„åŠæ³•å½“ç„¶æ˜¯æ‹›ä¸€æ‰¹äººå…»ç€ï¼Œæœ‰äº‹åšäº‹ï¼Œæ²¡äº‹èººå°¸ï¼Œè¿™å°±æ˜¯<strong>çº¿ç¨‹æ± ï¼ˆthread poolï¼‰</strong>çš„ç”±æ¥</p><p><strong>åŸºæœ¬ç»“æ„ï¼š</strong>é˜Ÿåˆ—ç»“æ„ï¼Œç”Ÿäº§è€…æäº¤ä»»åŠ¡ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹ä»»åŠ¡</p><p><img src="https://s2.loli.net/2023/04/14/Ucm5pV8CeJkTzWo.png"></p><p>æäº¤ç»™çº¿ç¨‹æ± çš„ä»»åŠ¡åŒ…å«ä¸¤éƒ¨åˆ†ï¼šéœ€è¦è¢«å¤„ç†çš„æ•°æ®å’Œå¤„ç†æ•°æ®çš„å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">task</span> &#123;<br>   <span class="hljs-type">void</span>* data;     <span class="hljs-comment">// ä»»åŠ¡æ‰€æºå¸¦çš„æ•°æ®</span><br>   handler handle; <span class="hljs-comment">// å¤„ç†æ•°æ®çš„æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç”Ÿäº§è€…å‘é˜Ÿåˆ—ä¸­å†™å…¥æ•°æ®åï¼Œçº¿ç¨‹æ± ä¸­çš„æŸä¸ªçº¿ç¨‹ä¼šè¢«å”¤é†’ï¼Œè¯¥çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸Šè¿°ç»“æ„ä½“ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) &#123;<br> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">task</span> = <span class="hljs-built_in">GetFromQueue</span>(); <span class="hljs-comment">// ä»é˜Ÿåˆ—ä¸­å–å‡ºæ•°æ®</span><br> task-&gt;<span class="hljs-built_in">handle</span>(task-&gt;data);     <span class="hljs-comment">// å¤„ç†æ•°æ®</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>æ ¸æ•°ä¸çº¿ç¨‹æ•°çš„å…³ç³»</strong></p><p>ç»“è®ºï¼šæ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œä¸€ä¸ªæ ¸å¯æ‰§è¡Œå¤šä¸ªçº¿ç¨‹</p><p>Qï¼šé‚£ä¹ˆçº¿ç¨‹æ•°ä¸ºå¤šå°‘æ—¶æ€§èƒ½æœ€ä½³æï¼Ÿ</p><p>Aï¼šå¦‚æœçº¿ç¨‹ä¸æ¶‰åŠä»»ä½•I&#x2F;Oã€æ²¡æœ‰ä»»ä½•åŒæ­¥äº’æ–¥çš„çº¯è®¡ç®—ç±»å‹ï¼Œé‚£ä¹ˆæ¯ä¸ªæ ¸å¿ƒä¸€ä¸ªçº¿ç¨‹é€šå¸¸æ˜¯æœ€ä½³é€‰æ‹©ï¼›ä½†é€šå¸¸æ¥è¯´ï¼Œçº¿ç¨‹éƒ½éœ€è¦ä¸€å®šçš„I&#x2F;Oï¼Œå¯èƒ½éœ€è¦ä¸€å®šçš„åŒæ­¥äº’æ–¥ï¼Œé‚£ä¹ˆæ­¤æ—¶<strong>é€‚å½“å¢åŠ çº¿ç¨‹</strong>å¯èƒ½ä¼šæé«˜æ€§èƒ½ï¼Œä½†çº¿ç¨‹æ•°é‡è¾¾åˆ°ä¸€ä¸ª<strong>ä¸´ç•Œå€¼åæ€§èƒ½ä¼šå¼€å§‹ä¸‹é™</strong>ï¼Œè¿™æ—¶çº¿ç¨‹é—´åˆ‡æ¢çš„å¼€é”€å°†æ˜¾è‘—å¢åŠ ã€‚</p></li><li><p><strong>ä¸€æ®µå…¸å‹riscvä»£ç </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs nasm">#æ‰“å°ç¬¬nä¸ªæ–æ³¢é‚£å¥‘æ•°<br><br>.data<br>.word 2, 4, 6, 8<br>n: .word 9<br><br>.text<br>main:   <br>    add t0, x0, x0<br>    addi t1, x0, 1<br>    la t3, n <br>    lw t3, 0(t3)<br>fib:    <br>    beq t3, x0, finish<br>    add t2, t1, t0<br>    mv t0, t1<br>    mv t1, t2<br>    addi t3, t3, -1  <br>    j fib<br>finish: <br>    addi a0, x0, 1<br>    addi a1, t0, 0<br>    ecall # print integer ecall<br>    addi a0, x0, 10<br>    ecall # terminate ecall<br></code></pre></td></tr></table></figure><p>.dataå’Œ.textæ˜¯ä¼ªæ“ä½œæŒ‡ä»¤ï¼Œè¡¨ç¤ºå°†æ¥ä¸‹æ¥çš„ä»£ç åˆ†é…åˆ°dataåŒºå’ŒtextåŒºï¼Œ.wordè¡¨ç¤ºæŒ‰å­—ï¼ˆ32bitï¼‰åˆ†é…æ•°æ®ï¼Œå³dataåŒºçš„ç¬¬ä¸€ä¸ªwordæ”¾å…¥0x02ï¼ˆå¤šä½™çš„bitè¡¥é›¶ï¼‰ï¼Œç¬¬äºŒä¸ªwordæ”¾0x04è¿™æ ·å­ laè¡¨ç¤ºæŠŠnçš„åœ°å€ç»™åˆ°t3ï¼Œlwåˆ™æ˜¯æŠŠnçš„åœ°å€ä¸­å­˜çš„å€¼æ”¾å…¥t3ä¸­ï¼Œå³t3ä¸­çš„å€¼å˜ä¸º9ï¼Œlaå’Œlwé€šå¸¸é…å¥—ä½¿ç”¨ fibæ ‡ç­¾ä¸­çš„å†…å®¹å°±æ˜¯ä¸æ–­åˆ¤æ–­æ¯”è¾ƒç´¯åŠ å¾—æ–æ³¢é‚£å¥‘æ•°äº† æœ€åçš„ecallæ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œç”±å‚æ•°å†³å®šå…·ä½“è°ƒç”¨å†…å®¹ï¼Œa0å’Œa1éƒ½æ˜¯å‚æ•° (argument) å¯„å­˜å™¨ï¼Œç”¨äºåœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ä¿å­˜ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥åŠåœ¨å‡½æ•°è¿”å›æ—¶ä¼ é€’è¿”å›å€¼ã€‚ecall 1å°±æ˜¯printï¼Œecall 10å°±æ˜¯exit</p></li><li><p><strong>æµæ°´çº¿å¯„å­˜å™¨</strong></p><p><img src="https://s2.loli.net/2023/04/14/Iq4Qw7DaX9HbEoP.png"></p><p>æµæ°´çº¿çš„åŸºæœ¬åŸç†å¦‚æ­¤ï¼Œä¸Šé¢çš„ç¬”è®°ä¹Ÿæ¢è®¨è¿‡ï¼Œé‚£å…·ä½“åº”è¯¥æ€ä¹ˆå®ç°æï¼Ÿæˆ–è€…è¯´ï¼Œæ™®é€šçš„ä¸²è”ç»„åˆé€»è¾‘ç”µè·¯æ€ä¹ˆå°±ä¸èƒ½å®ç°pipelineæï¼Ÿ</p><p>å®ç°æ–¹æ³•ï¼šåŠ <strong>æµæ°´çº¿å¯„å­˜å™¨</strong>ã€‚å¦‚æˆ‘ä»¬èƒ½æŠŠæŒ‡ä»¤å­˜å‚¨å™¨è¾“å‡ºçš„æŒ‡ä»¤ç¼–ç äº‹å…ˆä¿å­˜ä¸‹æ¥ï¼Œé‚£å°±å¯ä»¥æå‰æ›´æ–°PCå¯„å­˜å™¨çš„å€¼ï¼Œå¹¶ç”¨è¿™æ–°çš„å€¼å»æŒ‡ä»¤å­˜å‚¨å™¨å½“ä¸­å–å‡ºä¸€ä¸ªæ–°çš„æŒ‡ä»¤ï¼Œè€Œåœ¨å–æ–°æŒ‡ä»¤çš„åŒæ—¶ï¼Œåˆšæ‰å–å‡ºçš„é‚£æ¡æŒ‡ä»¤çš„ç¼–ç å°±ä¼šè¢«åˆ†è§£æˆä¸åŒä½åŸŸï¼Œè€Œå¯„å­˜å™¨å †ä¹Ÿä¼šæ ¹æ®è¾“å…¥é€å‡ºå¯¹åº”å¯„å­˜å™¨çš„å†…å®¹ã€‚ç”±æ­¤å°±å®ç°äº†å„ä¸ªé˜¶æ®µåˆ†åˆ«è¿è¡Œï¼Œäº’ä¸å¹²æ‰°ã€‚</p><p> æ‰“ä¸ªæ¯”æ–¹ï¼Œå°å¿—å¹´è½»åŠ›å£®ï¼Œæ¬å¿«é€’æ—¶çŒ›å¾—ä¸€pï¼Œåé¢æ¥æ‰‹çš„è€å¸ˆå‚…è¯´å“å‘€æˆ‘è¦æ‘¸é±¼ï¼Œå¹´è½»äºº<strong>ä½ åªç®¡æ¬ä½ çš„åˆ«ç®¡æˆ‘ä»¬</strong>ï¼ˆæµæ°´çº¿æ€æƒ³ï¼‰ï¼Œä½ é€Ÿåº¦å¿«ï¼Œå¤šæ¬å‡ºæ¥çš„é‚£äº›<strong>æ”¾æ—è¾¹å°è½¦ä¸Šå°±å¥½ï¼Œå¾…ä¼šæˆ‘ç›´æ¥ä»å°è½¦ä¸Šå–å°±è¡Œ</strong>ï¼ˆå°è½¦å°±æ˜¯æµæ°´çº¿å¯„å­˜å™¨ï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/fQLhHwrpKyxuIki.png" alt="Untitled"></p><p>æ€§èƒ½åˆ†æï¼Œä¸ä¹‹å‰çš„æµæ°´çº¿ç›¸æ¯”ï¼Œå¤šäº†æµæ°´çº¿å¯„å­˜å™¨çš„å»¶è¿Ÿï¼Œå‘¨æœŸ200åˆ°250ps</p><p><img src="https://s2.loli.net/2023/04/14/QAwatYbL73v1Exj.png"></p><p>è€Œè‡³äºä¸ºä»€ä¹ˆä¸åŠ å¯„å­˜å™¨å°±ä¸èƒ½å®ç°æµæ°´çº¿ï¼Œæˆ‘æƒ³åº”è§£é‡Šä¸ºå„éƒ¨åˆ†æ—¶å»¶ä¸åŒ¹é…é€ æˆçš„<strong>çº¿è·¯ä¿¡å·å†²çª</strong>ï¼Œå³å¦‚æœåé¢éƒ¨åˆ†è¿˜æ²¡æ‰§è¡Œå®Œï¼ŒIFå°±åœ¨ä¸€ç›´å­å“§å­å“§å–æŒ‡ï¼Œé‚£ä¹ˆå–å‡ºæ¥çš„instruction wordæƒ³å¿…ä¸ä¼šè¢«IDæ¥å—ï¼Œä¹Ÿå°±æˆäº†æ— æ•ˆè¾“å…¥</p></li><li><p>cache<strong>å‘½ä¸­æ—¶</strong>ï¼Œç­–ç•¥ä¸ºå›å†™ï¼ˆwrite backï¼‰å’Œç›´å†™ï¼ˆwrite throughï¼‰ï¼› <strong>æœªå‘½ä¸­æ—¶</strong>ï¼Œç­–ç•¥ä¸ºå†™åˆ†é…ï¼ˆwrite-allocateï¼‰å’Œæ— å†™åˆ†é…ï¼ˆno write-allocateï¼‰ï¼Œå†™åˆ†é…è¡¨ç¤ºå‘ç”Ÿwrite missæ—¶ï¼ŒæŠŠæ²¡å‘½ä¸­çš„é‚£ä¸ªå—æ”¾åˆ°cacheä¸­ï¼Œè€Œæ— å†™åˆ†é…åˆ™æ„å‘³ç€åªæ”¹memory é€šå¸¸ï¼Œwrite backå’Œwrite-allocateæ­é…ä½¿ç”¨ï¼Œè¿™æ ·çš„memoryæ°¸è¿œä¸ä¼šè¢«ç›´æ¥ä¿®æ”¹ï¼›write throughå’Œno write-allocateæ­é…</p></li><li><p><strong>ç”¨æŒ‡é’ˆéç©ºåˆ¤æ–­æ•°ç»„è¾¹ç•Œï¼Ÿ</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span> </span>&#123;<br>    <span class="hljs-type">int</span> array[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span> , <span class="hljs-number">5</span>, <span class="hljs-number">7</span>&#125;;<br>    <span class="hljs-type">int</span>* ptr = array;<br><br>    <span class="hljs-keyword">while</span>(ptr != <span class="hljs-literal">NULL</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\\n&quot;</span>, *ptr);<br>        ptr += <span class="hljs-number">1</span>;<br>    &#125; <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p> <img src="https://s2.loli.net/2023/04/14/oJjaIEqM2rtQDcX.png"></p><p> è¾“å‡ºç»“æœç›¸å½“ç‚¸è£‚ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆæï¼Ÿ</p><p> å› ä¸º<strong>ç”¨æŒ‡é’ˆéç©ºåˆ¤æ–­æ•°ç»„è¾¹ç•Œæœ¬å°±æ˜¯é”™çš„ï¼æ•°ç»„å¤§å°ä¸º4ä¸ä»£è¡¨ç¬¬äº”ä¸ªå†…å­˜ç©ºé—´å°±æ²¡æœ‰å…¶å®ƒä¸œè¥¿äº†å•Šï¼</strong>ï¼ˆä¸‹é¢è¿™æ®µä»£ç ä¹Ÿå¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä¸¤ä¸ªæ•°ç»„åˆ†åˆ«ç”³è¯·ï¼Œä½†å†…å­˜ä½ç½®æ˜¯è¿ç»­çš„ï¼‰</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-built_in">array</span>[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span> , <span class="hljs-number">5</span>, <span class="hljs-number">7</span>&#125;;<br>    <span class="hljs-type">int</span> array2[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">9</span>, <span class="hljs-number">10</span> , <span class="hljs-number">11</span>, <span class="hljs-number">12</span>&#125;;<br>    <span class="hljs-type">int</span>* ptr = <span class="hljs-built_in">array</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\\n&quot;</span>, *ptr);<br>        ptr += <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p> <img src="https://s2.loli.net/2023/04/14/8xdBXH6YoyEjtD7.png"></p><p> ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆCè¯­è¨€ä¸­åå¤å¼ºè°ƒï¼Œä¼ æ•°ç»„æŒ‡é’ˆæ—¶ï¼Œä¹Ÿå¿…é¡»æ˜¾å¼åœ°å°†æ•°ç»„é•¿åº¦ä¼ è¿›å»ï¼›å…‰é€šè¿‡ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆæ˜¯æ²¡åŠæ³•è·å–æ•°ç»„é•¿åº¦çš„ï¼ï¼ˆcharæ•°ç»„ç”¨strlen()é™¤å¤–ï¼‰ è€Œè‡³äºä¸ºå•¥åœ¨è¿‡å»çš„ä»£ç ä¸­å¥½åƒç”¨è¿‡â€œæŒ‡é’ˆéç©ºâ€æ¥åˆ¤æ–­è¾¹ç•Œå‘¢ã€‚ã€‚æ˜¯å› ä¸ºä½¿ç”¨åœºæ™¯æ˜¯é“¾è¡¨ï¼Œé“¾è¡¨åˆå§‹åŒ–å°±æŠŠnextæŒ‡é’ˆè®¾ä¸ºnullpträº†ï¼›è€Œåƒvectorçš„è¾¹ç•Œåˆ¤æ–­ï¼Œé‚£ä¹Ÿæ˜¯ç”¨çš„vector.end()ï¼Œæ˜¯ä¸ªè¿­ä»£å™¨ï¼Œè€Œä¸æ˜¯æ™®é€šçš„ä¸€ä¸ªnullptrã€‚ã€‚</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>æ ¸å¿ƒç§‘æŠ€çœ‹ç¾å¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä½“ç³»ç»“æ„</tag>
      
      <tag>riscv</tag>
      
      <tag>æ“ä½œç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ä¸ªå…¸å‹çš„cacheå·¥ä½œåŸç†æ¼”ç¤ºå®éªŒ</title>
    <link href="/2023/04/14/%E4%B8%80%E4%B8%AA%E5%85%B8%E5%9E%8B%E7%9A%84cache%E6%BC%94%E7%A4%BA%E5%AE%9E%E9%AA%8C/"/>
    <url>/2023/04/14/%E4%B8%80%E4%B8%AA%E5%85%B8%E5%9E%8B%E7%9A%84cache%E6%BC%94%E7%A4%BA%E5%AE%9E%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>å‰è¨€ï¼šæœ¬æ–‡ç« å°†åœ¨å¯è§†åŒ–ç¯å¢ƒä¸‹å¯¹cacheå·¥ä½œåŸç†è¿›è¡Œæ¼”ç¤ºå®éªŒï¼Œé€šè¿‡ä¸‹é¢ä¸‰ä¸ªå®éªŒï¼Œè¯»è€…åº”èƒ½ï¼š</p><ol><li>ç†è§£cacheä¸‰ç§è®¿é—®æ¨¡å¼ï¼ˆç›´è¿ã€ä¸¤è·¯ç›¸è¿ã€å…¨è¿ï¼‰çš„å·¥ä½œåŸç†ï¼›</li><li>å­¦ä¼šè®¡ç®—å‘½ä¸­ç‡ï¼ˆhit rateï¼‰ï¼Œå¹¶ç†è§£å„ä¸ªå‚æ•°ï¼ˆå¾ªç¯æ¬¡æ•°ã€æ­¥é•¿ã€cache sizeç­‰ï¼‰å¦‚ä½•å½±å“hit rateï¼›</li><li>ç†è§£ä¸åŒçš„cacheç­–ç•¥ï¼ˆå›å†™ã€ç›´å†™ã€LRUï¼‰å¯¹hit rateçš„å½±å“ï¼›</li><li>çŸ¥é“å¦‚ä½•ä¼˜åŒ–ä»£ç ï¼Œä»¥å®ç°æ›´é«˜çš„hit rate</li></ol><p>å®éªŒæ¥æºï¼š<a href="https://inst.eecs.berkeley.edu/~cs61c/su20/labs/lab07/">CS61Cï¼ˆ20-SUMMERï¼‰- lab 7</a></p><p>å¯è§†åŒ–å¹³å°ï¼š<a href="https://venus.cs61c.org/">venus</a></p>          </div><div class="note note-warning">            <p>PS. å®Œæ•´çš„é¢˜ç›®å’Œæè¿°è¯·å‚è€ƒ<a href="https://inst.eecs.berkeley.edu/~cs61c/su20/labs/lab07/">CS61Cï¼ˆ20-SUMMERï¼‰- lab 7</a>ï¼ä¸‹è¿°æ‰€æœ‰åˆ†æä»…ç›¸å½“äºæ˜¯å®éªŒç­”æ¡ˆï¼Œå¯¹é¢˜ç›®æœ¬èº«ä¸å†èµ˜è¿°ğŸ˜ª</p>          </div><p><strong>æ±‡ç¼–å¯¹åº”çš„Cä»£ç ï¼š</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">int</span> array[];  <span class="hljs-comment">//Assume sizeof(int) == 4</span><br><span class="hljs-keyword">for</span> (k = <span class="hljs-number">0</span>; k &lt; repcount; k++) &#123;<span class="hljs-comment">// repeat repcount times</span><br>  <span class="hljs-keyword">for</span> (index = <span class="hljs-number">0</span>; index &lt; arraysize; index += stepsize) &#123;<br>    <span class="hljs-keyword">if</span>(option==<span class="hljs-number">0</span>)<br>      array[index] = <span class="hljs-number">0</span>;<span class="hljs-comment">// Option 0: One cache access - write</span><br>    <span class="hljs-keyword">else</span><br>      array[index] = array[index] + <span class="hljs-number">1</span>;<br><span class="hljs-comment">// Option 1: Two cache accesses - read AND write</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>å®éªŒä¸€ï¼šç›´æ¥æ˜ å°„</strong></p><p>å‚æ•°è®¾ç½®ä¸ºï¼š</p><ul><li>Array Size (a0): 128 (bytes)ï¼Œå³32ä¸ªint</li><li>Step Size (a1): 8</li><li>Rep Count (a2): 1</li><li>Option (a3): 0</li><li>cache lineè®¾ä¸º8byteï¼Œå…±4ä¸ªline</li><li>ç­–ç•¥ä¸ºdirect map + LRU</li></ul><p>æ‰‹åŠ¨åˆ†æï¼Œä¸€æ¬¡forå¾ªç¯ä¸­ï¼Œè¦è®¿é—®array[0ã€8ã€16ã€24]è¿™4ä¸ªå…ƒç´ ï¼Œè®¿é—®array[0]æ—¶ï¼Œcache missï¼ˆæ­¤æ—¶cacheä¸­è¿˜æ²¡ä¸œè¥¿ï¼‰ï¼Œäºæ˜¯ä»memoryä¸­æŠŠarray[0ã€1]éƒ½æ”¾è¿›æ¥ï¼›ä½†ä¸‹ä¸€æ¬¡è®¿é—®array[8]æ—¶ä»ç„¶ä¼šmissï¼Œè¿™ä¹ˆä¸€è·¯ä¸‹æ¥cache accessä¸º4ï¼Œhit rateä¸º0</p><p><img src="https://s2.loli.net/2023/04/14/WzSZARV1gETyI5C.png"></p><p>ç»éªŒè¯ç¡®å®å¦‚æ­¤ï¼Œæ³¨æ„ä¸ºå•¥åªåœ¨cache0ä¸Šæ“ä½œæï¼Ÿ</p><p><img src="https://s2.loli.net/2023/04/14/lY2BUCygoJn4qvG.jpg"></p><p>çœ‹å›¾å°±æ¸…æ¥šäº†ï¼šindex 2bitï¼Œoffset 3bitã€‚è®¿é—®çš„æ˜¯array[0ã€8ã€16ã€24]è¿™å‡ ä¸ªå…ƒç´ ï¼Œåœ°å€ä¸º0ã€32ã€64ã€96ï¼Œå…¶äºŒè¿›åˆ¶çš„indexä¸€æ ·çš„ï¼Œéƒ½æ˜¯å¯¹åº”line0</p><p>é‚£ä¹ˆåŒç†ï¼Œæˆ‘ä»¬æŠŠstepsizeæ”¹æˆ4ã€2ï¼Œhit rateå§‹ç»ˆéƒ½æ˜¯0;</p><p>æ”¹æˆ1åˆ™hit rate&#x3D;50%</p><p><img src="https://s2.loli.net/2023/04/14/LqTQDVnlOGaXjrc.png" alt="Untitled"></p><p><strong>å®éªŒäºŒï¼š4è·¯æ˜ å°„</strong></p><p>å‚æ•°è®¾ç½®ä¸ºï¼š</p><ul><li>Array Size (a0): 256(bytes)ï¼Œå³64ä¸ªint</li><li>Step Size (a1): 2</li><li>Rep Count (a2): 1</li><li>Option (a3): 1</li><li>cache lineè®¾ä¸º16byteï¼Œå…±16ä¸ªline</li><li>ç­–ç•¥ä¸º4 way set associative + LRU</li></ul><p><img src="https://s2.loli.net/2023/04/14/Daexf5wv9JUN3jp.jpg"></p><p>æ‰‹åŠ¨åˆ†æhit rate &#x3D; 0.75ï¼Œç»éªŒè¯ç¡®å®å¦‚æ­¤</p><p><img src="https://s2.loli.net/2023/04/14/s9TJvIlmoUVYHQX.png"></p><p>è¿›ä¸€æ­¥æ€è€ƒï¼šé‚£æŠŠrepcountè®¾ä¸º2ï¼Œhit rateè¿˜æ˜¯0.75å—ï¼Ÿ</p><p>æ˜¾ç„¶ä¸æ˜¯ï¼Œå› ä¸ºç¬¬ä¸€éforæŠŠæ‰€æœ‰cache lineéƒ½å¡«æ»¡äº†ï¼ˆæ•´ä¸ªarray[]æ­£å¥½å…¨è£…è¿›å»äº†ï¼ï¼‰ï¼Œæ‰€ä»¥åç»­æ¯æ¬¡cache accesséƒ½ä¼šå‘½ä¸­ï¼›hit rate &#x3D; ï¼ˆ48+64ï¼‰&#x2F;ï¼ˆ2*64ï¼‰ &#x3D; 0.875</p><p><img src="https://s2.loli.net/2023/04/14/5vKhocQJH1t3V7u.png"></p><p>repcountè®¾ä¸º100æ—¶ï¼Œhit rateå°±å¾ˆæ¥è¿‘äº100%äº†ï¼ˆè¿™å…¶å®ä¹Ÿæ˜¯æ˜ è¯äº†cacheçš„åŸºæœ¬åŸç†ï¼Œæ—¶ç©ºå±€éƒ¨æ€§ï¼Œå³æ•°æ®é‡å¤åº¦è¶Šé«˜ï¼Œcacheè¶Šç®¡ç”¨ï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/S9wBezDrEpVi1vf.png"></p><p><strong>å®éªŒä¸‰ï¼šä¸¤çº§cache</strong></p><p>å‚æ•°è®¾ç½®ä¸ºï¼š</p><ul><li>Array Size (a0): 128(bytes)ï¼Œå³32ä¸ªint</li><li>Step Size (a1): 1</li><li>Rep Count (a2): 1</li><li>Option (a3): 0</li></ul><p>L1 cacheï¼š</p><ul><li>cache lineè®¾ä¸º8byteï¼Œå…±8ä¸ªline</li><li>ç­–ç•¥ä¸ºdirect map + LRU</li></ul><p>L2 cacheï¼š</p><ul><li>cache lineè®¾ä¸º8byteï¼Œå…±16ä¸ªline</li><li>ç­–ç•¥ä¸ºdirect map + LRU</li></ul><p><img src="https://s2.loli.net/2023/04/14/5DNjmzHWGcyhRis.png"></p><p><img src="https://s2.loli.net/2023/04/14/zygfL8HXFeiOMuk.png"></p><p><strong>è§£é‡Šï¼š</strong></p><p>L1 hit rate 50%ä¸è§£é‡Šï¼ŒåŒå®éªŒä¸€ï¼›</p><p>L2ä¸ºå•¥æ˜¯0%æï¼Ÿ å…¶å®æƒ³æƒ³é‚£ä¸ªè¿‡ç¨‹å°±æ¸…æ¥šäº†ï¼šæ‰¾array[0]çš„æ—¶å€™ï¼ŒL1ã€L2éƒ½missï¼Œç„¶åä»memoryä¸­æŠŠarray[0ã€1]æ‹¿å‡ºæ¥ï¼Œæ¥ä¸‹æ¥è®¿é—®array[1]çš„æ—¶å€™åœ¨L1é‡Œå°±ç›´æ¥æ‰¾åˆ°äº†ï¼Œæ ¹æœ¬ä¸ä¼šå»è®¿é—®L2ï¼Œæ‰€ä»¥L2ä¸€å…±ä¹Ÿå°±ä¼šè®¿é—®16æ¬¡ï¼Œæ¬¡æ¬¡miss</p><p><strong>Qï¼š</strong>æ”¹å˜å“ªä¸ªå‚æ•°ä¼šè®©L1å‘½ä¸­ç‡ä¸å˜ä¸”L2å‘½ä¸­ç‡å¢åŠ ï¼Ÿ</p><p><strong>Aï¼š</strong>rep countã€‚å› ä¸ºå¢åŠ foré‡å¤æ¬¡æ•°æ—¶ï¼ŒL1ä¸­å§‹ç»ˆåªè£…äº†ä¸€åŠçš„arrayï¼Œæ°¸è¿œéƒ½æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ missã€ç¬¬äºŒä¸ªhitï¼›è€ŒL2 cache sizeä¸º128bytesï¼Œåˆšå¥½èƒ½æŠŠæ•´ä¸ªæ•°ç»„è£…ä¸‹ï¼Œæ‰€ä»¥rep countè¶Šå¤§ï¼ŒL2çš„hit rateè¶Šæ¥è¿‘äº100%<br>$$</p><p>$$</p>]]></content>
    
    
    <categories>
      
      <category>è‡ªå·±äº‹æƒ…é è‡ªå·±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä½“ç³»ç»“æ„</tag>
      
      <tag>cache</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ€ä¼˜åŒ–è®¡ç®—æ–¹æ³•ï¼ˆæ–‡å†æ–‡ï¼‰ç¬”è®°</title>
    <link href="/2023/04/13/%E3%80%8A%E6%9C%80%E4%BC%98%E5%8C%96%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%EF%BC%88%E6%96%87%E5%86%8D%E6%96%87%EF%BC%89%E7%AC%94%E8%AE%B0%E3%80%8B/"/>
    <url>/2023/04/13/%E3%80%8A%E6%9C%80%E4%BC%98%E5%8C%96%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%EF%BC%88%E6%96%87%E5%86%8D%E6%96%87%EF%BC%89%E7%AC%94%E8%AE%B0%E3%80%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€Šæœ€ä¼˜åŒ–è®¡ç®—æ–¹æ³•ï¼ˆæ–‡å†æ–‡ï¼‰ç¬”è®°ã€‹"><a href="#ã€Šæœ€ä¼˜åŒ–è®¡ç®—æ–¹æ³•ï¼ˆæ–‡å†æ–‡ï¼‰ç¬”è®°ã€‹" class="headerlink" title="ã€Šæœ€ä¼˜åŒ–è®¡ç®—æ–¹æ³•ï¼ˆæ–‡å†æ–‡ï¼‰ç¬”è®°ã€‹"></a>ã€Šæœ€ä¼˜åŒ–è®¡ç®—æ–¹æ³•ï¼ˆæ–‡å†æ–‡ï¼‰ç¬”è®°ã€‹</h1><h1 id="ç¬¬ä¸€ç« ã€æœ€ä¼˜åŒ–ç®€ä»‹"><a href="#ç¬¬ä¸€ç« ã€æœ€ä¼˜åŒ–ç®€ä»‹" class="headerlink" title="ç¬¬ä¸€ç« ã€æœ€ä¼˜åŒ–ç®€ä»‹"></a>ç¬¬ä¸€ç« ã€æœ€ä¼˜åŒ–ç®€ä»‹</h1><h3 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h3><ol><li><p><strong>æœ€ä¼˜åŒ–é—®é¢˜ä¸€èˆ¬å½¢å¼ï¼š</strong></p><p><img src="https://s2.loli.net/2023/04/14/wazjU2bHxYqCuVs.png"></p><p>å…¶ä¸­$x&#x3D;(x_1,x_2,â€¦,x_n)^T\in R^n$æ˜¯<strong>å†³ç­–å˜é‡</strong></p><p>$f:R^n\rightarrow R$æ˜¯<strong>ç›®æ ‡å‡½æ•°</strong></p><p>$\chi\in R^n$æ˜¯çº¦æŸé›†åˆï¼Œå³<strong>å¯è¡ŒåŸŸ</strong></p><p>s.t.æ˜¯subject toï¼Œä¸“æŒ‡<strong>çº¦æŸæ¡ä»¶</strong></p><p>ä½†f(x)çš„min&#x2F;maxä¸æ€»æ˜¯å­˜åœ¨çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬å…³å¿ƒå…¶ä¸Šä¸‹ç¡®ç•Œï¼Œå³å°†ä¸Šå¼æ”¹ä¸ºinf(sup) f(x)</p></li><li><p><strong>æœ€ä¼˜åŒ–é—®é¢˜åˆ†ç±»</strong></p><ul><li>ç›®æ ‡å‡½æ•°å’Œçº¦æŸå‡½æ•°çš†ä¸ºçº¿æ€§æ—¶ï¼Œç§°ä¸ºçº¿æ€§è§„åˆ’</li><li>è‡³å°‘æœ‰ä¸€ä¸ªéçº¿æ€§æ—¶ç§°ä¸ºéçº¿æ€§è§„åˆ’</li><li>ç›®æ ‡å‡½æ•°ä¸ºäºŒæ¬¡å‡½æ•°æ—¶ç§°ä¸ºäºŒæ¬¡è§„åˆ’</li><li>è¿˜æœ‰æ•´æ•°è§„åˆ’ã€éå…‰æ»‘è§„åˆ’ã€æ— å¯¼æ•°è§„åˆ’ç­‰ã€‚ã€‚</li></ul></li><li><p><strong>å‡¸ä¼˜åŒ–</strong></p><p>å®šä¹‰ï¼šæœ€å°åŒ–é—®é¢˜ä¸­ï¼Œç›®æ ‡å‡½æ•°å’Œå¯è¡ŒåŸŸåˆ†åˆ«æ˜¯å‡¸å‡½æ•°å’Œå‡¸é›†ï¼›ç›¸åï¼Œåªè¦æœ‰ä¸€ä¸ªä¸ä¸ºå‡¸ï¼Œåˆ™ä¸ºéå‡¸ä¼˜åŒ–é—®é¢˜ã€‚å› ä¸ºå‡¸ä¼˜åŒ–é—®é¢˜çš„ä»»ä½•å±€éƒ¨æœ€ä¼˜è§£éƒ½æ˜¯å…¨å±€æœ€ä¼˜è§£ï¼Œæ‰€ä»¥å…¶ç›¸åº”çš„ç®—æ³•è®¾è®¡ä»¥åŠç†è®ºåˆ†æç›¸å¯¹éå‡¸ä¼˜åŒ–é—®é¢˜ç®€å•å¾ˆå¤šã€‚</p><aside> ğŸ’¡ PS. æ‰€ä»¥ç”¨å‡¸æ¨¡å‹å¯¹éå‡¸é—®é¢˜è¿›è¡Œè½¬æ¢/é€¼è¿‘æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ‰‹æ®µ</li></ol><h1 id="ç¬¬äºŒç« ã€åŸºç¡€çŸ¥è¯†"><a href="#ç¬¬äºŒç« ã€åŸºç¡€çŸ¥è¯†" class="headerlink" title="ç¬¬äºŒç« ã€åŸºç¡€çŸ¥è¯†"></a>ç¬¬äºŒç« ã€åŸºç¡€çŸ¥è¯†</h1><h3 id="ä¸€ã€æ¦‚è¿°-1"><a href="#ä¸€ã€æ¦‚è¿°-1" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h3><ol><li><p><strong>çŸ©é˜µèŒƒæ•°</strong></p><p>å½“p&#x3D;1æ—¶ï¼ŒçŸ©é˜µ$A\in R^{mÃ—n}$çš„$l_1$èŒƒæ•°å®šä¹‰ä¸ºï¼š<br>$$<br>\lVert A \rVert_1&#x3D;\sum_{i&#x3D;1}^m\sum_{j&#x3D;1}^n\vert a_{ij} \vert<br>$$<br>p&#x3D;2æ—¶ï¼š<br>$$<br>\lVert A \rVert_2&#x3D;\sqrt{Tr(AA^T)}&#x3D;\sqrt{\sum_{i,j}a_{ij}^2}<br>$$<br>Tr(X)è¡¨ç¤ºæ–¹é˜µçš„è¿¹ï¼Œå³æ–¹é˜µçš„ä¸»å¯¹è§’çº¿çš„å…ƒç´ ä¹‹å’Œ</p><div class="note note-warning">            <p>ğŸ’¡ PS. ä¸€ä¸ªç»“è®ºï¼š çŸ©é˜µçš„2èŒƒæ•°æ˜¯è¯¥çŸ©é˜µçš„æœ€å¤§å¥‡å¼‚å€¼ï¼ˆwhyï¼Ÿï¼‰</p>          </div></li><li><p><strong>æµ·ç‘ŸçŸ©é˜µ</strong></p><p><img src="https://s2.loli.net/2023/04/14/BECN3juMKan6xLo.png"></p></li><li><p><strong>çŸ©é˜µå˜é‡å‡½æ•°çš„å¯¼æ•°</strong></p><p><img src="https://s2.loli.net/2023/04/14/hzEMxDuX9WcHiyt.png"></p><p><img src="https://s2.loli.net/2023/04/14/219YjdlZ5aShr3x.png"></p></li><li><p><strong>å‡¸é›†</strong></p><p>å¦‚æœè¿æ¥é›†åˆCä¸­ä»»æ„ä¸¤ç‚¹çš„çº¿æ®µéƒ½åœ¨Cå†…ï¼Œåˆ™ç§°Cä¸ºå‡¸é›†</p><p><img src="https://s2.loli.net/2023/04/14/bRu7fcMCqldoD6W.png"></p></li><li><p><strong>å‡¸åŒ…</strong></p><p>å¯¹äºå½¢å¦‚</p><p><img src="https://s2.loli.net/2023/04/14/HZlsb1pIMCx6Gwc.png"></p><p>çš„ç‚¹ç§°ä¸ºx1ã€x2ã€‚ã€‚ã€‚xkæ„æˆçš„<strong>å‡¸ç»„åˆ</strong>ï¼Œé›†åˆSä¸­ç‚¹æ‰€æœ‰å¯èƒ½çš„å‡¸ç»„åˆæ„æˆçš„é›†åˆç§°ä½œSçš„<strong>å‡¸åŒ…</strong>ï¼Œè®°ä½œ<strong>convS</strong>ï¼å®é™…ä¸Šï¼Œ<strong>convS</strong>æ˜¯åŒ…å«Sçš„æœ€å°çš„å‡¸é›†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ†åˆ«ä¸ºç¦»æ•£ç‚¹é›†çš„å‡¸åŒ…å’Œæ‰‡å½¢çš„å‡¸åŒ…ã€‚</p><p><img src="https://s2.loli.net/2023/04/14/luNXMaWSRO12Ko4.png"></p></li><li><p><strong>ä¸€äº›é‡è¦çš„å‡¸é›†</strong></p><ul><li>è¶…å¹³é¢å’ŒåŠç©ºé—´</li></ul><p><img src="https://s2.loli.net/2023/04/14/xw7VaQyXfHuZlbA.png"></p><ul><li>çƒã€æ¤­çƒã€æ¤</li></ul><p>å¸¸è§„çš„çƒã€æ¤­çƒã€æ¤çš„å®šä¹‰ç”¨çš„æ˜¯æ¬§å‡ é‡Œå¾—èŒƒæ•°ï¼Œä½†å¯ç”¨å…¶å®ƒèŒƒæ•°è¿›è¡Œæ¦‚å¿µæ¨å¹¿</p><p>å¤šé¢ä½“</p><ul><li>ï¼ˆåŠï¼‰æ­£å®šæ¤</li></ul><p><img src="https://s2.loli.net/2023/04/14/DEHSgQ6AaeNpC5w.png"></p></li><li><p><strong>å¼ºå‡¸å‡½æ•°</strong></p><p><img src="https://s2.loli.net/2023/04/14/Aoa2UdNbKrw7chf.png" alt="Untitled"></p><p>å¼ºå‡¸å‡½æ•°å‡å»ä¸€ä¸ªæ­£å®šäºŒæ¬¡å‡½æ•°ä»ç„¶æ˜¯å‡¸çš„ã€‚å’Œæ™®é€šå‡¸å‡½æ•°ç›¸æ¯”ï¼Œå¼ºå‡¸å‡½æ•°æœ‰æ›´å¥½çš„æ€§è´¨ã€‚</p><div class="note note-warning">            <p>ğŸ’¡ PS. ç»“è®ºï¼šè®¾ <em>f</em> ä¸ºå¼ºå‡¸å‡½æ•°ä¸”å­˜åœ¨æœ€å°å€¼ï¼Œåˆ™ <em>f</em> çš„æœ€å°å€¼ç‚¹å”¯ä¸€   </p>          </div></li></ol><h1 id="ç¬¬ä¸‰ç« ã€å…¸å‹ä¼˜åŒ–é—®é¢˜"><a href="#ç¬¬ä¸‰ç« ã€å…¸å‹ä¼˜åŒ–é—®é¢˜" class="headerlink" title="ç¬¬ä¸‰ç« ã€å…¸å‹ä¼˜åŒ–é—®é¢˜"></a>ç¬¬ä¸‰ç« ã€å…¸å‹ä¼˜åŒ–é—®é¢˜</h1><h3 id="ä¸€ã€çº¿æ€§è§„åˆ’"><a href="#ä¸€ã€çº¿æ€§è§„åˆ’" class="headerlink" title="ä¸€ã€çº¿æ€§è§„åˆ’"></a>ä¸€ã€çº¿æ€§è§„åˆ’</h3><ol><li><p>ä¸€èˆ¬å½¢å¼</p><p><img src="https://s2.loli.net/2023/04/14/RwBQujfqc4stJIK.png"></p><p>å¸¸è§çš„ä¸¤ç§å½¢å¼ï¼šæ ‡å‡†å‹ï¼ˆç­‰å¼çº¦æŸ+å†³ç­–å˜é‡éè´Ÿï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/WXe3PD5Oc1faYjN.png"></p><p>ä¸ç­‰å¼å½¢ï¼ˆæ²¡æœ‰ç­‰å¼çº¦æŸï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/f1jFugUqNXJ3PYc.png"></p></li></ol><h1 id="ç¬¬å››ç« ã€æ— çº¦æŸä¼˜åŒ–ç®—æ³•"><a href="#ç¬¬å››ç« ã€æ— çº¦æŸä¼˜åŒ–ç®—æ³•" class="headerlink" title="ç¬¬å››ç« ã€æ— çº¦æŸä¼˜åŒ–ç®—æ³•"></a>ç¬¬å››ç« ã€æ— çº¦æŸä¼˜åŒ–ç®—æ³•</h1><h3 id="ä¸€ã€çº¿æœç´¢æ–¹æ³•"><a href="#ä¸€ã€çº¿æœç´¢æ–¹æ³•" class="headerlink" title="ä¸€ã€çº¿æœç´¢æ–¹æ³•"></a>ä¸€ã€çº¿æœç´¢æ–¹æ³•</h3><p>ç»™å®šå½“å‰è¿­ä»£ç‚¹xkï¼Œé¦–å…ˆé€šè¿‡æŸç§ç®—æ³•é€‰å–å‘é‡dkï¼Œä¹‹åç¡®å®šæ­£æ•°Î±kï¼Œåˆ™ä¸‹ä¸€æ­¥çš„è¿­ä»£ç‚¹å¯å†™ä½œ<br>$$<br>x^{k+1}&#x3D;x^k+\alpha_kd^k<br>$$<br>å…¶ä¸­dkæ˜¯æœç´¢æ–¹å‘ï¼ŒÎ±kæ˜¯æ­¥é•¿ï¼Œçº¿æœç´¢ç®—æ³•çš„å…³é”®å°±æ˜¯é€‰å–å¥½çš„dkå’ŒÎ±kï¼Œä¸ºäº†é€‰å‡ºåˆé€‚çš„æ­¥é•¿Î±kï¼Œæˆ‘ä»¬è¦å¼•å…¥ä¸€å®šçš„è¦æ±‚ï¼Œç§°ä¹‹ä¸º<strong>çº¿æœç´¢å‡†åˆ™</strong>ï¼Œå¸¸è§çš„æœ‰Armijoå‡†åˆ™ã€Goldsteinå‡†åˆ™ã€Wolfeå‡†åˆ™ç­‰</p><p>å…¶ä¸­ï¼Œç”¨äºæ»¡è¶³Armijoå‡†åˆ™çš„å¸¸ç”¨æ–¹æ³•æ˜¯<strong>å›é€€æ³•</strong>ï¼Œå…¶åŸºæœ¬æ€æƒ³ä¸ºç”±å¤§åˆ°å°ä¸æ–­è¯•éªŒÎ±ï¼Œç›´è‡³è¾“å‡ºä¸€ä¸ªæ»¡è¶³Armijoå‡†åˆ™ä¸”å°½å¯èƒ½å¤§çš„æ­¥é•¿</p><p><img src="https://s2.loli.net/2023/04/14/87Lrs5XoR4M9ObN.png"></p><h3 id="äºŒã€æ¢¯åº¦ç±»ç®—æ³•"><a href="#äºŒã€æ¢¯åº¦ç±»ç®—æ³•" class="headerlink" title="äºŒã€æ¢¯åº¦ç±»ç®—æ³•"></a>äºŒã€æ¢¯åº¦ç±»ç®—æ³•</h3><ol><li><p><strong>æ¢¯åº¦ä¸‹é™æ³•</strong></p><p>$$ x^{k+1}&#x3D;x^k-\alpha_k\nabla f(x^k) $$</p></li><li><p><strong>BBç®—æ³•ï¼ˆBarzilai-Borweinï¼‰</strong></p><p>$$ x^{k+1}&#x3D;x^k-\alpha_{BB1}^K\nabla f(x^k) $$</p><p>$$ x^{k+1}&#x3D;x^k-\alpha_{BB2}^K\nabla f(x^k) $$</p><p>å…¶ä¸­</p><p><img src="https://s2.loli.net/2023/04/14/PmaeTIGiWnXb1YH.png"></p><p><img src="https://s2.loli.net/2023/04/14/6chSM21efDy8BY7.png"></p><p>ç”±ä¸Šå¼å¯è§ï¼ŒBBç®—æ³•ä»…éœ€è¦çŸ¥é“å‡½æ•°ç›¸é‚»ä¸¤æ­¥çš„æ¢¯åº¦ä¿¡æ¯å’Œè¿­ä»£ç‚¹ä¿¡æ¯ï¼Œæ‰€ä»¥BBç®—æ³•çš„åº”ç”¨èŒƒå›´å¾ˆå¹¿æ³›</p><p><img src="https://s2.loli.net/2023/04/14/q1dE8OU5Pr9zgGJ.png"></p></li></ol><h3 id="ä¸‰ã€æ¬¡æ¢¯åº¦ç®—æ³•"><a href="#ä¸‰ã€æ¬¡æ¢¯åº¦ç®—æ³•" class="headerlink" title="ä¸‰ã€æ¬¡æ¢¯åº¦ç®—æ³•"></a>ä¸‰ã€æ¬¡æ¢¯åº¦ç®—æ³•</h3><ol><li><p><strong>motivationï¼š</strong>ä½¿ç”¨GDAçš„å‰æä¸ºç›®æ ‡å‡½æ•° f(x) æ˜¯ä¸€é˜¶å¯å¾®çš„ï¼Œä½†å®é™…åº”ç”¨ä¸­ç»å¸¸ä¼šé‡åˆ°<strong>ä¸å¯å¾®</strong>çš„å‡½æ•°ï¼Œå¯¹äºè¿™ç±»å‡½æ•°æˆ‘ä»¬æ— æ³•åœ¨æ¯ä¸ªç‚¹å¤„æ±‚å‡ºæ¢¯åº¦ï¼Œä½†å¾€å¾€å®ƒä»¬çš„æœ€ä¼˜å€¼éƒ½æ˜¯åœ¨ä¸å¯å¾®ç‚¹å¤„å–åˆ°çš„ã€‚ä¸ºäº†èƒ½å¤„ç†è¿™ç§æƒ…å½¢ï¼Œæˆ‘ä»¬å¼•å…¥æ¬¡æ¢¯åº¦ç®—æ³•</p></li><li><p><strong>æ¬¡æ¢¯åº¦ç®—æ³•çš„ç»“æ„</strong></p><p><img src="https://s2.loli.net/2023/04/14/MlaJcfgUHEtXpbo.png"></p><p>å³å¯¹äºå‡¸å‡½æ•°æ¥è¯´ï¼Œå…¶åˆ‡çº¿æ€»æ˜¯åœ¨å‡½æ•°çš„ä¸‹æ–¹ã€‚</p><p>ç±»æ¯”ä¸Šå¼å¯å®šä¹‰ï¼Œç»™å®šå‡½æ•°fï¼Œå¯¹äºä»»æ„yï¼Œå¦‚æœæ»¡è¶³ï¼š</p><p>$$ f(y)\ge f(x)+g^T(y-x) $$</p><p>åˆ™ç§° g æ˜¯å‡½æ•° f åœ¨ç‚¹ x å¤„çš„æ¬¡æ¢¯åº¦ï¼Œå¯è§æ¬¡æ¢¯åº¦ä¸ä¸€å®šå”¯ä¸€ï¼Œä¹Ÿå¯èƒ½ä¸å­˜åœ¨ã€‚</p><p>å°† f åœ¨ x å¤„æ‰€æœ‰æ¬¡æ¢¯åº¦æ„æˆçš„é›†åˆç§°ä¸º f åœ¨ x å¤„çš„æ¬¡å¾®åˆ†ï¼Œè®°ä½œ$\partial f(x)$</p><div class="note note-warning">            <p>ğŸ’¡ PS. æ³¨æ„ï¼šæ¬¡å¾®åˆ†æ˜¯ä¸€ä¸ªé›†åˆï¼Œè€Œå‡¸å‡½æ•°çš„æ¬¡å¾®åˆ†æ€»æ˜¯éç©ºï¼Œå³å¿…æœ‰æ¬¡æ¢¯åº¦   </p>          </div><p>å‡è®¾å‡¸å‡½æ•° f åœ¨ä¸å¯å¾®ç‚¹x0å¤„çš„å·¦å³å¯¼æ•°åˆ†åˆ«ä¸ºaã€bï¼Œé‚£ä¹ˆé—­åŒºé—´[aï¼Œb]ä¸­çš„ä»»ä½•ä¸€ä¸ªå–å€¼éƒ½æ˜¯æ¬¡æ¢¯åº¦ï¼Œå¦‚$f(x)&#x3D;\vert x \vert$ï¼Œåˆ™$g&#x3D;\begin{cases}sgn(x)&amp;x\neq0\ any\in[-1,1]&amp;x&#x3D;0\end{cases}$</p></li><li><p><strong>æ”¶æ•›æ€§</strong></p><p>ä¸€ä¸ªå¸¸ç”¨çš„å–æ³•æ˜¯$\alpha_k&#x3D;\frac{1}{k}$ï¼Œè¿™æ ·å¯ä¿è¯ç®—æ³•çš„æ”¶æ•›æ€§</p></li></ol><h3 id="å››ã€ç‰›é¡¿ç±»ç®—æ³•"><a href="#å››ã€ç‰›é¡¿ç±»ç®—æ³•" class="headerlink" title="å››ã€ç‰›é¡¿ç±»ç®—æ³•"></a>å››ã€ç‰›é¡¿ç±»ç®—æ³•</h3><ol><li><p><strong>motivationï¼š</strong></p><p>æ¢¯åº¦æ³•ä»…ä»…ä¾èµ–å‡½æ•°å€¼å’Œæ¢¯åº¦çš„ä¿¡æ¯ï¼ˆå³ä¸€é˜¶ä¿¡æ¯ï¼‰ï¼Œå¦‚æœå‡½æ•° <em>f</em>(<em>x</em>) å……åˆ†å…‰æ»‘ï¼Œåˆ™å¯ä»¥åˆ©ç”¨äºŒé˜¶å¯¼æ•°ä¿¡æ¯æ„é€ ä¸‹é™æ–¹å‘ <em>dk</em>ã€‚ç‰›é¡¿ç±»ç®—æ³•å°±æ˜¯åˆ©ç”¨äºŒé˜¶å¯¼æ•°ä¿¡æ¯æ¥æ„é€ è¿­ä»£æ ¼å¼çš„ç®—æ³•ã€‚ç”±äºåˆ©ç”¨çš„ä¿¡æ¯å˜å¤šï¼Œç‰›é¡¿æ³•çš„å®é™…è¡¨ç°å¯ä»¥è¿œå¥½äºæ¢¯åº¦æ³•ï¼Œä½†æ˜¯å®ƒå¯¹å‡½æ•° <em>f</em>(<em>x</em>) çš„è¦æ±‚ä¹Ÿç›¸åº”å˜é«˜</p></li><li><p><strong>ç»å…¸ç‰›é¡¿æ³•</strong><br>$$<br>x^{k+1}&#x3D;x^k-\nabla^2f(x^k)^{-1}\nabla f(x^k)<br>$$<br>ç»å…¸ç‰›é¡¿æ³•çš„ç‰¹ç‚¹ï¼š</p><ul><li>æ­¥é•¿æ’ä¸º1</li><li>æ”¶æ•›é€Ÿåº¦å¾ˆå¿«ï¼Œä½†åªæœ‰å±€éƒ¨æ”¶æ•›æ€§ï¼Œå³åˆå§‹ç‚¹x0å¿…é¡»ç¦»çœŸå®è§£è¾ƒè¿‘ï¼Œè¾ƒè¿œæ—¶å®¹æ˜“å¤±æ•ˆ</li></ul><p>å› æ­¤åœ¨åœ¨å®é™…åº”ç”¨ä¸­ï¼Œäººä»¬é€šå¸¸ä¼šä½¿ç”¨æ¢¯åº¦ç±»ç®—æ³•å…ˆæ±‚å¾—è¾ƒä½ç²¾åº¦çš„è§£ï¼Œè€Œåè°ƒç”¨ç‰›é¡¿æ³•æ¥è·å¾—é«˜ç²¾åº¦çš„è§£</p></li><li><p><strong>ä¿®æ­£ç‰›é¡¿æ³•</strong></p><p><img src="https://s2.loli.net/2023/04/14/kO4vuQbPhI3tcs6.png"></p><p>åŸºæœ¬æ€æƒ³æ˜¯å¯¹ç‰›é¡¿æ–¹ç¨‹ä¸­çš„æµ·ç‘ŸçŸ©é˜µ$\nabla^2f(x^k)$è¿›è¡Œä¿®æ­£</p></li></ol><h3 id="äº”ã€æ‹Ÿç‰›é¡¿ç±»ç®—æ³•"><a href="#äº”ã€æ‹Ÿç‰›é¡¿ç±»ç®—æ³•" class="headerlink" title="äº”ã€æ‹Ÿç‰›é¡¿ç±»ç®—æ³•"></a>äº”ã€æ‹Ÿç‰›é¡¿ç±»ç®—æ³•</h3><ol><li><p><strong>motivationï¼š</strong>æ‹Ÿç‰›é¡¿æ–¹æ³•ä¸è®¡ç®—æµ·ç‘ŸçŸ©é˜µ$\nabla^2f(x^k)$ ï¼Œè€Œæ˜¯æ„é€ å…¶è¿‘ä¼¼çŸ©é˜µ$B^k$æˆ–å…¶é€†çš„è¿‘ä¼¼çŸ©é˜µ $H^k$ï¼Œæˆ‘ä»¬å¸Œæœ› $B^k$ **æˆ–$H^k$ä»ç„¶ä¿ç•™æµ·ç‘ŸçŸ©é˜µçš„éƒ¨åˆ†æ€§è´¨ï¼Œä¾‹å¦‚ä½¿dkä»ç„¶ä¸ºä¸‹é™æ–¹å‘</p></li><li><p><strong>ç®—æ³•æ¡†æ¶</strong></p><p><img src="https://s2.loli.net/2023/04/14/P34FKpX1rmdulV5.png"></p></li><li><p><strong>æ‹Ÿç‰›é¡¿çŸ©é˜µæ›´æ–°æ–¹å¼</strong></p></li></ol><ul><li><p>ç§©ä¸€æ›´æ–°ï¼ˆSR1ï¼‰</p><p>$$ B^{k+1}&#x3D;B^k+\dfrac{(y^k-B^ks^k)(y^k-B^k s^k)^{\text{T}}}{(y^k-B^kj)^{\text{T}}s^k} $$</p><p>$$ H^{k+1}&#x3D;H^k+\dfrac{(s^k-H^k y^k)(s^k-H^ky^k)^{\mathrm{T}}}{(s^k-H^ky^{k})^{\mathrm{T}}y^k} $$</p></li><li><p>BFGSå…¬å¼</p><p>$$ B^{k+1}&#x3D;B^k+\dfrac{y^k(y^k)^{T}}{(s^k)^{T}y^k}-\dfrac{B^k s^k(B^k s^k)^}{(s^k)^{T}B^k s^k} $$</p><p>BFGS å…¬å¼æ˜¯ç›®å‰æœ€æœ‰æ•ˆçš„æ‹Ÿç‰›é¡¿æ›´æ–°æ ¼å¼ä¹‹ä¸€ï¼Œå®ƒæœ‰æ¯”è¾ƒå¥½çš„ç†è®ºæ€§è´¨ï¼Œå®ç°èµ·æ¥ä¹Ÿå¹¶ä¸å¤æ‚</p></li></ul><ol><li><p><strong>æœ‰é™å†…å­˜BFGSæ–¹æ³•</strong></p><p>æ‹Ÿç‰›é¡¿æ³•è™½ç„¶å…‹æœäº†è®¡ç®—æµ·ç‘ŸçŸ©é˜µçš„å›°éš¾ï¼Œä½†æ˜¯å®ƒä»ç„¶æ— æ³•åº”ç”¨åœ¨å¤§è§„æ¨¡ä¼˜åŒ–é—®é¢˜ä¸Šã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ‹Ÿç‰›é¡¿çŸ©é˜µ$B^k$ æˆ–$H^k$ æ˜¯ç¨ å¯†çŸ©é˜µï¼Œè€Œå­˜å‚¨ç¨ å¯†çŸ©é˜µè¦æ¶ˆè€— <em>O</em>(nÂ²) çš„å†…å­˜ï¼Œè¿™å¯¹äºå¤§è§„æ¨¡é—®é¢˜æ˜¾ç„¶æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œæ•…å¼•å…¥æœ‰é™å†…å­˜BFGSæ–¹æ³•ï¼ˆL-BFGSï¼‰</p><p><img src="https://s2.loli.net/2023/04/14/PwRMakbExuog97v.png"></p><p><img src="https://s2.loli.net/2023/04/14/hB2pODdcqLivJRy.png"></p></li></ol><h3 id="å…­ã€ä¿¡èµ–åŸŸç®—æ³•"><a href="#å…­ã€ä¿¡èµ–åŸŸç®—æ³•" class="headerlink" title="å…­ã€ä¿¡èµ–åŸŸç®—æ³•"></a>å…­ã€ä¿¡èµ–åŸŸç®—æ³•</h3><ol><li><p><strong>motivationï¼š</strong>åœ¨ä¿¡èµ–åŸŸç±»ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ä¸€ä¸ªæœ‰ç•ŒåŒºåŸŸå†…æ±‚è§£è¿™ä¸ªè¿‘ä¼¼æ¨¡å‹ï¼Œè€Œåè¿­ä»£åˆ°ä¸‹ä¸€ä¸ªç‚¹ï¼å› æ­¤ä¿¡èµ–åŸŸç®—æ³•å®é™…ä¸Šæ˜¯åŒæ—¶é€‰æ‹©äº†æ–¹å‘å’Œæ­¥é•¿</p></li><li><p><strong>å½¢å¼ï¼š</strong></p><p>æˆ‘ä»¬åœ¨å¦‚ä¸‹çƒå†…è€ƒè™‘ f(x) çš„è¿‘ä¼¼<br>$$<br>\Omega_k&#x3D;{x^k+d\mid|d|\leqslant\Delta_k}<br>$$<br><img src="https://s2.loli.net/2023/04/14/uDc6BfUdOZrG5v2.png"></p><p>å…¶ä¸­ï¼Œmk(d)æ˜¯åœ¨ç‚¹x&#x3D;xkå¤„å¯¹f(x)çš„è¿‘ä¼¼</p><p>$$ m_k(d)&#x3D;f(x^k)+\nabla f(x^k)^{\mathrm T}d+\dfrac12d^{\mathrm T}B^kd $$</p><p>é€‰å–ä¿¡èµ–åŸŸåŠå¾„éå¸¸å…³é”®ï¼Œå®ƒå†³å®šäº†ç®—æ³•çš„æ”¶æ•›æ€§ã€‚è€ƒè™‘åˆ°ä¿¡èµ–åŸŸåŠå¾„æ˜¯â€œå¯¹æ¨¡å‹ <em>mk</em>(<em>d</em>) ç›¸</p><p>ä¿¡çš„ç¨‹åº¦â€ï¼Œå¦‚æœ <em>mk</em>(<em>d</em>) å¯¹å‡½æ•° <em>f</em>(<em>x</em>) è¿‘ä¼¼è¾ƒå¥½ï¼Œå°±åº”è¯¥æ‰©å¤§ä¿¡èµ–åŸŸåŠå¾„ï¼›åä¹‹å‡å°ã€‚æˆ‘ä»¬å¼•å…¥å¦‚ä¸‹å®šä¹‰æ¥è¡¡é‡ <em>mk</em>(<em>d</em>) è¿‘ä¼¼ç¨‹åº¦çš„å¥½å</p><p>$$ \rho_k&#x3D;\dfrac{f(x^k)-f(x^k+d^k)}{m_k(0)-m_k(d^k)} $$</p><p>å¦‚æœ<em>Ïk</em> æ¥è¿‘äº1ï¼Œè¯´æ˜ç”¨ <em>mk</em>(<em>d</em>) æ¥è¿‘ä¼¼ <em>f</em>(<em>x</em>) æ˜¯æ¯”è¾ƒæˆåŠŸçš„ï¼Œæˆ‘ä»¬åº”è¯¥æ‰©å¤§ <em>âˆ†k</em>ï¼›å¦‚æœ <em>Ïk</em> éå¸¸å°ç”šè‡³ä¸ºè´Ÿï¼Œå°±è¯´æ˜æˆ‘ä»¬è¿‡åˆ†åœ°ç›¸ä¿¡äº†äºŒé˜¶æ¨¡å‹ <em>mk</em>(<em>d</em>)ï¼Œæ­¤æ—¶åº”è¯¥ç¼©å° <em>âˆ†k</em></p><p><img src="https://s2.loli.net/2023/04/14/pRejfTP5g3yAiLV.png" alt="Untitled"></p></li></ol><h1 id="ç¬¬äº”ç« ã€çº¦æŸä¼˜åŒ–ç®—æ³•"><a href="#ç¬¬äº”ç« ã€çº¦æŸä¼˜åŒ–ç®—æ³•" class="headerlink" title="ç¬¬äº”ç« ã€çº¦æŸä¼˜åŒ–ç®—æ³•"></a>ç¬¬äº”ç« ã€çº¦æŸä¼˜åŒ–ç®—æ³•</h1><h3 id="ä¸€ã€ç½šå‡½æ•°æ³•"><a href="#ä¸€ã€ç½šå‡½æ•°æ³•" class="headerlink" title="ä¸€ã€ç½šå‡½æ•°æ³•"></a>ä¸€ã€ç½šå‡½æ•°æ³•</h3><ol><li><p><strong>motivationï¼š</strong></p><p>å¯è¡ŒåŸŸçš„çº¦æŸå¯¼è‡´å¾ˆå¤šæ— çº¦æŸç®—æ³•ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼ˆå¦‚æ¢¯åº¦ä¸‹é™æ²¿è´Ÿæ¢¯åº¦ä¸‹é™çš„ç‚¹æœªå¿…æ˜¯å¯è¡Œç‚¹ï¼‰ï¼Œè€Œç½šå‡½æ•°çš„æ€æƒ³æ˜¯å°†çº¦æŸæ¡ä»¶ä½œä¸ºæƒ©ç½šé¡¹åŠ åˆ°ç›®æ ‡å‡½æ•°ä¸­ï¼Œä»è€Œè½¬æ¢ä¸ºæ— çº¦æŸä¼˜åŒ–é—®é¢˜ã€‚</p><p>è€Œè¿™æ ·åšçš„åŸç†æ˜¯ä»€ä¹ˆæ â€”â€” å¯¹äº<strong>å¯è¡ŒåŸŸå¤–çš„ç‚¹ï¼Œæƒ©ç½šé¡¹ä¸ºæ­£</strong>ï¼Œå³å¯¹è¯¥ç‚¹è¿›è¡Œæƒ©ç½šï¼›å¯¹äº<strong>å¯è¡ŒåŸŸå†…çš„ç‚¹ï¼Œæƒ©ç½šé¡¹ä¸º 0</strong>ï¼Œå³ä¸åšä»»ä½•æƒ©ç½šã€‚å› æ­¤ï¼Œæƒ©ç½šé¡¹ä¼šä¿ƒä½¿æ— çº¦æŸä¼˜åŒ–é—®é¢˜çš„è§£è½åœ¨å¯è¡ŒåŸŸå†…ï¼ˆå¥½èªæ˜çš„åšæ³•ï¼‰ã€‚</p></li><li><p><strong>ç­‰å¼çº¦æŸæ¡ä»¶ç½šå‡½æ•°</strong></p><p><img src="https://s2.loli.net/2023/04/14/pDF1ZyodE9vP5jI.png"></p></li><li><p><strong>ä¸ç­‰å¼çº¦æŸ</strong></p><p><img src="https://s2.loli.net/2023/04/14/xX73rBP5fuwVtlS.png"></p><p>æˆ‘ä»¬è®¾è®¡åŠ å…¥ç½šå‡½æ•°çš„ç›®æ ‡å‡½æ•°ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/WXZBYGvCbUFSNo2.png"></p><p><img src="https://s2.loli.net/2023/04/14/KEHV2ipQcxqT7N9.png"></p><p>è¿™æ ·çš„ç½šå‡½æ•°åªä¼šæƒ©ç½šci(x)ï¼0çš„éƒ¨åˆ†ï¼Œä¸”ç”±äºå‡½æ•° <em>h</em>(<em>t</em>) &#x3D; (max*{t*, 0*}*)Â²å…³äº <em>t</em> æ˜¯å¯å¯¼çš„ï¼Œå› æ­¤ <em>PI</em>(<em>x</em>,<em>Ïƒ</em>) çš„æ¢¯åº¦ä¹Ÿå­˜åœ¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ¢¯åº¦ç±»ç®—æ³•æ¥æ±‚è§£å­é—®é¢˜</p></li><li><p><strong>å†…ç‚¹ç½šå‡½æ•°</strong></p><p>åŸºæœ¬æ€æƒ³ï¼šæ™®é€šçš„å¤–ç‚¹ç½šå‡½æ•°å…è®¸å–å¯è¡ŒåŸŸä¹‹å¤–çš„ç‚¹ï¼Œåªæ˜¯è¦è¿›è¡Œæƒ©ç½šï¼›è€Œå†…ç‚¹æ³•ç›´æ¥ä¸å…è®¸å–å¯è¡ŒåŸŸä¹‹å¤–çš„ç‚¹ï¼Œå³ä»å¯è¡ŒåŸŸå†…éƒ¨é€¼è¿‘æœ€ä¼˜è§£</p><p><img src="https://s2.loli.net/2023/04/14/2LPyCemrqFWRujQ.png"></p><p>ä¸Šå¼æ—¢åšåˆ°äº†é™åˆ¶å¯è¡ŒåŸŸï¼Œåˆåšåˆ°äº†â€œxè¶‹è¿‘äºè¾¹ç•Œæ—¶è¿›è¡Œæƒ©ç½šâ€ï¼ˆInæ— ç©·å¤§ï¼‰</p></li></ol><h3 id="äºŒã€å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ³•"><a href="#äºŒã€å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ³•" class="headerlink" title="äºŒã€å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ³•"></a>äºŒã€å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ³•</h3><ol><li><strong>ç»“æ„</strong></li></ol><p><img src="https://s2.loli.net/2023/04/14/67anqbXZ3CoHMRx.png"></p><ol><li><p><strong>ä¸€èˆ¬çº¦æŸä¼˜åŒ–é—®é¢˜çš„å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ³•</strong></p><p><img src="https://s2.loli.net/2023/04/14/2DK1ludNp9EkQit.png"></p><p>æ€è·¯ï¼šå¼•å…¥æ¾å¼›å˜é‡å°†ä¸ç­‰å¼çº¦æŸè½¬åŒ–ä¸ºç­‰å¼çº¦æŸå’Œç®€å•çš„éè´Ÿçº¦æŸï¼Œå†æ„é€ å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°</p><p><img src="https://s2.loli.net/2023/04/14/9CePmiN4RJXKWHg.png"></p><p>å¯¹ä¸Šè¿°é—®é¢˜æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºä¸€ä¸ªç»å…¸çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°</p><p><img src="https://s2.loli.net/2023/04/14/A2b8cl9PHEz4NJf.png"></p></li></ol><h1 id="ç¬¬å…­ç« ã€å¤åˆä¼˜åŒ–ç®—æ³•"><a href="#ç¬¬å…­ç« ã€å¤åˆä¼˜åŒ–ç®—æ³•" class="headerlink" title="ç¬¬å…­ç« ã€å¤åˆä¼˜åŒ–ç®—æ³•"></a>ç¬¬å…­ç« ã€å¤åˆä¼˜åŒ–ç®—æ³•</h1><h3 id="ä¸€ã€èƒŒæ™¯"><a href="#ä¸€ã€èƒŒæ™¯" class="headerlink" title="ä¸€ã€èƒŒæ™¯"></a>ä¸€ã€èƒŒæ™¯</h3><p>å¤åˆä¼˜åŒ–é—®é¢˜å®šä¹‰ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/7fLqF8cXxjO3ZVS.png"></p><p>å…¶ä¸­ <em>f</em>(<em>x</em>) ä¸ºå¯å¾®å‡½æ•°ï¼ˆå¯èƒ½éå‡¸ï¼‰ï¼Œ<em>h</em>(<em>x</em>) å¯èƒ½ä¸ºä¸å¯å¾®å‡½æ•°</p><h3 id="äºŒã€è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•"><a href="#äºŒã€è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•" class="headerlink" title="äºŒã€è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•"></a>äºŒã€è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•</h3><ol><li><p><strong>é‚»è¿‘ç®—å­</strong></p><p>å¯¹äºä¸€ä¸ªå‡¸å‡½æ•° <em>h</em>ï¼Œå®šä¹‰å®ƒçš„é‚»è¿‘ç®—å­ä¸º</p><p><img src="https://s2.loli.net/2023/04/14/MXkIeUJt6zPBFlC.png"></p><p>å¯è§ï¼Œé‚»è¿‘ç®—å­çš„ç›®çš„æ˜¯æ±‚è§£ä¸€ä¸ªè· <em>x</em> ä¸ç®—å¤ªè¿œçš„ç‚¹ï¼Œå¹¶ä½¿å‡½æ•°å€¼ <em>h</em>(<em>x</em>) ä¹Ÿç›¸å¯¹è¾ƒå°</p></li><li><p><strong>å…¬å¼</strong></p><p>å¯¹äºä¸€ä¸ªå¤åˆä¼˜åŒ–é—®é¢˜</p><p><img src="https://s2.loli.net/2023/04/14/P4NxGtKcvzmS8XF.png"></p><p>è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•çš„æ€æƒ³éå¸¸ç®€å•ï¼šæ³¨æ„åˆ° <em>Ïˆ</em>(<em>x</em>) æœ‰ä¸¤éƒ¨åˆ†ï¼Œå¯¹äºå…‰æ»‘éƒ¨åˆ†<em>f</em> åšæ¢¯åº¦ä¸‹é™ï¼Œå¯¹äºéå…‰æ»‘éƒ¨åˆ† <em>h</em> ä½¿ç”¨é‚»è¿‘ç®—å­ï¼Œåˆ™è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•çš„è¿­ä»£å…¬å¼ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/aOG3ESCUkqFM5Np.png"></p><p>å…¶ä¸­ <em>tk &gt;</em> 0 ä¸ºæ¯æ¬¡è¿­ä»£çš„æ­¥é•¿ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå¸¸æ•°æˆ–è€…ç”±çº¿æœç´¢å¾—å‡ºã€‚</p><p><img src="https://s2.loli.net/2023/04/14/jTPA6um7OtqriVL.png"></p></li></ol><h3 id="ä¸‰ã€NesterovåŠ é€Ÿç®—æ³•"><a href="#ä¸‰ã€NesterovåŠ é€Ÿç®—æ³•" class="headerlink" title="ä¸‰ã€NesterovåŠ é€Ÿç®—æ³•"></a>ä¸‰ã€NesterovåŠ é€Ÿç®—æ³•</h3><ol><li><p><strong>FISTAç®—æ³•</strong>ï¼ˆå¯å¯¹è¿‘ä¼¼ç‚¹æ¢¯åº¦ç®—æ³•è¿›è¡ŒåŠ é€Ÿï¼‰</p><p>FISTA ç®—æ³•ç”±ä¸¤æ­¥ç»„æˆï¼šç¬¬ä¸€æ­¥æ²¿ç€å‰ä¸¤æ­¥çš„è®¡ç®—æ–¹å‘è®¡ç®—ä¸€ä¸ªæ–°ç‚¹ï¼Œç¬¬äºŒæ­¥åœ¨è¯¥æ–°ç‚¹å¤„åšä¸€æ­¥è¿‘ä¼¼ç‚¹æ¢¯åº¦è¿­ä»£ï¼Œå³</p><p><img src="https://s2.loli.net/2023/04/14/Oyvg5k97UMNCELB.png"></p><p><img src="https://s2.loli.net/2023/04/14/LFejMiZGSY1V2Nn.png"></p></li></ol><h3 id="å››ã€åˆ†å—åæ ‡ä¸‹é™æ³•ï¼ˆblock-coordinate-descentï¼ŒBCDï¼‰"><a href="#å››ã€åˆ†å—åæ ‡ä¸‹é™æ³•ï¼ˆblock-coordinate-descentï¼ŒBCDï¼‰" class="headerlink" title="å››ã€åˆ†å—åæ ‡ä¸‹é™æ³•ï¼ˆblock coordinate descentï¼ŒBCDï¼‰"></a>å››ã€åˆ†å—åæ ‡ä¸‹é™æ³•ï¼ˆblock coordinate descentï¼ŒBCDï¼‰</h3><ol><li><p><strong>motivationï¼š</strong> å®é™…é—®é¢˜ä¸­çš„ç›®æ ‡å‡½æ•°è™½å¯èƒ½æœ‰æˆç™¾ä¸Šåƒä¸ªè‡ªå˜é‡ï¼Œæ±‚è§£ååˆ†å›°éš¾ï¼Œä½†å½“å›ºå®šå…¶ä¸­è‹¥å¹²å˜é‡æ—¶ï¼Œå‡½æ•°çš„ç»“æ„ä¼šå¾—åˆ°æå¤§çš„ç®€åŒ–ï¼Œæ˜¯åŸé—®é¢˜è¢«æ‹†åˆ†ä¸ºæ•°ä¸ªåªæœ‰å°‘æ•°è‡ªå˜é‡çš„å­é—®é¢˜ï¼Œè¿™ä¹Ÿæ­£æ˜¯BCDæ–¹æ³•çš„åŸºæœ¬æ€æƒ³</p></li><li><p><strong>å½¢å¼ï¼š</strong></p><p><img src="https://s2.loli.net/2023/04/14/Z8oWvxUuVjlCy9H.png"></p><p>å°†è‡ªå˜é‡ <em>x</em> æ‹†åˆ†æˆ <em>s</em> ä¸ªå˜é‡å— <em>x</em>1, <em>x</em>2,<em>Â·Â·Â·</em> , <em>xs</em>ï¼Œå‡½æ•° <em>f</em> æ˜¯å…³äº <em>x</em> çš„å¯å¾®å‡½æ•°ï¼Œæ¯ä¸ª <em>ri</em>(<em>xi</em>) å…³äº <em>xi</em> æ˜¯é€‚å½“çš„é—­å‡¸å‡½æ•°ã€‚ å•ç‹¬è€ƒè™‘æ¯ä¸€å—è‡ªå˜é‡æ—¶ï¼Œf æœ‰ç®€å•ç»“æ„ï¼Œri åªä¸ç¬¬ i ä¸ªè‡ªå˜é‡å—æœ‰å…³</p></li><li><p><strong>ä¸¾ä¾‹</strong></p><p>è€ƒè™‘äºŒå…ƒäºŒæ¬¡å‡½æ•°çš„ä¼˜åŒ–é—®é¢˜</p><p><img src="https://s2.loli.net/2023/04/14/Z8oWvxUuVjlCy9H.png"></p><p>ç°åœ¨å¯¹å˜é‡ <em>x</em>,<em>y</em> ä½¿ç”¨åˆ†å—åæ ‡ä¸‹é™æ³•æ±‚è§£ã€‚å½“å›ºå®š <em>y</em> æ—¶ï¼Œå¯çŸ¥å½“ <em>x</em> &#x3D; 2 + <em>y</em>æ—¶å‡½æ•°å–æå°å€¼ï¼›å½“å›ºå®š <em>x</em> æ—¶ï¼Œå¯çŸ¥å½“ <em>y</em> &#x3D; 1 +*x&#x2F;*10æ—¶å‡½æ•°å–æå°å€¼ã€‚æ•…é‡‡ç”¨çš„åˆ†å—åæ ‡ä¸‹é™æ³•ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/O5J1ovfhcqgCaZt.png"></p><p>ç»éªŒè¯ï¼Œåˆå§‹ç‚¹ä¸º(0.5, 0.2)æ—¶ï¼Œç»è¿‡ä¸ƒæ¬¡è¿­ä»£å°±ä¸æœ€ä¼˜è§£ç›¸å½“æ¥è¿‘</p><p><img src="https://s2.loli.net/2023/04/14/JDINTVim7MEvOKZ.png"></p></li></ol><h3 id="äº”ã€å¯¹å¶ç®—æ³•"><a href="#äº”ã€å¯¹å¶ç®—æ³•" class="headerlink" title="äº”ã€å¯¹å¶ç®—æ³•"></a>äº”ã€å¯¹å¶ç®—æ³•</h3><ol><li>å¯¹å¶æ€æƒ³å¸¸ç”¨æ€è·¯æœ‰ä¸¤ç§ï¼šæŠŠå‰é¢çš„ç®—æ³•åº”ç”¨åˆ°å¯¹å¶é—®é¢˜ä¸Šï¼Œå¦‚å¯¹å¶è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•ï¼›å¦ä¸€ç§æ˜¯åŒæ—¶æŠŠåŸå§‹é—®é¢˜å’Œå¯¹å¶é—®é¢˜ç»“åˆèµ·æ¥è€ƒè™‘ï¼Œå¦‚åŸå§‹-å¯¹å¶æ··åˆæ¢¯åº¦ç±»ç®—æ³• å¯¹å¶ç®—æ³•ä¸»è¦è€ƒè™‘å¦‚ä¸‹å½¢å¼çš„é—®é¢˜ï¼š</li></ol><p><img src="https://s2.loli.net/2023/04/14/CVquzigKfx4jYQJ.png"></p><ol start="2"><li><strong>å¯¹å¶è¿‘ä¼¼ç‚¹æ¢¯åº¦æ³•</strong></li></ol><p>â€‹å¦‚æœæˆ‘ä»¬å†™å‡ºä¸Šè¿°çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°å’Œå¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°</p><p><img src="https://s2.loli.net/2023/04/14/pfmt3ELqnaowGNk.png"></p><p>â€‹åˆ™è¿­ä»£æ ¼å¼å¯ä»¥å†™ä¸º</p><p><img src="https://s2.loli.net/2023/04/14/81PytDkENRAsQVY.png"></p><p>â€‹ä¸Šè¿°è¿­ä»£æ ¼å¼åˆç§°ä¸º<strong>äº¤æ›¿æå°åŒ–æ–¹æ³•ï¼Œ</strong>ç¬¬ä¸€æ­¥è¿­ä»£ä¸ºåœ¨æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸­å…³äº <em>x</em> æ±‚æå°ï¼Œç¬¬äºŒæ­¥è¿­ä»£ä¸ºåœ¨å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸­å…³äº <em>y</em> æ±‚æå°ï¼Œç¬¬ä¸‰æ­¥è¿­ä»£ä¸ºæ›´æ–°æ‹‰æ ¼æœ—æ—¥ä¹˜å­ã€‚</p><ol start="3"><li><strong>åŸå§‹-å¯¹å¶æ··åˆæ¢¯åº¦ç®—æ³•ï¼ˆprimaldual hybrid gradient, PDHGï¼‰</strong></li></ol><p>â€‹PDGHåœ¨æ¯æ¬¡è¿­ä»£æ—¶åŒæ—¶è€ƒè™‘åŸå§‹å˜é‡å’Œå¯¹å¶å˜é‡çš„æ›´æ–°ï¼Œè¿™ä½¿å¾—å®ƒåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æœ‰æ•ˆé¿å…å•ç‹¬é’ˆå¯¹åŸå§‹é—®é¢˜æˆ–å¯¹å¶é—®é¢˜æ±‚è§£ç®—æ³•ä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜ ä»ç„¶è€ƒè™‘å¦‚ä¸‹å½¢å¼ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/5ERFWfJcpC9xrlb.png"></p><p>â€‹å…¶ä¸­ <em>f</em> , <em>h</em> æ˜¯é€‚å½“çš„é—­å‡¸å‡½æ•°ï¼ç”±äº <em>h</em> æœ‰è‡ªå…±è½­æ€§ï¼Œæˆ‘ä»¬å°†ä¸Šè¿°é—®é¢˜å˜å½¢ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/qclZvI8Y1K5EsGF.png"></p><p>â€‹æ­¤æ—¶é—®é¢˜å˜å½¢ä¸ºä¸€ä¸ªæå°-æå¤§é—®é¢˜ï¼Œå³ä¸€ä¸ªå…¸å‹çš„<strong>éç‚¹é—®é¢˜</strong>ã€‚PDHG ç®—æ³•äº¤æ›¿æ›´æ–°åŸå§‹å˜é‡ä»¥åŠå¯¹å¶å˜é‡ï¼Œå…¶è¿­ä»£æ ¼å¼å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/89ROHGwP5YDfgoc.png"></p><h3 id="å…­ã€äº¤æ›¿æ–¹å‘ä¹˜å­æ³•ï¼ˆalternating-direction-method-of-multipliers-ADMMï¼‰"><a href="#å…­ã€äº¤æ›¿æ–¹å‘ä¹˜å­æ³•ï¼ˆalternating-direction-method-of-multipliers-ADMMï¼‰" class="headerlink" title="å…­ã€äº¤æ›¿æ–¹å‘ä¹˜å­æ³•ï¼ˆalternating direction method of multipliers, ADMMï¼‰"></a>å…­ã€äº¤æ›¿æ–¹å‘ä¹˜å­æ³•ï¼ˆalternating direction method of multipliers, ADMMï¼‰</h3><ol><li><p><strong>å®šä¹‰ï¼š</strong></p><p>æœ¬èŠ‚è€ƒè™‘å¦‚ä¸‹å‡¸é—®é¢˜ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/OjyM8sLdxBIUTho.png"></p><p>æ³¨æ„ï¼šå¾ˆå¤šå¸¸è§çš„é—®é¢˜éƒ½å¯è½¬åŒ–ä¸ºä¸Šè¿°å½¢å¼</p><p>å¦‚æŠŠ</p><p><img src="https://s2.loli.net/2023/04/14/ePVhFaBwXq4dG5g.png"></p><p>è½¬åŒ–ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/5NPCMdZmROeQ23B.png"></p><p>å†æ¯”å¦‚å¯¹äº<strong>ä¸€è‡´æ€§é—®é¢˜</strong>ï¼š</p><p><img src="https://s2.loli.net/2023/04/14/4ZTa6v2eUuIQSPx.png"></p><p>ä»¤ <em>x</em> &#x3D; <em>z</em>ï¼Œå¹¶å°† <em>x</em> å¤åˆ¶ <em>N</em> ä»½ï¼Œåˆ†åˆ«ä¸º <em>xi</em>ï¼Œé‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/KVco15f4PrFmuUx.png"></p><p>å¦‚æœä»¤$x&#x3D;(x_1^\mathrm T,x_2^\mathrm T,\cdots,x_N^\mathrm T)^\mathrm T$ä»¥åŠ$f_1(x)&#x3D;\sum\limits_{i&#x3D;1}^N\phi_i(x_i),\quad f_2(z)&#x3D;0$ åˆ™æ­¤é—®é¢˜å¯ä»¥åŒ–ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/lUen9HYD73EhXdW.png"></p><p>å…¶ä¸­çŸ©é˜µ <em>A</em>1, <em>A</em>2 å®šä¹‰ä¸ºï¼š</p><p><img src="https://s2.loli.net/2023/04/14/hFfUAVeaGOc731n.png"></p></li><li><p><strong>è¿­ä»£æ ¼å¼</strong></p><p>é¦–å…ˆå†™å‡ºé—®é¢˜çš„å¢å¹¿æ‹‰æ ¼æœ—æ—¥å‡½æ•°</p><p><img src="https://s2.loli.net/2023/04/14/ckdolxbypJTeZ42.png"></p><p>åˆ™è¿­ä»£æ ¼å¼ä¸ºï¼š</p></li></ol><p><img src="https://s2.loli.net/2023/04/14/62H5jK1lVUkQrzO.png"></p>]]></content>
    
    
    <categories>
      
      <category>ç§‘ç ”åªä¸ºæŠŠä¸šæ¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†å¸ƒå¼</tag>
      
      <tag>å‡¸ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å€Ÿtop Ké¢˜ç›®æ€è€ƒæ€»ç»“å †ï¼ˆheapï¼‰ä¸ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆpriority_quequeï¼‰ç”¨æ³•</title>
    <link href="/2023/04/13/%E5%80%9FtopK%E9%A2%98%E7%9B%AE%E6%80%9D%E8%80%83%E6%80%BB%E7%BB%93%E5%A0%86%E4%B8%8E%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97%E7%94%A8%E6%B3%95/"/>
    <url>/2023/04/13/%E5%80%9FtopK%E9%A2%98%E7%9B%AE%E6%80%9D%E8%80%83%E6%80%BB%E7%BB%93%E5%A0%86%E4%B8%8E%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97%E7%94%A8%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h1><p>ä»Šå¤©åšäº†ä¼ è¯´ä¸­çš„top K ï¼Œå³â€œ<strong>ç”¨å¤§é¡¶å †&#x2F;å°é¡¶å †å¯¹æ•°æ®è¿›è¡Œæ’åº</strong>â€çš„ç»å…¸é¢˜ç›®</p><p><img src="https://s2.loli.net/2023/04/13/ayuA9B7DGbOni2p.png"><br>æœ¬é¢˜æ€è·¯ï¼š</p><ol><li>ç”¨mapè®°å½•æ¯ä¸ªå…ƒç´ å‡ºç°çš„é¢‘ç‡</li><li>ç”¨heapå¯¹mapè¿›è¡Œæ’åºå¹¶èŠ‚é€‰å‡ºå‰Kä¸ªå…ƒç´ </li></ol><p>è‹¥ç¬¬ä¸€æ¬¡è§æ­¤ç±»é¢˜ï¼Œéš¾ç‚¹å½“ä¸ºheapçš„åŸç†å’Œå¯¹åº”stlå®¹å™¨ï¼ˆpriority_queueï¼‰çš„ç”¨æ³•ã€‚æŸ¥é˜…äº†ä¸€äº›èµ„æ–™ï¼Œå‘ç°ä¸ç®¡æ˜¯leetcodeé¢˜è§£æŠ‘æˆ–åšå®¢æ–‡ç« éƒ½å†™å¾—ç•¥è¯­ç„‰ä¸è¯¦ï¼Œå¯¹æ–°æ‰‹ä¸ç”šå‹å¥½ï¼Œæ•…ç¬”è€…è¯•å›¾ç”¨è‡ªå·±çš„è¯å¯¹å…¶åŸç†è¿›è¡Œç²—ç³™è§£é‡Šã€‚</p><hr><h1 id="äºŒã€å †ï¼ˆheapï¼‰çš„åŸç†å’Œç”¨æ³•ï¼ˆä¸‹è¿°æ‰€æœ‰ä¾‹å­é»˜è®¤ç”¨å°é¡¶å †ï¼‰"><a href="#äºŒã€å †ï¼ˆheapï¼‰çš„åŸç†å’Œç”¨æ³•ï¼ˆä¸‹è¿°æ‰€æœ‰ä¾‹å­é»˜è®¤ç”¨å°é¡¶å †ï¼‰" class="headerlink" title="äºŒã€å †ï¼ˆheapï¼‰çš„åŸç†å’Œç”¨æ³•ï¼ˆä¸‹è¿°æ‰€æœ‰ä¾‹å­é»˜è®¤ç”¨å°é¡¶å †ï¼‰"></a>äºŒã€å †ï¼ˆheapï¼‰çš„åŸç†å’Œç”¨æ³•ï¼ˆä¸‹è¿°æ‰€æœ‰ä¾‹å­é»˜è®¤ç”¨å°é¡¶å †ï¼‰</h1><h3 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1.å®šä¹‰"></a>1.å®šä¹‰</h3><p>ï¼ˆ1ï¼‰ å †æ˜¯ä¸€ç§å…·æœ‰ç‰¹æ®Šæ’åºå…³ç³»çš„å®Œå…¨äºŒå‰æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå †é¦–å…ˆå¾—å…·æœ‰å®Œå…¨äºŒå‰æ ‘çš„æ‰€æœ‰ç‰¹æ€§<br>ï¼ˆ2ï¼‰ ç‰¹æ®Šæ’åºå…³ç³»æŒ‡â€”â€”ä»¥å°é¡¶å †ä¸ºä¾‹â€”â€”<strong>æ¯ä¸ªèŠ‚ç‚¹çš„valueéƒ½å°äºå…¶ä¸¤ä¸ªå­èŠ‚ç‚¹</strong> ï¼›å¤§é¡¶å †åä¹‹</p><p>ä¸‹å›¾å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å°é¡¶å †</p><p><img src="https://s2.loli.net/2023/04/13/LYr9ecyzTOpSwCM.png"></p><h3 id="3-å †çš„å»ºç«‹ï¼ˆpushï¼‰"><a href="#3-å †çš„å»ºç«‹ï¼ˆpushï¼‰" class="headerlink" title="3.å †çš„å»ºç«‹ï¼ˆpushï¼‰"></a>3.å †çš„å»ºç«‹ï¼ˆpushï¼‰</h3><p>å¯¹äºä¸€ä¸ªå·²ç»å»ºå¥½çš„å †ï¼Œpushæ–°å…ƒç´ çš„æ–¹æ³•æ˜¯ï¼š</p><ol><li><strong>æ’å…¥</strong>ï¼šå°†è¯¥å…ƒç´ æ’å…¥åˆ°heapçš„å°¾éƒ¨</li><li><strong>æ¯”è¾ƒ</strong>ï¼šç„¶åä¸æ–­â€œä¸Šæµ®â€ï¼Œç›´è‡³æ»¡è¶³å †çš„æ¡ä»¶ã€‚æ‰€è°“â€œä¸Šæµ®â€ï¼Œå°±æ˜¯å°†è¯¥å…ƒç´ ä¸å…¶çˆ¶èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”çˆ¶èŠ‚ç‚¹å°åˆ™ä¸Šæµ®ä¸€å±‚ï¼Œå¦åˆ™ä¸åŠ¨ï¼Œä¸€ç›´æ“ä½œç›´è‡³ä¸Šæµ®ä¸åŠ¨ã€‚</li></ol><p>è€Œè‹¥æ˜¯è¦ä»é›¶å¼€å§‹å»ºç«‹ä¸€ä¸ªå †æï¼Ÿå¾ˆç®€å•ï¼Œä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œå¯¹æ¯ä¸ªå…ƒç´ éƒ½æ‰§è¡Œä¸€æ¬¡pushæ“ä½œå°±è¡Œäº†ã€‚<br>ä¸‹å›¾å±•ç¤ºäº†ä»é›¶å¼€å§‹å»ºç«‹ä¸€ä¸ªheapè¿‡ç¨‹</p><p><img src="https://s2.loli.net/2023/04/13/gkV1vRcHpiLSujf.jpg"></p><h3 id="2-å †çš„åˆ é™¤ï¼ˆpopï¼‰"><a href="#2-å †çš„åˆ é™¤ï¼ˆpopï¼‰" class="headerlink" title="2.å †çš„åˆ é™¤ï¼ˆpopï¼‰"></a>2.å †çš„åˆ é™¤ï¼ˆpopï¼‰</h3><p>ä¸‰æ­¥èµ°ï¼š</p><ol><li><strong>å¼¹å‡º</strong>ï¼šå°†å †é¡¶å…ƒç´ ï¼ˆå³æœ€å°çš„é‚£ä¸ªå…ƒç´ ï¼‰ç›´æ¥pop</li><li><strong>æä¸Š</strong>ï¼šå°†heapçš„æœ€åä¸€ä¸ªå…ƒç´ æåˆ°å †é¡¶</li><li><strong>ä¸‹æ²‰</strong>ï¼šå°†æä¸Šçš„è¿™ä¸ªå †é¡¶å…ƒç´ ä¸æ–­ä¸å…¶å­èŠ‚ç‚¹æ¯”è¾ƒï¼Œå¤§äºå­èŠ‚ç‚¹å°±ä¸‹æ²‰ä¸€å±‚ï¼Œç›´è‡³å…¨æ»¡è¶³å®šä¹‰</li></ol><p>å¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://s2.loli.net/2023/04/13/RXMb5QG1VdutzF6.jpg"></p><hr><h1 id="ä¸‰ã€ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆpriority-queueï¼‰çš„ä½¿ç”¨"><a href="#ä¸‰ã€ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆpriority-queueï¼‰çš„ä½¿ç”¨" class="headerlink" title="ä¸‰ã€ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆpriority_queueï¼‰çš„ä½¿ç”¨"></a>ä¸‰ã€ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆpriority_queueï¼‰çš„ä½¿ç”¨</h1><h3 id="1-å®šä¹‰-1"><a href="#1-å®šä¹‰-1" class="headerlink" title="1.å®šä¹‰"></a>1.å®šä¹‰</h3><p>æˆ‘ä»¬å¯ä»¥ç”¨c++ stlä¸­çš„priority_queueå®¹å™¨æ¥å®ç°heapçš„æ“ä½œï¼Œå…¶å®šä¹‰å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span>,<br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Container</span> = std::vector&lt;T&gt;,<br>    <span class="hljs-keyword">class</span> Compare = std::less&lt;<span class="hljs-keyword">typename</span> Container::value_type&gt;<br>&gt; <span class="hljs-keyword">class</span> priority_queue;<br></code></pre></td></tr></table></figure><p>Tæ˜¯æŒ‡å †ä¸­å…ƒç´ çš„<strong>æ•°æ®ç±»å‹</strong>ï¼›<br>containeræŒ‡ç”¨äºå­˜å‚¨è¿™äº›å…ƒç´ çš„<strong>åº•å±‚å®¹å™¨ç±»å‹</strong>ï¼ˆ<strong>é»˜è®¤ç”¨vector</strong>ï¼Œä¸€èˆ¬ä¹Ÿä¸ç”¨æ”¹ï¼‰ï¼›<br>compareæ˜¯å…ƒç´ ä¹‹é—´çš„<strong>æ¯”è¾ƒæ–¹å¼</strong>ï¼Œç”¨äºå†³å®šå»ºç«‹çš„æ˜¯å¤§é¡¶å †orå°é¡¶å †ï¼Œé»˜è®¤ç”¨lesså‡½æ•°å»ºç«‹å¤§é¡¶å †ï¼ˆå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰compareæ–¹æ³•æ¥å»ºç«‹ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„å †ã€‚ã€‚ï¼‰</p><h3 id="2-å¸¸ç”¨æ–¹æ³•"><a href="#2-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.å¸¸ç”¨æ–¹æ³•"></a>2.å¸¸ç”¨æ–¹æ³•</h3><p>å’Œæ™®é€šé˜Ÿåˆ—ä¸€æ ·ï¼Œå¸¸ç”¨çš„å°±pop()ã€push()ã€top()ã€empty()</p><h3 id="3-ä»£ç ç¤ºä¾‹"><a href="#3-ä»£ç ç¤ºä¾‹" class="headerlink" title="3.ä»£ç ç¤ºä¾‹"></a>3.ä»£ç ç¤ºä¾‹</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;functional&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br> <br><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt; <span class="hljs-type">void</span> <span class="hljs-title">print_queue</span><span class="hljs-params">(T&amp; q)</span> </span>&#123;<br>    <span class="hljs-keyword">while</span>(!q.<span class="hljs-built_in">empty</span>()) &#123;<br>        std::cout &lt;&lt; q.<span class="hljs-built_in">top</span>() &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>        q.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>    std::cout &lt;&lt; <span class="hljs-string">&#x27;\n&#x27;</span>;<br>&#125;<br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    std::priority_queue&lt;<span class="hljs-type">int</span>&gt; q;<br> <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n : &#123;<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>&#125;)<br>        q.<span class="hljs-built_in">push</span>(n);<br> <br>    <span class="hljs-built_in">print_queue</span>(q);<br> <br>    std::priority_queue&lt;<span class="hljs-type">int</span>, std::vector&lt;<span class="hljs-type">int</span>&gt;, std::greater&lt;<span class="hljs-type">int</span>&gt; &gt; q2;<br> <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n : &#123;<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>&#125;)<br>        q2.<span class="hljs-built_in">push</span>(n);<br> <br>    <span class="hljs-built_in">print_queue</span>(q2);<br> <br>    <span class="hljs-comment">// ç”¨ lambda æ¯”è¾ƒå…ƒç´ ã€‚</span><br>    <span class="hljs-keyword">auto</span> cmp = [](<span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right) &#123; <span class="hljs-built_in">return</span> (left ^ <span class="hljs-number">1</span>) &lt; (right ^ <span class="hljs-number">1</span>); &#125;;<br>    std::priority_queue&lt;<span class="hljs-type">int</span>, std::vector&lt;<span class="hljs-type">int</span>&gt;, <span class="hljs-keyword">decltype</span>(cmp)&gt; <span class="hljs-built_in">q3</span>(cmp);<br> <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> n : &#123;<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>&#125;)<br>        q3.<span class="hljs-built_in">push</span>(n);<br> <br>    <span class="hljs-built_in">print_queue</span>(q3);<br> <br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<br><img src="https://s2.loli.net/2023/04/13/n4RIGtX7NACKceQ.png"><br>ä¸Šè¿°ä»£ç åŠè¿è¡Œç»“æœï¼Œä¸å‰é¢æˆ‘æ‰‹ç”»çš„é‚£ä¸¤å¼ å›¾éƒ½æ˜¯å»åˆçš„</p><hr><h1 id="å››ã€é¢˜è§£"><a href="#å››ã€é¢˜è§£" class="headerlink" title="å››ã€é¢˜è§£"></a>å››ã€é¢˜è§£</h1><p>å›åˆ°å¼€å¤´é‚£é“topKåŠ›æ‰£é¢˜ï¼Œç­”æ¡ˆå¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// å°é¡¶å †</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">mycomparison</span> <br>    &#123;<br>        <span class="hljs-keyword">public</span>:<br>            <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-type">const</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&amp; lhs, <span class="hljs-type">const</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&amp; rhs)</span> </span><br><span class="hljs-function">            </span>&#123;<br>                <span class="hljs-keyword">return</span> lhs.second &gt; rhs.second;<br>            &#125;<br>    &#125;;<br><br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">topKFrequent</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> k)</span> </span>&#123;<br><br>        unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; map; <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> iter : nums) &#123;<br>            map[iter]++;<br>        &#125;<br><br>        <span class="hljs-comment">// å¯¹é¢‘ç‡æ’åº</span><br>        <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå°é¡¶å †ï¼Œå¤§å°ä¸ºk</span><br>        priority_queue&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;, vector&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt;, mycomparison&gt; pri_que;<br><br>        <span class="hljs-comment">// ç”¨å›ºå®šå¤§å°ä¸ºkçš„å°é¡¶å †ï¼Œæ‰«é¢æ‰€æœ‰é¢‘ç‡çš„æ•°å€¼</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = map.<span class="hljs-built_in">begin</span>(); it != map.<span class="hljs-built_in">end</span>(); it++) <br>        &#123;<br>            pri_que.<span class="hljs-built_in">push</span>(*it);<br>            <span class="hljs-keyword">if</span> (pri_que.<span class="hljs-built_in">size</span>() &gt; k) &#123; <span class="hljs-comment">// å¦‚æœå †çš„å¤§å°å¤§äºäº†Kï¼Œåˆ™é˜Ÿåˆ—å¼¹å‡ºï¼Œä¿è¯å †çš„å¤§å°ä¸€ç›´ä¸ºk</span><br>                pri_que.<span class="hljs-built_in">pop</span>();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// æ‰¾å‡ºå‰Kä¸ªé«˜é¢‘å…ƒç´ ï¼Œå› ä¸ºå°é¡¶å †å…ˆå¼¹å‡ºçš„æ˜¯æœ€å°çš„ï¼Œæ‰€ä»¥å€’åºæ¥è¾“å‡ºåˆ°æ•°ç»„</span><br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">result</span><span class="hljs-params">(k)</span></span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = k - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>            result[i] = pri_que.<span class="hljs-built_in">top</span>().first;<br>            pri_que.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>åšä¸€äº›è§£é‡Šè¯´æ˜ï¼š</p><ol><li><p>é¦–å…ˆæ³¨æ„ï¼Œæˆ‘ä»¬è¦<strong>æ‰¾å‡ºå‰Kå¤§çš„å…ƒç´ ï¼Œé‚£è¦ç”¨çš„æ˜¯å°é¡¶å †</strong>ï¼Œå› ä¸ºå°é¡¶å †æ‰èƒ½æŠŠå°å…ƒç´ æ’å‡ºå»ï¼Œå‰©ä¸‹çš„å°±æ˜¯å‰Kå¤§å…ƒç´ å˜›</p></li><li><p>mapä¸­çš„å•ä¸ªå…ƒç´ çš„æ•°æ®ç±»å‹æ˜¯pair&lt;Type, Type&gt;</p></li><li><p>å…³äºcompareæ–¹æ³•çš„ç†è§£ï¼šé»˜è®¤çš„<strong>lessæ–¹æ³•å»ºç«‹çš„æ˜¯å¤§é¡¶å †</strong>ï¼Œè¦<strong>å»ºç«‹å°é¡¶å †åˆ™æ”¹ç”¨greater&lt;T&gt;</strong></p><p>ç„¶åæ‰€è°“çš„lessæ–¹æ³•ï¼Œæ˜¯å°†ç¬¬ä¸€ä¸ªå®å‚ï¼ˆç§°ä¹‹ä¸ºå·¦å®å‚ï¼‰ä¸ç¬¬äºŒä¸ªå®å‚ï¼ˆç§°ä¹‹ä¸ºå³å®å‚ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œreturn left&lt;rightâ€”â€”é‚£ä¹ˆå·¦å®å‚æ›´å°æ—¶åˆ™ä¸ºtrueï¼Œä¸ºtrueåˆ™äº¤æ¢ï¼›greateræ–¹æ³•åä¹‹ï¼Œreturn left&gt;rightï¼›</p><p>åœ¨ä¸Šè¿°ä»£ç çš„è‡ªå®šä¹‰æ–¹æ³•mycomparisonä¸­ä¹Ÿå¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ï¼Œå®ƒä½¿ç”¨çš„æ˜¯return left&gt;right,å³greateræ–¹æ³•ï¼Œå³å»ºç«‹å°é¡¶å †</p></li></ol><blockquote><p>æ€»ç»“ï¼š<br>å»ºç«‹å¤§é¡¶å † &#x3D; lessæ–¹æ³• &#x3D; return left &lt; right<br>å»ºç«‹å°é¡¶å † &#x3D; greateræ–¹æ³• &#x3D; return left &gt; right</p></blockquote><div class="note note-warning">            <p>TO-DOï¼š<br>ä¸Šè¿°ç¬¬ä¸‰æ¡çº¯å±è‡ªå·±ç†è§£ï¼Œè¿™ä¹ˆæ­»è®°ç”¨æ¥åšé¢˜åº”ç”¨æ²¡å•¥é—®é¢˜ï¼Œä½†è¿˜æ˜¯å¾—æŒ‘ä¸ªè‰¯è¾°å‰æ—¥å»ç¿»ç¿»æºç æ‰è¡ŒæğŸ˜£</p>          </div>]]></content>
    
    
    <categories>
      
      <category>è‡ªå·±äº‹æƒ…é è‡ªå·±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>c++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>leetcode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å€Ÿä¸€é“leetcodeæ€è€ƒæ€»ç»“map/setçš„åº”ç”¨åŠåŒºåˆ«</title>
    <link href="/2023/04/13/%E5%80%9F%E4%B8%80%E9%81%93leetcode%E6%80%9D%E8%80%83%E6%80%BB%E7%BB%93mapset%E7%9A%84%E5%BA%94%E7%94%A8%E5%8F%8A%E5%8C%BA%E5%88%AB/"/>
    <url>/2023/04/13/%E5%80%9F%E4%B8%80%E9%81%93leetcode%E6%80%9D%E8%80%83%E6%80%BB%E7%BB%93mapset%E7%9A%84%E5%BA%94%E7%94%A8%E5%8F%8A%E5%8C%BA%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åŸé¢˜æ˜¯leetcode349ï¼Œè¦æ±‚ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</p><p><img src="https://s2.loli.net/2023/04/13/WmNqiBn9R6Lh7f4.png" alt=" "><br>è¿™é¢˜æœ¬èº«ä¸éš¾ï¼Œä¸»è¦æ˜¯è¦è€ƒè™‘åˆ°ï¼š</p><ol><li>åŸé¢˜åªéœ€æ±‚â€œé¢‘ç‡â€ï¼Œæ— éœ€è€ƒè™‘â€œé¡ºåºâ€ï¼Œåˆ™åº”ä½¿ç”¨å“ˆå¸Œè¡¨ç»“æ„ï¼Œè€Œä¸æ˜¯é¡ºåºç»“æ„+ä¸¤ä¸ªforæš´åŠ›éå†</li><li>ç”¨äºä½œé”®å€¼keyçš„æ˜¯æ•°å­—è€Œéå­—æ¯ï¼Œæ‰€ä»¥åº”è¯¥ç”¨æ­£å„¿å…«ç»çš„set&#x2F;mapï¼Œè€Œä¸æ˜¯ç”¨vectoræä¼ªhashï¼ˆå¦åˆ™å½“æ•°å­—é”®å€¼å¾ˆå¤§ä¸”ç¨€ç–æ—¶ï¼Œvectorä¼šæµªè´¹å¤§é‡ç©ºé—´ï¼‰ </li><li>ä¸éœ€è¦è®¾ç½®æ˜ç¡®çš„keyï¼Œæ‰€ä»¥ç”¨setï¼Œè€Œä¸æ˜¯map</li><li>ä¸è€ƒè™‘é¡ºåºï¼Œæ‰€ä»¥ç”¨unordered_set</li></ol><p>ä¸Šè¿°æ€è·¯ç†æ¸…ä¹‹åï¼Œä»£ç è‡ªç„¶å°±å‡ºæ¥äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">intersection</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums1, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums2)</span> </span><br><span class="hljs-function">    </span>&#123;<br>        unordered_set&lt;<span class="hljs-type">int</span>&gt; result_set; <span class="hljs-comment">// å­˜æ”¾ç»“æœï¼Œä¹‹æ‰€ä»¥ç”¨setæ˜¯ä¸ºäº†ç»™ç»“æœé›†å»é‡</span><br>        <span class="hljs-function">unordered_set&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">nums_set</span><span class="hljs-params">(nums1.begin(), nums1.end())</span></span>;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> iter : nums2) <br>        &#123;<br>            <span class="hljs-comment">// å‘ç°nums2çš„å…ƒç´  åœ¨nums_seté‡Œåˆå‡ºç°è¿‡</span><br>            <span class="hljs-keyword">if</span> (nums_set.<span class="hljs-built_in">find</span>(iter) != nums_set.<span class="hljs-built_in">end</span>()) <br>            &#123;<br>                result_set.<span class="hljs-built_in">insert</span>(iter); <br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;(result_set.<span class="hljs-built_in">begin</span>(), result_set.<span class="hljs-built_in">end</span>());<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤é¢˜æˆ‘ä»¬å¯ä»¥ä¸€çª¥set&#x2F;mapçš„å…·ä½“ä½¿ç”¨åœºæ™¯ï¼Œä¸‹é¢å¯¹å…¶å·®åˆ«å’Œåº”ç”¨è¿›è¡Œç®€å•æ€»ç»“</p><hr><h1 id="ä¸€ã€å®šä¹‰å’Œç±»å‹"><a href="#ä¸€ã€å®šä¹‰å’Œç±»å‹" class="headerlink" title="ä¸€ã€å®šä¹‰å’Œç±»å‹"></a>ä¸€ã€å®šä¹‰å’Œç±»å‹</h1><p>STLä¸­çš„éƒ¨åˆ†å®¹å™¨ï¼ˆvectorã€listã€dequeç­‰ï¼‰åº•å±‚ä¸ºçº¿æ€§åºåˆ—çš„æ•°æ®ç»“æ„ï¼Œæ•…å°†è¿™äº›å®¹å™¨ç»Ÿç§°ä¸º<strong>åºåˆ—å¼å®¹å™¨</strong>ï¼Œé‡Œé¢å­˜å‚¨çš„æ˜¯å…ƒç´ æœ¬èº«ï¼›å¯¹åº”çš„ï¼Œæœ‰å¦å¤–ä¸€ç§ç”¨&lt;keyï¼Œvalue&gt;é”®å€¼å¯¹æ–¹å¼å‚¨å­˜æ•°æ®çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ç§°å…¶ä¸º<strong>å…³è”å¼å®¹å™¨</strong>ï¼Œå…¸å‹çš„æœ‰setç±»å’Œmapç±»å®¹å™¨ã€‚</p><p>è¿™ç§å…³è”å¼å®¹å™¨çš„motivitionåº”è¯¥æ˜¯ç”¨æŸç§ç‰¹æ®Šçš„åº•å±‚æ•°æ®ç»“æ„æ¥ä»£æ›¿çº¿æ€§åºåˆ—ï¼Œä»¥é¿å…çº¿æ€§ç»“æ„å®¹æ˜“å¯¼è‡´çš„ç©ºé—´æµªè´¹é—®é¢˜ï¼ŒåŒæ—¶æé«˜curdæ•ˆç‡ â€“ â€“ çº¿æ€§åºåˆ—ä¸ºO(n)ï¼Œé‚£å†æé«˜å°±æ˜¯O(log n)å’ŒO(1)ï¼Œå¯¹åº”çš„æ˜¯å•¥æï¼Ÿ</p><p><em><strong>æ ‘å’Œhash tableå˜›ï¼è¿™ä¹Ÿæ­£æ˜¯set\mapçš„åº•å±‚å®ç°æ–¹å¼</strong></em></p><p>å…·ä½“å¦‚ä¸‹ï¼š</p><table><thead><tr><th>é›†åˆ</th><th>åº•å±‚å®ç°</th><th>æ˜¯å¦æœ‰åº</th><th>æ•°å€¼å¯é‡å¤</th><th>æ•°å€¼å¯æ›´æ”¹</th><th>curdæ•ˆç‡</th></tr></thead><tbody><tr><td>std::set</td><td>çº¢é»‘æ ‘</td><td>æœ‰åº</td><td>å¦</td><td>å¦</td><td>O(log n)</td></tr><tr><td>std::multiset</td><td>çº¢é»‘æ ‘</td><td>æœ‰åº</td><td>æ˜¯</td><td>å¦</td><td>O(logn)</td></tr><tr><td>std::unordered_set</td><td>å“ˆå¸Œè¡¨</td><td>æ— åº</td><td>å¦</td><td>å¦</td><td>O(1)</td></tr></tbody></table><table><thead><tr><th>é›†åˆ</th><th>åº•å±‚å®ç°</th><th>æ˜¯å¦æœ‰åº</th><th>æ•°å€¼å¯é‡å¤</th><th>æ•°å€¼å¯æ›´æ”¹</th><th>curdæ•ˆç‡</th></tr></thead><tbody><tr><td>std::map</td><td>çº¢é»‘æ ‘</td><td>æœ‰åº</td><td>keyä¸å¯é‡å¤</td><td>å¦</td><td>O(log n)</td></tr><tr><td>std::multimap</td><td>çº¢é»‘æ ‘</td><td>æœ‰åº</td><td>keyå¯é‡å¤</td><td>å¦</td><td>O(logn)</td></tr><tr><td>std::unordered_set</td><td>å“ˆå¸Œè¡¨</td><td>æ— åº</td><td>keyä¸å¯é‡å¤</td><td>å¦</td><td>O(1)</td></tr></tbody></table><p>å…¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œset\multiset\map\multimapçš„å®ç°éƒ½ä¸ºçº¢é»‘æ ‘ï¼Œçº¢é»‘æ ‘æ˜¯ä¸€ç§å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œæ‰€ä»¥keyæœ‰åºä¸”ä¸èƒ½ä¿®æ”¹ï¼Œä¿®æ”¹keyä¼šå¯¼è‡´æ•´æ£µæ ‘çš„é”™ä¹±ï¼›<br>è€Œæˆ‘ä»¬è¦ç”¨é›†åˆæ¥è§£å†³hashé—®é¢˜æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨unorderedï¼Œå› ä¸ºå…¶åº•å±‚ä½¿ç”¨hash tableï¼Œcurdæ•ˆç‡æœ€é«˜ï¼ˆåªéœ€æ‰§è¡Œä¸€æ¬¡hash functionï¼Œå¤æ‚åº¦ä¸ºO(1)ï¼‰</p><hr><h1 id="äºŒã€setç±»è¯´æ˜"><a href="#äºŒã€setç±»è¯´æ˜" class="headerlink" title="äºŒã€setç±»è¯´æ˜"></a>äºŒã€setç±»è¯´æ˜</h1><ol><li>ä¸map&#x2F;multimapä¸åŒï¼Œmapä¸­å­˜å‚¨çš„æ˜¯çœŸæ­£çš„é”®å€¼å¯¹&lt;key, value&gt;ï¼Œsetä¸­åªæ”¾valueï¼Œä½†åœ¨åº•å±‚å®é™…å­˜æ”¾çš„æ˜¯ç”±&lt;value, value&gt;æ„æˆçš„é”®å€¼å¯¹ï¼ˆå³ä¸€ä¸ªå…ƒç´ çš„valueåŒæ—¶ä¹Ÿä¼šæ ‡è¯†å®ƒï¼Œvalueå°±æ˜¯keyï¼‰ã€‚æ•…setä¸­æ’å…¥å…ƒç´ æ—¶ï¼Œ<strong>åªéœ€è¦æ’å…¥valueå³å¯ï¼Œä¸éœ€è¦æ„é€ é”®å€¼å¯¹</strong></li><li>setä¸­çš„å…ƒç´ ä¸å¯ä»¥é‡å¤ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨setè¿›è¡Œ<strong>å»é‡</strong></li><li>setä¸­çš„å…ƒç´ æœ‰åºï¼ˆé»˜è®¤å‡åºï¼‰ï¼Œæ•…å¯ç”¨iteration<strong>éå†setå¾—æœ‰åºåºåˆ—</strong></li><li>setä¸­çš„å…ƒç´ <strong>ä¸å…è®¸ä¿®æ”¹</strong>ï¼ˆå…ƒç´ æ€»æ˜¯constï¼‰</li><li>setä¸­çš„count()æ–¹æ³•åªèƒ½è¿”å›0æˆ–1ï¼Œæ‰€ä»¥å…¶å®å°±æ˜¯ä¸ªfind()ã€‚ã€‚è€Œfind()è¿”å›çš„æ˜¯æŸ¥æ‰¾å…ƒç´ çš„ä½ç½®æŒ‡é’ˆï¼Œæ²¡æœ‰åˆ™è¿”å›set.end()</li><li>multisetä¸setçš„åŒºåˆ«æ˜¯<strong>å‰è€…ä¸­çš„å…ƒç´ å¯é‡å¤</strong>ï¼Œå…¶å®ƒéƒ½ä¸€æ ·</li><li>unordered_setä¸setçš„åŒºåˆ«æ˜¯<strong>å‰è€…ä¸­çš„å…ƒç´ ä¸ä¼šæ’åº</strong></li></ol><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;set&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unordered_set&gt;</span></span><br><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">TestSet</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">// ç”¨æ•°ç»„arrayä¸­çš„å…ƒç´ æ„é€ set</span><br><span class="hljs-type">int</span> array[] = &#123; <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span> &#125;;<br>set&lt;<span class="hljs-type">int</span>&gt; s;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> e : array)<br>s.<span class="hljs-built_in">insert</span>(e);<br><br>cout &lt;&lt; <span class="hljs-string">&quot;setä¸­çš„å…ƒç´ ä¸ªæ•°ä¸º: &quot;</span> &lt;&lt; s.<span class="hljs-built_in">size</span>() &lt;&lt; endl;<br><br><span class="hljs-comment">// æ­£å‘æ‰“å°setä¸­çš„å…ƒç´ ï¼Œä»æ‰“å°ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼šsetå¯å»é‡</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;æ­£å‘æ‰“å°setä¸­çš„å…ƒç´ : &quot;</span> ;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; e : s)<br>cout&lt;&lt; e &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>cout &lt;&lt; endl;<br><br><span class="hljs-comment">// ä½¿ç”¨è¿­ä»£å™¨é€†å‘æ‰“å°setä¸­çš„å…ƒç´ </span><br>    cout &lt;&lt; <span class="hljs-string">&quot;é€†å‘æ‰“å°setä¸­çš„å…ƒç´ : &quot;</span> ;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = s.<span class="hljs-built_in">rbegin</span>(); it != s.<span class="hljs-built_in">rend</span>(); ++it)<br>cout &lt;&lt; *it &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>cout &lt;&lt; endl;<br><br><span class="hljs-comment">// setä¸­å€¼ä¸º3çš„å…ƒç´ å‡ºç°äº†å‡ æ¬¡</span><br>cout &lt;&lt; <span class="hljs-string">&quot;setä¸­å€¼ä¸ºxçš„å…ƒç´ å‡ºç°äº†å‡ æ¬¡ï¼š&quot;</span> &lt;&lt; s.<span class="hljs-built_in">count</span>(<span class="hljs-number">0</span>) &lt;&lt; endl;<br><br>    <span class="hljs-function">multiset&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">muls</span><span class="hljs-params">(array, array + <span class="hljs-keyword">sizeof</span>(array) / <span class="hljs-keyword">sizeof</span>(array[<span class="hljs-number">0</span>]))</span></span>;<br>    cout &lt;&lt;  <span class="hljs-string">&quot;æ­£å‘æ‰“å°multisetä¸­çš„å…ƒç´ : &quot;</span> ;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; e : muls)<br>cout &lt;&lt;e &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>cout &lt;&lt; endl;<br><br>    <span class="hljs-function">unordered_set&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">unorders</span><span class="hljs-params">(array, array + <span class="hljs-keyword">sizeof</span>(array) / <span class="hljs-keyword">sizeof</span>(array[<span class="hljs-number">0</span>]))</span></span>;<br>    cout &lt;&lt;  <span class="hljs-string">&quot;æ‰“å°unordered_setä¸­çš„å…ƒç´ : &quot;</span> ;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; e : unorders)<br>cout &lt;&lt;e &lt;&lt; <span class="hljs-string">&quot; &quot;</span>;<br>cout &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">TestSet</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<br> <img src="https://s2.loli.net/2023/04/13/w8kQyJztoIBaq1E.png"></p><hr><h1 id="ä¸‰ã€mapç±»è¯´æ˜"><a href="#ä¸‰ã€mapç±»è¯´æ˜" class="headerlink" title="ä¸‰ã€mapç±»è¯´æ˜"></a>ä¸‰ã€mapç±»è¯´æ˜</h1><ol><li>éœ€è¦<strong>æ„é€ é”®å€¼å¯¹</strong></li><li>mapæ”¯æŒä¸‹æ ‡è®¿é—®ç¬¦ï¼Œå³åœ¨[]ä¸­æ”¾å…¥keyï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸keyå¯¹åº”çš„valueï¼›ä¹Ÿæ”¯æŒ.at()æ–¹æ³•ï¼Œä½†äºŒè€…æœ‰æ‰€ä¸åŒï¼ˆè§ä¸‹é¢ä»£ç ï¼‰</li><li>multimapå’Œmapçš„å”¯ä¸€ä¸åŒå°±æ˜¯ï¼šmapä¸­çš„<strong>keyæ˜¯å”¯ä¸€</strong>çš„ï¼Œè€Œmultimapä¸­keyæ˜¯<strong>å¯ä»¥é‡å¤çš„</strong></li><li>unordered_mapå’Œmap : : unordered_mapå­˜å‚¨å…ƒç´ æ—¶æ˜¯<strong>æ²¡æœ‰é¡ºåºçš„</strong>ï¼Œåªæ˜¯æ ¹æ®keyçš„å“ˆå¸Œå€¼ï¼Œå°†å…ƒç´ å­˜åœ¨æŒ‡å®šä½ç½®ï¼Œæ‰€ä»¥æ ¹æ®keyæŸ¥æ‰¾å•ä¸ªvalueæ—¶éå¸¸é«˜æ•ˆ</li></ol><p>ä»£ç ç¤ºä¾‹ï¼ˆæ¥æº: <a href="https://blog.csdn.net/qq_61635026/article/details/126070134?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166593410616782412589556%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=166593410616782412589556&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-6-126070134-null-null.142%5Ev56%5Econtrol_1,201%5Ev3%5Econtrol_2&utm_term=stl%20set%E5%92%8Cmap%E7%9A%84%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">C++ STLä¸­ setå’Œmapä»‹ç»ä»¥åŠä½¿ç”¨æ–¹æ³•</a>ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;set&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br> <br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">TestMap</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>map&lt;string, string&gt; m;<br><span class="hljs-comment">// å‘mapä¸­æ’å…¥å…ƒç´ çš„æ–¹å¼ï¼š</span><br><span class="hljs-comment">// å°†é”®å€¼å¯¹&lt;&quot;peach&quot;,&quot;æ¡ƒå­&quot;&gt;æ’å…¥mapä¸­ï¼Œç”¨pairç›´æ¥æ¥æ„é€ é”®å€¼å¯¹</span><br>m.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">pair</span>&lt;string, string&gt;(<span class="hljs-string">&quot;peach&quot;</span>, <span class="hljs-string">&quot;æ¡ƒå­&quot;</span>));<br><span class="hljs-comment">// å°†é”®å€¼å¯¹&lt;&quot;peach&quot;,&quot;æ¡ƒå­&quot;&gt;æ’å…¥mapä¸­ï¼Œç”¨make_pairå‡½æ•°æ¥æ„é€ é”®å€¼å¯¹</span><br>m.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(<span class="hljs-string">&quot;banan&quot;</span>, <span class="hljs-string">&quot;é¦™è•‰&quot;</span>));<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">operator[]çš„åŸç†æ˜¯ï¼š</span><br><span class="hljs-comment"> ç”¨&lt;key, T()&gt;æ„é€ ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç„¶åè°ƒç”¨insert()å‡½æ•°å°†è¯¥é”®å€¼å¯¹æ’å…¥åˆ°mapä¸­</span><br><span class="hljs-comment"> å¦‚æœkeyå·²ç»å­˜åœ¨ï¼Œæ’å…¥å¤±è´¥ï¼Œinsertå‡½æ•°è¿”å›è¯¥keyæ‰€åœ¨ä½ç½®çš„è¿­ä»£å™¨</span><br><span class="hljs-comment"> å¦‚æœkeyä¸å­˜åœ¨ï¼Œæ’å…¥æˆåŠŸï¼Œinsertå‡½æ•°è¿”å›æ–°æ’å…¥å…ƒç´ æ‰€åœ¨ä½ç½®çš„è¿­ä»£å™¨</span><br><span class="hljs-comment"> operator[]å‡½æ•°æœ€åå°†insertè¿”å›å€¼é”®å€¼å¯¹ä¸­çš„valueè¿”å›</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// å°†&lt;&quot;apple&quot;, &quot;&quot;&gt;æ’å…¥mapä¸­ï¼Œæ’å…¥æˆåŠŸï¼Œè¿”å›valueçš„å¼•ç”¨ï¼Œå°†â€œè‹¹æœâ€èµ‹å€¼ç»™è¯¥å¼•ç”¨ç»“æœ</span><br>m[<span class="hljs-string">&quot;apple&quot;</span>] = <span class="hljs-string">&quot;è‹¹æœ&quot;</span>;<br><br><span class="hljs-comment">// keyä¸å­˜åœ¨æ—¶æŠ›å¼‚å¸¸</span><br><span class="hljs-comment">//m.at(&quot;waterme&quot;) = &quot;æ°´èœœæ¡ƒ&quot;;</span><br><br>cout &lt;&lt; m.<span class="hljs-built_in">size</span>() &lt;&lt; endl;<br><span class="hljs-comment">// ç”¨è¿­ä»£å™¨å»éå†mapä¸­çš„å…ƒç´ ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæŒ‰ç…§keyæ’åºçš„åºåˆ—</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; e : m)<br>cout &lt;&lt; e.first &lt;&lt; <span class="hljs-string">&quot;---&gt;&quot;</span> &lt;&lt; e.second &lt;&lt; endl;<br>cout &lt;&lt; endl;<br><span class="hljs-comment">// mapä¸­çš„é”®å€¼å¯¹keyä¸€å®šæ˜¯å”¯ä¸€çš„ï¼Œå¦‚æœkeyå­˜åœ¨å°†æ’å…¥å¤±è´¥</span><br><span class="hljs-keyword">auto</span> ret = m.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(<span class="hljs-string">&quot;peach&quot;</span>, <span class="hljs-string">&quot;anotheræ¡ƒå­&quot;</span>));<br><span class="hljs-keyword">if</span> (ret.second)<br>cout &lt;&lt; <span class="hljs-string">&quot;&lt;peach, anotheræ¡ƒå­&gt;ä¸åœ¨mapä¸­, å·²ç»æ’å…¥&quot;</span> &lt;&lt; endl;<br><span class="hljs-keyword">else</span><br>cout &lt;&lt; <span class="hljs-string">&quot;é”®å€¼ä¸ºpeachçš„å…ƒç´ å·²ç»å­˜åœ¨ï¼š&quot;</span> &lt;&lt; ret.first-&gt;first &lt;&lt; <span class="hljs-string">&quot;---&gt;&quot;</span><br>&lt;&lt; ret.first-&gt;second &lt;&lt; <span class="hljs-string">&quot; æ’å…¥å¤±è´¥&quot;</span> &lt;&lt; endl;<br><span class="hljs-comment">// åˆ é™¤keyä¸º&quot;apple&quot;çš„å…ƒç´ </span><br>m.<span class="hljs-built_in">erase</span>(<span class="hljs-string">&quot;apple&quot;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-number">1</span> == m.<span class="hljs-built_in">count</span>(<span class="hljs-string">&quot;apple&quot;</span>))<br>cout &lt;&lt; <span class="hljs-string">&quot;appleè¿˜åœ¨&quot;</span> &lt;&lt; endl;<br><span class="hljs-keyword">else</span><br>cout &lt;&lt; <span class="hljs-string">&quot;appleè¢«åƒäº†&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">TestMap</span>();<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p> <img src="https://s2.loli.net/2023/04/13/A3rM12B8DJKzVS7.png"><br>å¦‚æœç”¨at()æŸ¥å€¼ï¼Œåˆ™keyä¸åœ¨æ—¶æŠ›å‡ºå¼‚å¸¸</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">m.<span class="hljs-built_in">at</span>(<span class="hljs-string">&quot;waterme&quot;</span>) = <span class="hljs-string">&quot;æ°´èœœæ¡ƒ&quot;</span>;<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/04/13/bMPIHgarpTBKlu1.png"></p><hr><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><strong>1. ç”¨setç±»è¿˜æ˜¯mapç±»ï¼Ÿ</strong><br>å¦‚æœéœ€è¦å»ºç«‹æ˜ç¡®çš„<strong>é”®å€¼å¯¹åº”å…³ç³»</strong>ï¼ˆå¦‚ç¤ºä¾‹ä¸­çš„æ°´æœï¼‰ï¼Œé‚£åªèƒ½ç”¨mapï¼›å¦‚æœåªéœ€çŸ¥é“â€œ<strong>å­˜åœ¨ä¸å¦</strong>â€ï¼Œé‚£ç”¨setå°±å¤Ÿäº†ï¼ˆå¦‚leetcodeä¾‹é¢˜ï¼Œå…¶å®æ²¡æœ‰ä½“ç°ä¸€ä¸ªæ˜ç¡®çš„keyï¼Œcodingæ—¶å…³å¿ƒçš„ä¹Ÿæ˜¯valueè€Œä¸æ˜¯keyï¼‰</p><p><strong>2. ç”¨setç±»è¿˜æ˜¯arrayä¼ªhashï¼Ÿ</strong><br>å¦‚æœkeyåˆ†å¸ƒåœ¨ä¸€ä¸ª<strong>ä¸å¤§çš„è¿ç»­åŒºé—´</strong>å†…ï¼ˆ å¦‚26ä¸ªå­—æ¯ï¼‰ï¼Œåˆ™å¯ä»¥ç›´æ¥ç”¨arrayï¼Œè¿™æ ·æ›´å¿«ï¼Œå› ä¸ºsetä¸ä»…å ç”¨ç©ºé—´æ¯”æ•°ç»„å¤§ï¼Œè€Œä¸”é€Ÿåº¦è¦æ¯”æ•°ç»„æ…¢ï¼ŒsetæŠŠæ•°å€¼æ˜ å°„åˆ°keyä¸Šéƒ½è¦åšhashè®¡ç®—çš„ï¼›<br>ä½†å¦‚æœkeyéšæœºåˆ™ç”¨setï¼Œå¦‚keyä¸º<strong>åˆ†å¸ƒç¨€ç–</strong>çš„å¤§æ•°å­—æ—¶ï¼Œç”¨æ•°ç»„å°±éå¸¸æµªè´¹ç©ºé—´ï¼Œåªèƒ½ç”¨setã€‚</p><p><strong>3. ç”¨setè¿˜æ˜¯unordered_setï¼Ÿï¼ˆmapåŒç†ï¼‰</strong><br>æœ‰åºsetï¼ˆçº¢é»‘æ ‘ï¼‰ï¼Œæ— åºunordered_setï¼ˆhash tableï¼‰</p><p><strong>PS.</strong> pyä¸­çš„inå…³é”®å­—åœ¨ä¸åŒç»“æ„ä¸­ï¼ˆtuple, list, dict, setï¼‰æŸ¥æ‰¾å…ƒç´ æ—¶æ•ˆç‡æ˜¯ç›¸å·®å¾ˆå¤§çš„ï¼Œå› ä¸ºdict, setåº•å±‚æ˜¯ä¸€ä¸ªhash tableï¼›è€Œtuple, liståªæ˜¯ä¸€ä¸ªå•çº¯ç±»äºæ•°ç»„çš„çº¿æ€§ç»“æ„ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è‡ªå·±äº‹æƒ…é è‡ªå·±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>c++</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>å“ˆå¸Œç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†ç±»å å‘2</title>
    <link href="/2023/04/13/%E5%8D%A0%E4%B8%AA%E5%9D%912/"/>
    <url>/2023/04/13/%E5%8D%A0%E4%B8%AA%E5%9D%912/</url>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡æ–‡ç« åªæ˜¯ä¸ºäº†åœ¨åˆ†ç±»æ¿å—ä¸­å ä¸ªå‘ğŸ˜†ğŸ˜†</p><p>é¡ºä¾¿ä½œä¸ºæµ‹è¯•</p><p>è¿™æ˜¯ä¸€å¥è¯<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="å‚è€ƒèµ„æ–™1">[1]</span></a></sup></p><p>$$<br>E&#x3D;mc^2<br>$$</p><div class="note note-warning">            <p>æ–‡å­— æˆ–è€… <code>markdown</code> å‡å¯</p>          </div><p class="note note-primary">æ ‡ç­¾</p><span class="label label-primary">text</span><p><span class="label label-primary">Label</span></p>            <input type="checkbox" disabled checked="checked">text          <a class="btn" href="url"  title="title" target="_blank">text</a><p><a class="btn" href="url" title="title">text</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>$$</p><p>$$<section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>è¿™æ˜¯å¯¹åº”çš„è„šæ³¨<br><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:1" class="footnote-text"><span>å‚è€ƒèµ„æ–™1<br><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>å‚è€ƒèµ„æ–™2<br><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section></p>]]></content>
    
    
    <categories>
      
      <category>å¶å°”ä¹Ÿå¾—æ‘¸æ‘¸é±¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
      <tag>leetcode</tag>
      
      <tag>bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°ä½è¿ç®—ç¬¦(ï¼ï¼)ä½¿ç”¨ä¸å½“å¼•èµ·çš„ä¸€æ¬¡bug</title>
    <link href="/2023/04/13/%E8%AE%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6(%EF%BC%9E%EF%BC%9E)%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93%E5%BC%95%E8%B5%B7%E7%9A%84%E4%B8%80%E6%AC%A1bug/"/>
    <url>/2023/04/13/%E8%AE%B0%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6(%EF%BC%9E%EF%BC%9E)%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BD%93%E5%BC%95%E8%B5%B7%E7%9A%84%E4%B8%80%E6%AC%A1bug/</url>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>ä»Šå¤©åˆ·leetcodeæ—¶é‡åˆ°ä¸ªæ­»æ´»ä¹Ÿæƒ³ä¸é€šçš„bug</p><p>åŸé¢˜å¾ˆç®€å•ï¼Œçº¿æ€§æ•°ç»„æ’å€¼é—®é¢˜ï¼Œæš´åŠ›éå†å’ŒäºŒåˆ†æ³•éƒ½å¯ä»¥åš</p><p> <img src="https://s2.loli.net/2023/04/13/ifSOReA2dapUFsh.png"><br>ä¸å‡æ€ç´¢ç”¨åŒºé—´å·¦é—­å³å¼€çš„äºŒåˆ†æ³•ï¼Œä¸‰ä¸‹äº”é™¤äºŒå°±æ•´äº†å‡ºæ¥ï¼Œèƒ¸æœ‰æˆç«¹ğŸ˜‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br>public:<br>    <span class="hljs-type">int</span> <span class="hljs-title function_">searchInsert</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.size();<br>        <span class="hljs-keyword">while</span>(left &lt; right)<br>        &#123;<br>            <span class="hljs-type">int</span> middle = left + (right - left) &gt;&gt; <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span> (nums[middle] &gt; target )<br>                right = middle;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[middle] &lt; target )<br>                left = middle + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> middle;<br>        &#125;<br>        <span class="hljs-keyword">return</span> right;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>è°çŸ¥æäº¤æ—¶ä¸€ç›´åœ¨ç¤ºä¾‹3ï¼ˆå³è¾“å…¥æ•°ç»„ä¸º[1 3 5 6]ï¼ŒæŸ¥è¯¢å€¼target &#x3D; 7ï¼‰å¡bugï¼Œæç¤ºè¶…æ—¶ã€‚ã€‚</p><hr><h1 id="åŸå› åˆ†æï¼š"><a href="#åŸå› åˆ†æï¼š" class="headerlink" title="åŸå› åˆ†æï¼š"></a>åŸå› åˆ†æï¼š</h1><p>åŸä»¥ä¸ºæ˜¯åŒºé—´è¾¹ç•Œæ¡ä»¶è®¾ç½®ä¸å½“ï¼Œåå¤æ£€æŸ¥ï¼Œæ‰‹åŠ¨æ¼”ç®—ï¼Œè„‘è¢‹æƒ³ç ´äº†ä¹Ÿè§‰å¾—æ²¡é—®é¢˜ã€‚ã€‚</p><p>æ— å¥ˆdebugï¼Œå‘ç°æ‰§è¡Œè¿™ä¸€å¥åï¼Œmiddleä¸€å€¼å˜åŒ–å¾ˆå¥‡æ€ªã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> middle = left + (right - left) &gt;&gt; <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p>çªç„¶è™èº¯ä¸€éœ‡ï¼Œæ„è¯†åˆ°å¯èƒ½æ˜¯è¿ç®—ç¬¦ä¼˜å…ˆçº§ä¸€é—®é¢˜ï¼Œé€Ÿgoogleä¹‹ï¼Œæœç„¶ï¼</p><p><img src="https://s2.loli.net/2023/04/13/ildhp5643oy9vXw.png"></p><p><em><strong>åŸæ¥åŠ å‡ç¬¦çš„ä¼˜å…ˆçº§æ˜¯è¦é«˜äºä½è¿ç®—ç¬¦çš„ï¼</strong></em><br>ä¸€éªŒè¯å‘ç°ä¹Ÿçš„ç¡®å¦‚æ­¤<br><img src="https://s2.loli.net/2023/04/13/r8KHytNjmulQXIv.png"></p><p><img src="https://s2.loli.net/2023/04/13/pCmWrFxzQE8AY1T.png"></p><hr><h1 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h1><p>åŠ ä¸ªæ‹¬å·å³å¯</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> middle = left +( (right - left) &gt;&gt; <span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><p>é—®é¢˜è§£å†³ï¼Œé¡ºåˆ©é€šå…³ï¼</p><p><img src="https://s2.loli.net/2023/04/13/vtzFBo3YmZqg4XV.png"></p><hr><h1 id="æ€»ç»“åæ€ï¼š"><a href="#æ€»ç»“åæ€ï¼š" class="headerlink" title="æ€»ç»“åæ€ï¼š"></a>æ€»ç»“åæ€ï¼š</h1><ol><li>å–„äºä½¿ç”¨æ‹¬å·ï¼Œå°¤å…¶æ˜¯ä¸»è§‚ä¸Šå¸Œæœ›æŸä¸ªå¼å­éƒ¨åˆ†å…ˆè¿ç®—æ—¶ã€‚</li><li>è€è€å®å®ç”¨ä¹˜é™¤å¾—äº†ï¼Œåˆ«æ•´äº›ä»€ä¹ˆèŠ±é‡Œèƒ¡å“¨trickã€‚ã€‚ä»£ç çœä¸‹å‡ æ¯«ç§’ï¼Œdebugå¤šèŠ±å‡ ååˆ†é’Ÿã€‚ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>è‡ªå·±äº‹æƒ…é è‡ªå·±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
      <tag>leetcode</tag>
      
      <tag>bug</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
